(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    786514,      20312]
NotebookOptionsPosition[    649577,      17628]
NotebookOutlinePosition[    696568,      18621]
CellTagsIndexPosition[    696525,      18618]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This package has been rewritten to be self-contained, avoiding obsolete \
packages in the old system\
\>", "Text",
 CellChangeTimes->{{3.571236956689756*^9, 3.5712369877120943`*^9}, 
   3.763082100422512*^9},ExpressionUUID->"d2ad18b7-66c5-4bd1-a51c-\
a01665d3fb9c"],

Cell["\<\
28.4.19   There were some bugs here:
\t- AddMutation got confused by nodes that are labelled as lists. I therefore \
removed the form which adds lists of mutations all at once \
\>", "Text",
 CellChangeTimes->{{3.765416740000086*^9, 3.765416778310412*^9}, {
  3.7654168108859377`*^9, 3.765416851155016*^9}, {3.765417121729699*^9, 
  3.7654171310407963`*^9}},ExpressionUUID->"1a54dd02-0f2f-4c8f-b13a-\
8caa84ee1727"],

Cell["\<\
19.10.20  Updated slightly to allow mutations to be added to a population \
that changes in size through time (scaling current size to 1). \
\>", "Text",
 CellChangeTimes->{{3.812099039462101*^9, 
  3.812099074925435*^9}},ExpressionUUID->"7e12ab75-8c3e-4953-9137-\
36a1b445ce49"],

Cell[CellGroupData[{

Cell[" Usage statements", "Section",
 Evaluatable->False,
 InitializationCell->True,
 AspectRatioFixed->
  False,ExpressionUUID->"ee1505fe-55a8-4ca7-9f84-d25af89ce058"],

Cell[CellGroupData[{

Cell["Describing genealogies", "Subsection",ExpressionUUID->"83e09f17-efd7-415a-bafa-71f2ddca06cc"],

Cell[CellGroupData[{

Cell["\<\
Node[i,{info},{Node[j,\[Ellipsis]],Node[k,\[Ellipsis]]}] denotes a node in a \
branching tree.  This node is labelled by the integer i; information on it is \
given by {info}.  The node has descendant nodes labelled j, k.  A terminal \
node (a leaf) is denoted by Node[i,{info},{}].\
\>", "Subsubsection",ExpressionUUID->"c1d569cf-3a15-4c8d-a9a5-a4ecbb5c4082"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Node", "::", "usage"}], "=", 
   "\"\<Node[i,{info},{Node[j,\[Ellipsis]],Node[k,\[Ellipsis]]}] denotes a \
node in a branching tree.  This node is labelled by the integer i; \
information on it is given by {info}.  The node has descendant nodes labelled \
j, k.  A terminal node (a leaf) is denoted by Node[i,{info},{}].\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"00722a66-2f96-402a-be67-d54b9323bc51"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
NodeFunction is an option for CollapseGenealogy and MakeGenealogy which can \
be set to extract information about each node.\
\>", "Subsubsection",ExpressionUUID->"3fc83d5e-6dac-487f-ba3a-4af743131ecc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NodeFunction", "::", "usage"}], "=", 
   "\"\<NodeFunction is an option for CollapseGenealogy and MakeGenealogy \
which can be set to extract information about each node.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e9de9230-604a-4a39-a9ba-c70e2f0e187d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ExtractGenealogy[g,i] gives the genealogy that descends from node i.\
\>", "Subsubsection",ExpressionUUID->"24280a03-63e7-4e94-98c4-30019f07f408"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractGenealogy", "::", "usage"}], "=", 
   "\"\<ExtractGenealogy[g,i] gives the genealogy that descends from node i.  \
For an ancestral graph, ExtractGenealogy[{AncestralLineage[\[Ellipsis]]\
\[Ellipsis]},x] generates the genealogy corresponding to map position x. \
InformationFunction->f generates an information list f[i,x]. \
ExtractGenealogy[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] generates the \
set of genealogies, applying to segments demarcated by Junctions[g].  All \
parts of the genome must have a single common ancestor.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5b3462d2-4f2a-4537-abbd-629c67573252"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
DeleteGenealogy[g,i] deletes the genealogy that descends from node i.\
\>", "Subsubsection",ExpressionUUID->"43de133e-f7cb-4375-bb82-af09655429c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeleteGenealogy", "::", "usage"}], "=", 
   "\"\<DeleteGenealogy[g,i] deletes the genealogy that descends from node i.\
\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8973034a-5540-4f9c-b957-367496a24209"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"AddGenealogy", "[", 
     RowBox[{
      SubscriptBox["g", "1"], ",", 
      SubscriptBox["g", "2"], ",", "i", ",", "j", ",", "info"}], "]"}], " ", 
    "adds", " ", "genealogy", " ", 
    SubscriptBox["g", "2"], " ", "to", " ", "genealogy", " ", 
    SubscriptBox["g", "1"]}], ",", " ", 
   RowBox[{
   "immediately", " ", "above", " ", "existing", " ", "node", " ", "i", " ", 
    "of", " ", 
    RowBox[{
     SubscriptBox["g", "1"], ".", "  ", "The"}], " ", "new", " ", "node", " ",
     "is", " ", "labelled", " ", "j"}], ",", " ", 
   RowBox[{"and", " ", "carries", " ", "information", " ", 
    RowBox[{
     StyleBox["info",
      FontSlant->"Italic"], "."}]}]}], TextForm]], "Subsubsection",ExpressionU\
UID->"6d071011-8fdf-48d9-94a3-0be8e6b69c0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddGenealogy", "::", "usage"}], "=", 
   "\"\<AddGenealogy[\!\(\*SubscriptBox[\(g\), \
\(1\)]\),\!\(\*SubscriptBox[\(g\), \(2\)]\),i,j,info] adds genealogy \
\!\(\*SubscriptBox[\(g\), \(2\)]\) to genealogy \!\(\*SubscriptBox[\(g\), \(1\
\)]\), immediately above existing node i of \!\(\*SubscriptBox[\(g\), \
\(1\)]\).  The new node is labelled j.  The new node is labelled j, and \
carries information info.  If i=j, then \!\(\*SubscriptBox[\(g\), \(2\)]\) is \
added to existing node i, and its information is unaltered.  Node i must be \
found once and only once within \!\(\*SubscriptBox[\(g\), \(1\)]\).\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9fbcbd31-b6d0-4021-a3e0-bfdba7861652"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
AddNode[g,i,k,info] adds a new node k immediately above existing node i of g. \
 The new node carries information info.  AddNode[g,i,j,k,info] adds a new \
node k between nodes i and j of an unrooted genealogy\
\>", "Subsubsection",ExpressionUUID->"f512001c-1fda-482f-97b0-5b1ee2e59eb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddNode", "::", "usage"}], "=", 
   "\"\<AddNode[g,i,k,info] adds a new node k immediately above existing node \
i of g.  The new node carries information info.  AddNode[g,i,j,k,info] adds a \
new node k between nodes i and j of an unrooted genealogy.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"41124859-4f68-4c52-b783-92b6d06604f5"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
CondenseGenealogy[g] removes all nodes that have only one descendant.\
\>", "Subsubsection",ExpressionUUID->"f7e8e083-0c6e-4551-8401-ebcd4a35bc3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CondenseGenealogy", "::", "usage"}], "=", 
   "\"\<CondenseGenealogy[g] removes all nodes that have only one descendant. \
However, the root node is not affected. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"65eec372-730c-4ba0-bb22-8edd34dd0c82"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Nodes[g] lists all the nodes of the genealogy g, including the leaves. \
\>", "Subsubsection",ExpressionUUID->"1de20c59-8d72-4bd0-a1dd-6c593c740c02"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nodes", "::", "usage"}], "=", 
   "\"\<Nodes[g] lists all the nodes of the genealogy g, including the \
leaves. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7e1f3e26-5a08-4884-a830-4446a55157f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
InternalNodes[g] lists the internal nodes of the genealogy g.\
\>", "Subsubsection",ExpressionUUID->"54a9929d-39fa-4a96-8066-cbe47741a181"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InternalNodes", "::", "usage"}], "=", 
   "\"\<InternalNodes[g] lists the internal nodes of the genealogy g. \>\""}],
   ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ae553f7c-bfff-41d2-b57c-2fc6c87bad7d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Leaves[g] lists the terminal nodes of the genealogy g.", "Subsubsection",ExpressionUUID->"67e9d41e-f268-480d-941d-0e2c7bd12e19"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Leaves", "::", "usage"}], "=", 
   "\"\<Leaves[g] lists the terminal nodes of the genealogy g. For an \
ancestral graph, Leaves[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] gives \
those lineages which start at times when no other lineages end\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b8c6dd68-ebbf-4549-aaf0-c3c3d32881b3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
CollapseGenealogy[genealogy] reduces the genealogy to a nested list. \
CollapseGenealogy[genealogy, Node\[Rule]False] only lists the leaves.\
\>", "Subsubsection",ExpressionUUID->"66f7bb3c-cb3c-410e-a440-b098d7cb11b2"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"CollapseGenealogy", "::", "usage"}], "=", 
    "\"\<CollapseGenealogy[genealogy] reduces the genealogy to a nested list. \
 Node\[Rule]False only lists the leaves. NodeFunction\[Rule]f extracts a \
nested list of the information associated with each node, by applying \
f[i,{info}] to the full set of information contained in the genealogy. Nested\
\[Rule]False does not preserve the nested structure.\>\""}], ";"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"273016ad-41ee-4a24-aaec-6d4d6ba27dee"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
SizeOfGenealogyPlot[g] gives the minimum and maximum coordinates, held as the \
last element of the information lists in g.\
\>", "Subsubsection",ExpressionUUID->"118f1625-3bf9-4909-bf3f-9e45df26d970"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SizeOfGenealogyPlot", "::", "usage"}], "=", 
   "\"\<SizeOfGenealogyPlot[g] gives the minimum and maximum coordinates, \
held as the last element of the information lists in g, in the form \
{{\!\(\*SubscriptBox[\(x\), \(min\)]\),\!\(\*SubscriptBox[\(y\), \
\(min\)]\)},{\!\(\*SubscriptBox[\(x\), \(max\)]\),\!\(\*SubscriptBox[\(y\), \
\(max\)]\)}}.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5ba2739d-9360-4513-83e8-4ed452d54490"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MakeGenealogyPlot[g] appends coordinates to the information lists; these are \
used by PlotGenealogy[].\
\>", "Subsubsection",ExpressionUUID->"a9912971-9f88-4ecd-ad16-ff9fd27ead94"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeGenealogyPlot", "::", "usage"}], "=", 
   "\"\<MakeGenealogyPlot[g] appends coordinates to the information lists; \
these are used by PlotGenealogy[].  The vertical coordinate is incremented in \
units of 1, and the vertical span equals the number of lineages, minus 1. \
\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5482e107-3187-4ba7-971b-392d209cbc2b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
PlotGenealogy[g] plots a genealogy; the coordinates are held as the last \
element of the information lists.  These may be generated by \
MakeGenealogyPlot[g].   PlotGenealogy[g,NodeFunction\[Rule]f] uses f[i,info] \
to derive the vertical coordinate; this might represent coalescence time, for \
example.\
\>", "Subsubsection",ExpressionUUID->"528ccd1d-6a34-4c94-ac83-af9ed03b750f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlotGenealogy", "::", "usage"}], "=", 
   "\"\<PlotGenealogy[g] plots a genealogy.  PlotGenealogy[g,NodeFunction\
\[Rule]f] uses f[i,info] to derive the coordinates; this might represent \
coalescence time, for example.  By default, nodes & leaves are labelled.  \
NodeLabels\[Rule]None suppresses the labelling; NodeLabels\[Rule]f uses \
f[i,info] to derive labels.  MakeGenealogyPlot\[Rule]False requires that  the \
coordinates are held as the last element of the information list.  By \
default, these are generated by MakeGenealogyPlot[g].\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"919bc4a3-99b7-4801-b6c2-0eaa63b0463b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
LeafOffset is an option for PlotGenealogy which determines the position of \
leaf labels.\
\>", "Subsubsection",ExpressionUUID->"b75bcd51-c6d5-4c37-a21d-440fb3c81fd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LeafOffset", "::", "usage"}], "=", 
   "\"\<LeafOffset is an option for PlotGenealogy which determines the \
position of leaf labels.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8f776e41-2d97-41c1-8bc6-5e98f9b11019"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
NodeOffset is an option for PlotGenealogy which determines the position of \
node labels.\
\>", "Subsubsection",ExpressionUUID->"beb14549-ad64-4b07-b7fe-43c4855e2a54"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NodeOffset", "::", "usage"}], "=", 
   "\"\<NodeOffset is an option for PlotGenealogy which determines the \
position of node labels.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b5d42883-4a3f-4110-851a-9072e4e23365"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
LeafLabels\[Rule]f is an option for PlotGenealogy which uses f[i,info] to \
construct labels for the leaves; LeafLabels\[Rule]None suppresses labels.\
\>", "Subsubsection",ExpressionUUID->"5b0fe6ca-68dc-42c9-b9d0-89874d93dd09"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LeafLabels", "::", "usage"}], "=", 
   "\"\<LeafLabels\[Rule]f is an option for PlotGenealogy which uses \
f[i,info] to construct labels for the leaves; LeafLabels\[Rule]None \
suppresses labels.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b817838d-a619-45dd-b0e6-9f3a12654e74"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MostRecentCommonAncestor[pop,i,j] gives the most recent common ancestor of \
nodes i, j\
\>", "Subsubsection",ExpressionUUID->"27d34fc4-6853-426f-98ab-8e8e626cb1f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MostRecentCommonAncestor", "::", "usage"}], "=", 
   "\"\<MostRecentCommonAncestor[g,i,j] gives the most recent common ancestor \
of nodes i, j.  \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"bac30911-bc1e-4b1c-a2fe-8b5de2a5368d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Nested is an option for CollapseGenealogy which determines whether the nested \
structure is preserved.\
\>", "Subsubsection",ExpressionUUID->"f00cace2-3c39-4b18-b264-0f9e7efd6bda"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nested", "::", "usage"}], "=", 
   "\"\<Nested is an option for CollapseGenealogy which determines whether \
the nested structure is preserved. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"55b301bb-c08c-475f-b028-6e887d09d677"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ExtractInformation[g,i] gives the information associated with node i.\
\>", "Subsubsection",ExpressionUUID->"8f5ace66-a52f-4e54-ab09-c9d595627114"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractInformation", "::", "usage"}], "=", 
   "\"\<ExtractInformation[g,i] gives the information associated with node i. \
ExtractInformation[g] gives a list of the information for all the nodes.  For \
an ancestral graph, ExtractInformation[{AncestralLineage[\[Ellipsis]]\
\[Ellipsis]},l] extracts the information associated with the lineage labelled \
by l.  Checks that there is only one such lineage. \
ExtractInformation[{AncestralLineage[\[Ellipsis]]\[Ellipsis]},{\!\(\*\
SubscriptBox[\(l\), \(1\)]\),\[Ellipsis]}] extracts a list of such \
information. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8caee6b2-63ac-4810-9784-e4907137ef2e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
TransformInformation[g,f] replaces the information list info by f[node,info].\
\>", "Subsubsection",ExpressionUUID->"6a772d25-86ec-4813-8912-d26696597a96"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TransformInformation", "::", "usage"}], "=", 
   "\"\<TransformInformation[g,f] replaces the information list info by \
f[node,info].\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8dd59b76-5a58-44a0-af10-2b95a174302b"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListToGenealogy", "[", "list", "]"}], " ", "constructs", " ", 
     "a", " ", "genealogy", " ", "from", " ", "a", " ", "nested", " ", "list",
      " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"label", ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["node", "1"], ",", 
          SubscriptBox["node", "2"], ",", "\[Ellipsis]"}], "}"}]}], "}"}], 
      ".", "  ", "Information"}], " ", "on", " ", "each", " ", "node", " ", 
     "can", " ", "be", " ", "included", " ", "using", " ", "NodeFunction"}], 
    "\[Rule]", "f"}], ",", " ", 
   RowBox[{"where", " ", 
    RowBox[{"f", "[", "label", "]"}], " ", "gives", " ", "a", " ", "list", 
    " ", "of", " ", "information", " ", "for", " ", "the", " ", "node", " ", 
    "with", " ", "that", " ", 
    RowBox[{"label", ".", "  ", 
     RowBox[{"ListToGenealogy", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "d"}], "}"}]}], "}"}], ",", 
       RowBox[{"Node", "\[Rule]", "False"}]}], "]"}]}], " ", "gives", " ", 
    "a", " ", "genealogy", " ", "relating", " ", "objects", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "\[Ellipsis]"}], "}"}], ".", "  ", 
     "Internal"}], " ", "nodes", " ", "are", " ", 
    RowBox[{"unlabelled", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUI\
D->"eab700b8-096b-4f80-ab49-bd91cfcf55cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ListToGenealogy", "::", "usage"}], "=", 
   "\"\<ListToGenealogy[list] constructs a genealogy from a nested list of \
the form {label,{\!\(\*SubscriptBox[\(node\), \
\(1\)]\),\!\(\*SubscriptBox[\(node\), \(2\)]\),\[Ellipsis]}}.  Information on \
each node can be included using NodeFunction\[Rule]f, where f[label] gives a \
list of information for the node with that label.  \
ListToGenealogy[{{a,b},{c,d}},Node\[Rule]False] gives a genealogy relating \
objects {a,b,\[Ellipsis]}.  Internal nodes are unlabelled.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"2c196d5a-0710-498c-9485-a8848c8753ab"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
OrderedNodes[g,f] gives a list of the nodes in the genealogy, in the order \
defined by f[ i,{info}]\
\>", "Subsubsection",ExpressionUUID->"b0ed6b32-62b5-4533-96f2-a9db23475daa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrderedNodes", "::", "usage"}], "=", 
   "\"\<OrderedNodes[g,f] gives a list of the nodes in the genealogy, in the \
order defined by f[ i,{info}].  OrderedNodes[g,f,Node\[Rule]True] only lists \
internal nodes.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b0a4b03a-b468-47b1-8b60-a4c7b145f15e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ancestors[g,node] lists the ancestors of the node.", "Subsubsection",ExpressionUUID->"7e074770-b9d1-4863-9e69-a3a8b87f8f76"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ancestors", "::", "usage"}], "=", 
   "\"\<Ancestors[g,node] lists the ancestors of the node.  For an ancestral \
graph, Ancestors[{AncestralLineage[\[Ellipsis]],\[Ellipsis]},l] lists the \
immediate ancestors of lineage l.  MapPosition\[Rule]x restricts the list to \
ancestors at map position x.  AncestorList\[Rule]All gives a list of all \
ancestors, in  the form {\!\(\*SubscriptBox[\(l\), \
\(1\)]\),{{\!\(\*SubscriptBox[\(d\), \
\(1\)]\),{\[Ellipsis]}},{\!\(\*SubscriptBox[\(d\), \(2\)]\),{\[Ellipsis]}}}}. \
 AncestorList\[Rule]Roots gives only the root ancestors.  \>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c3e356f9-6227-490f-9962-67e59c825d99"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Descendants[g,node] lists the immediate descendants of the node.  \
Descendants[g,node,DescendantList\[Rule]All] lists all the descendants of the \
node. Descendants[g,node,DescendantList\[Rule]Leaves] lists only the \
descendant leaves of the node.\
\>", "Subsubsection",ExpressionUUID->"950a7907-7d5f-4f3a-8fab-efb0cc89871b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Descendants", "::", "usage"}], "=", 
   "\"\<Descendants[g,node] lists the immediate descendants of the node.  \
Descendants[g,node,DescendantList\[Rule]All] lists all the descendants of the \
node. Descendants[g,node,DescendantList\[Rule]Leaves] lists only the \
descendant leaves of the node.  For an ancestral graph, \
Descendants[{AncestralLineage[\[Ellipsis]],\[Ellipsis]},l] lists the \
immediate descendants from lineage l.  MapPosition\[Rule]x restricts the list \
to descendants at map position x.  DescendantList\[Rule]All gives a list of \
all descendants, in  the form {\!\(\*SubscriptBox[\(l\), \
\(1\)]\),{{\!\(\*SubscriptBox[\(d\), \
\(1\)]\),{\[Ellipsis]}},{\!\(\*SubscriptBox[\(d\), \(2\)]\),{\[Ellipsis]}}}}. \
DescendantList\[Rule]Leaves gives only the descendant leaves.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0db3bf96-80cf-4611-a053-e0fdb6571c32"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
DescendantList is an option for Descendants[]; may be set to Next, All or \
Leaves.\
\>", "Subsubsection",ExpressionUUID->"6fc95b2d-0c0c-4245-9fba-4c914fb7ccfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DescendantList", "::", "usage"}], "=", 
   "\"\<DescendantList is an option for Descendants[]; may be set to Next, \
All or Leaves.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"864117a4-85aa-41a2-b111-c849b2adebaa"]
}, Closed]],

Cell[CellGroupData[{

Cell["UnrootedGenealogy[g] gives an unrooted genealogy.", "Subsubsection",ExpressionUUID->"6d41309f-4322-46f8-8477-5e37ce57cac1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UnrootedGenealogy", "::", "usage"}], "=", 
   "\"\<UnrootedGenealogy[g] gives an unrooted genealogy.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"6d1ea52e-8423-4a3d-819d-56c578574acb"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{"RootedGenealogy", "[", 
      RowBox[{"g", ",", "i"}], "]"}], 
     RowBox[{
     "roots", " ", "an", " ", "unrooted", " ", "genealogy", " ", "at", " ", 
      "node", " ", "i"}]}
   }], TextForm]], "Subsubsection",ExpressionUUID->"8f128337-e343-4fd7-8add-\
113337ea61a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RootedGenealogy", "::", "usage"}], "=", 
   "\"\<\!\(TextForm\`RootedGenealogy\)[g,i] roots an unrooted genealogy at \
node i\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"dc93c92d-ada2-450b-98eb-9d24c50a99b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
SiblingList[g] lists all pairs of leaves which are directly related.\
\>", "Subsubsection",ExpressionUUID->"2a53ad0b-e3b2-4263-a332-31c63cdace21"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SiblingList", "::", "usage"}], "=", 
   "\"\<SiblingList[g] lists all pairs of leaves which are directly \
related.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"861cdd85-62a7-4364-aed0-239f550dba77"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Family structures", "Subsection",ExpressionUUID->"fc0052e7-51dd-41b1-b69f-b6799beea7ae"],

Cell[CellGroupData[{

Cell["\<\
GenealogyToFamily[g,f] gives a list of the family structures following \
successive coalescences. The function f[i,{info}] gives the ordering of the \
coalescence for node i.\
\>", "Subsubsection",ExpressionUUID->"3c828de2-fd70-48f3-8199-f71b89d913ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenealogyToFamily", "::", "usage"}], "=", 
   "\"\<GenealogyToFamily[g,f] gives a list of the family structures \
following successive coalescences. The function f[i,{info}] gives the \
ordering of the coalescence for node i.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a71a4e73-a431-48ae-a648-cb5e6cb67b6a"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"FamilyToGenealogy", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "\[Ellipsis]"}], "}"}], ",", 
      "S"}], "]"}], " ", "gives", " ", "a", " ", "randomly", " ", 
    "constructed", " ", "genealogy", " ", "which", " ", "satistfies", " ", 
    "the", " ", "sequence", " ", "of", " ", "family", " ", "structures", " ", 
    "S"}], ",", " ", 
   RowBox[{"and", " ", "which", " ", "relates", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "\[Ellipsis]"}], "}"}], ".", "  ",
      "The"}], " ", "terminal", " ", "nodes", " ", "are", " ", "labelled", 
    " ", "by", " ", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "\[Ellipsis]"}], "}"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "and", " ", "the", " ", "internal", " ", "nodes", " ", "are", " ", 
     "labelled", " ", "by", " ", "integers", " ", "giving", " ", "the", " ", 
     "order", " ", "of", " ", "the", " ", "coalescence", " ", 
     RowBox[{"events", ".", " ", "NodeLabels"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["label", "1"], ",", "\[Ellipsis]"}], "}"}], " ", 
      "allows", " ", "an", " ", "arbitrary", " ", "list", " ", "of", " ", 
      "labels", " ", "for", " ", "the", " ", "internal", " ", 
      RowBox[{"nodes", ".", "  ", "NodeInformation"}]}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["info", "1"], ",", "\[Ellipsis]"}], "}"}]}]}], ",", " ", 
   RowBox[{"LeafInformation", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["info", "a"], ",", "\[Ellipsis]"}], "}"}], " ", "allow", 
     " ", "arbitrary", " ", "lists", " ", "of", " ", "information", " ", "to",
      " ", "be", " ", "associated", " ", "with", " ", "the", " ", "nodes", 
     " ", "and", " ", 
     RowBox[{"leaves", ".", "  ", "With"}], " ", "n", " ", "items"}]}], ",", 
   " ", 
   RowBox[{"there", " ", "are", " ", "n", " ", "nodes"}], ",", " ", 
   RowBox[{
   "and", " ", "so", " ", "all", " ", "the", " ", "optional", " ", "lists", 
    " ", "must", " ", "have", " ", "length", " ", 
    RowBox[{"n", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"a05f5836-6312-43c4-8ac4-823c18e66bdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FamilyToGenealogy", "::", "usage"}], "=", 
   "\"\<FamilyToGenealogy[{a,b,c,\[Ellipsis]},S] gives a randomly constructed \
genealogy which satistfies the sequence of family structures S, and which \
relates {a,b,c,\[Ellipsis]}.  The terminal nodes are labelled by {a,b,c,\
\[Ellipsis]}, and the internal nodes are labelled by integers giving the \
order of the coalescence events. NodeLabels\[Rule]{\!\(\*SubscriptBox[\(label\
\), \(1\)]\),\[Ellipsis]} allows an arbitrary list of labels for the internal \
nodes.  NodeInformation\[Rule]{\!\(\*SubscriptBox[\(info\), \(1\)]\),\
\[Ellipsis]}, LeafInformation\[Rule]{\!\(\*SubscriptBox[\(info\), \(a\)]\),\
\[Ellipsis]} allow arbitrary lists of information to be associated with the \
nodes and leaves.  With n items, there are n nodes, and so all the optional \
lists must have length n.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"31cda983-7d74-4209-b20b-e9edf802c0d9"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{"LeafInformation", "\[Rule]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["info", "a"], ",", "\[Ellipsis]"}], "}"}], " ", "is", " ", 
    "an", " ", "option", " ", "for", " ", 
    RowBox[{"FamilyToGenealogy", "[", "]"}], " ", "which", " ", "specifies", 
    " ", "information", " ", "associated", " ", "with", " ", "each", " ", 
    RowBox[{"leaf", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"f372258c-2ce8-4ad2-b65e-f0cc74a374cb"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"LeafInformation", "::", "usage"}], "=", 
    "\"\<LeafInformation\[Rule]{\!\(\*SubscriptBox[\(info\), \(a\)]\),\
\[Ellipsis]} is an option for FamilyToGenealogy[] which specifies information \
associated with each leaf.\>\""}], ";"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a53a189a-6893-442b-9853-43d0a38faa68"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"NodeInformation", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["info", "1"], ",", "\[Ellipsis]"}], "}"}], " ", "is", " ",
      "an", " ", "option", " ", "for", " ", 
     RowBox[{"FamilyToGenealogy", "[", "]"}], " ", "which", " ", "specifies", 
     " ", "information", " ", "associated", " ", "with", " ", "each", " ", 
     "internal", " ", 
     RowBox[{"node", ".", "  ", "The"}], " ", "number", " ", "of", " ", 
     "such", " ", "nodes", " ", "is", " ", "the", " ", "same", " ", "as", " ",
      "the", " ", "number", " ", "of", " ", "leaves"}]}], ";", " ", 
   RowBox[{"nodes", " ", "are", " ", "ordered", " ", "by", " ", "their", " ", 
    RowBox[{"timing", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"a5da7106-724f-4cc1-803d-e1409edf2f79"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"NodeInformation", "::", "usage"}], "=", 
    "\"\<NodeInformation\[Rule]{\!\(\*SubscriptBox[\(info\), \(1\)]\),\
\[Ellipsis]} is an option for FamilyToGenealogy[] which specifies information \
associated with each internal node.  The number of such nodes is the same as \
the number of leaves; nodes are ordered by their timing.\>\""}], 
   ";"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"bf3f3624-a5b1-4bb0-bd9c-f20374e7825b"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"NodeLabels", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["label", "1"], ",", "\[Ellipsis]"}], "}"}], " ", "is", 
     " ", "an", " ", "option", " ", "for", " ", 
     RowBox[{"FamilyToGenealogy", "[", "]"}], " ", "which", " ", "specifies", 
     " ", "labels", " ", "for", " ", "each", " ", "internal", " ", 
     RowBox[{"node", ".", "  ", "The"}], " ", "number", " ", "of", " ", 
     "such", " ", "nodes", " ", "is", " ", "the", " ", "same", " ", "as", " ",
      "the", " ", "number", " ", "of", " ", "leaves"}]}], ";", " ", 
   RowBox[{"nodes", " ", "are", " ", "ordered", " ", "by", " ", "their", " ", 
    RowBox[{"timing", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"0600b7bd-ab1b-41d2-886a-c7fcc78594bc"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"NodeLabels", "::", "usage"}], "=", 
    "\"\<NodeLabels\[Rule]{\!\(\*SubscriptBox[\(label\), \
\(1\)]\),\[Ellipsis]} is an option for FamilyToGenealogy[] which specifies \
labels for each internal node.  The number of such nodes is the same as the \
number of leaves; nodes are ordered by their timing.  NodeLabels\[Rule]f is \
an option for PlotGenealogy which uses f[i,info] to construct labels for the \
nodes; NodeLabels\[Rule]None suppresses labels.\>\""}], ";"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5da9cd01-767b-4e2c-9f03-8a311a85dded"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"GenealogyB", "[", 
     RowBox[{"j", ",", "i", ",", "k"}], "]"}], " ", "is", " ", "the", " ", 
    "coefficient", " ", "of", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[Lambda]", "i"]}], 
      RowBox[{"t", "/", "2"}], "N"}], "]"}], " ", "in", " ", "the", " ", 
    "expression", " ", "for", " ", 
    SubscriptBox["P", "j"]}], ",", " ", 
   RowBox[{
   "the", " ", "probability", " ", "of", " ", "j", " ", "coalescences", " ", 
    "having", " ", 
    RowBox[{"occurred", "."}]}]}], TextForm]], "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"1f150228-74bb-4ffe-a069-5285ca66006a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenealogyB", "::", "usage"}], "=", 
   "\"\<GenealogyB[j,i,k] is the coefficient of Exp[-\!\(\*SubscriptBox[\(\
\[Lambda]\), \(i\)]\)t/2N] in the expression for \!\(\*SubscriptBox[\(P\), \
\(j\)]\), the probability of j coalescences having occurred.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"59227d2d-56fc-4255-81af-d2dd27fd9692"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
CoalescenceDistribution[j,k,t] is the probability of j coalescences having \
occurred among k lineages over t generations (scaled to 2N)\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"ac47662f-3e67-427f-8b77-6db06342c294"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalescenceDistribution", "::", "usage"}], "=", 
   "\"\<CoalescenceDistribution[j,k,t] is the probability of j coalescences \
having occurred among k lineages over t generations (scaled to 2N) \>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"2513d9f0-aa5e-4025-9314-9b1d304e6709"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
SimplifyFamilies replaces duplications such as {{1,3},{2,2},{2,1}} by \
{{1,3},{2,3}}\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"ee9678ec-bfba-4f84-b565-cc3b7d517755"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyFamilies", "::", "usage"}], "=", 
   "\"\<SimplifyFamilies replaces duplications such as {{3,1},{2,2},{1,2}} by \
{{3,1},{3,2}}\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b1b2f2c7-8060-4672-a22a-d9a3f4ce6a39"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
FamilyProbability[S] gives the probability that this family structure would \
be produced, given a certain number of coalescence events\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"2faf3b8e-eb1c-47b6-822c-f04852fb1253"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FamilyProbability", "::", "usage"}], "=", 
   "\"\<FamilyProbability[S] gives the probability that the family structure \
S would be produced, given a certain number of coalescence events.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a4786b84-e80a-4b99-8dbe-ede36c3f4817"]
}, Closed]],

Cell[CellGroupData[{

Cell["NumberOfLineages[S] gives the total number of genes involved", \
"Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"60607c70-5402-4912-acae-f64823f305a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfLineages", "::", "usage"}], "=", 
   "\"\<NumberOfLineages[g]  gives the total number of lineages (i.e., \
terminal nodes) involved in the genealogy g. NumberOfLineages[g,i] gives the \
number that descend from node i.  NumberOfLineages[S] can also be applied to \
a list of family sizes, S\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"be1e92d4-c254-4e4b-94be-2fed16f96971"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairwiseIdentity[S] gives the mean pairwise identity", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"b4315b21-6bb4-4a5a-b844-c7971f0117e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseIdentity", "::", "usage"}], "=", 
   "\"\<PairwiseIdentity[S] gives the mean pairwise identity, given the \
family structure S.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7e0869bc-8206-4163-bd33-a601da1c4be0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
AllSets[j,k] lists all the family structures that could yield j families and \
k genes\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"24c52cc4-a2d6-4f2e-a1b2-df996847c541"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AllSets", "::", "usage"}], "=", 
   "\"\<AllSets[j,k] lists all the family structures that could yield j \
families and k genes\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5aeaa880-09d6-425b-9b89-ca7e9ac112ad"]
}, Closed]],

Cell[CellGroupData[{

Cell["NewS[S] gives a recursion for the family structures", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"571cee36-e650-43c8-ab23-c55ba0cae386"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NewS", "::", "usage"}], "=", 
   "\"\<NewS[S] gives a recursion for the family structures\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"63375618-80c9-4ead-9489-6e16a1ae283b"]
}, Closed]],

Cell[CellGroupData[{

Cell["NumberOfFamilies[S] gives the number of families", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"cea7a6ce-d482-42a9-93fd-89c8c0fed9d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfFamilies", "::", "usage"}], "=", 
   "\"\<NumberOfFamilies[S] gives the number of families\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"dc596d92-78fe-4792-9c04-62cbf8551182"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Random genealogies", "Subsection",ExpressionUUID->"374e5328-87a2-4d04-a04c-b26d963981d1"],

Cell[CellGroupData[{

Cell["CoalescenceTimes", "Subsubsection",ExpressionUUID->"d29ea3f6-f610-4eb1-9805-e1f7d58ad5ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalescenceTimes", "::", "usage"}], "=", 
   "\"\<CoalescenceTimes is an option for RandomGenealogy.  CoalescenceTimes\
\[Rule]Random uses RandomCoalescenceTimes[k]; otherwise a list of times must \
be supplied\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9dd21553-0556-4eac-b982-2da1290c0535"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomCoalescenceTimes[k] gives a list of random coalescence times\
\>", "Subsubsection",ExpressionUUID->"3b72d4e3-14b4-41bf-856c-8adccec78457"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomCoalescenceTimes", "::", "usage"}], "=", 
   "\"\<RandomCoalescenceTimes[k] gives a list of random coalescence times, \
scaled to 2N generations. RandomCoalescenceTimes[n,k,R] generates a sequence \
of n coalescences and recombinations, starting with k lineages at t=0. The \
output is a list of n items of the form {t,k,j}, where t is the time of the \
event;k is the number of lineages after the event; and j is the location of \
the recombination event in the interval {0,R}. j=None indicates a \
coalescence.  RandomCoalescenceTimes[k,R] generates a single item, with rate \
k(k-1)/2 of coalescence and k R of recombination.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d86fb1c3-fe9c-4802-92bc-3d28c8cf9332"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomCoalescenceTimesG[k,\[Lambda]] gives a list of random coalescence times \
for a population growing at rate \[Lambda]\
\>", "Subsubsection",
 CellChangeTimes->{{3.812162236565773*^9, 
  3.8121622494262733`*^9}},ExpressionUUID->"73d84d0d-817d-4ab6-8938-\
fcaae7a36713"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomCoalescenceTimesG", "::", "usage"}], "=", 
   "\"\<RandomCoalescenceTimesG[k,\[Lambda]] gives a list of random \
coalescence times, scaled to 2N generations, for a population growing at rate \
\[Lambda] to current (scaled) size 1. This simply uses a scale transformation \
t=log[1+\[Lambda]t]/\[Lambda], which reduces the coalescence times deeper in \
the tree. Note that if \[Lambda]<0 (a shrinking population) then lineages \
that do not coalesce by rescaled time 1/|\[Lambda]| will never coalesce: \
coalescence times are then given as \[Infinity].  \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.81216225269703*^9, 3.812162382851272*^9}, {
  3.812165104949873*^9, 3.812165141449391*^9}, {3.812166163038287*^9, 
  3.8121661876320477`*^9}},ExpressionUUID->"da3e0d0e-07d2-42bd-915c-\
e8cd9e2246c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
NumberOfCoalescences[k,T] gives a randomly sampled number of coalescence \
events that occur in T (scaled to 2N) NumberOfCoalescences[{t1,t2..}] does \
the same, for a list of coalescence times.\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"ec8975e8-a6c1-458c-8241-40dfc7cbe6d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfCoalescences", "::", "usage"}], "=", 
   "\"\<NumberOfCoalescences[k,T] gives a randomly sampled number of \
coalescence events that occur in T (scaled to 2N). \
NumberOfCoalescences[{t1,t2..},T] does the same, for a list of coalescence \
times. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"540c95f9-1412-480a-8845-5f51785bc9ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["TotalLength[{t1,t2,..}] is the total length of the tree", \
"Subsubsection",ExpressionUUID->"eed3404c-b4c3-4e53-8e83-36badf6b2ab8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TotalLength", "::", "usage"}], "=", 
   "\"\<TotalLength[{t1,t2,..}] is the total length of the tree, given the \
coalescence times.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c6b57c2e-d433-4d26-bd52-5aaeb33177e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomFamilies[k] generates a list of the family sizes going back through \
time to the common ancestor of k genes.\
\>", "Subsubsection",ExpressionUUID->"af7bea16-af71-4a6e-b1d9-0be70e4e080b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomFamilies", "::", "usage"}], "=", 
   "\"\<RandomFamilies[k] generates a list of the family sizes going back \
through time to the common ancestor of k genes.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"59769f9a-ec2d-4acb-89e4-73f2af5eb48d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomPreviousFamily[{1,1,2,3}] generates a random coalescence to give the \
previous family structure\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"36cf5235-16a1-4d34-9122-2a4bd3e347e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomPreviousFamily", "::", "usage"}], "=", 
   "\"\<RandomPreviousFamily[{1,1,2,3}] generates a random coalescence to \
give the previous family structure\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e48a6393-d2b5-445a-b6cd-0defcafd0555"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"RandomGenealogy", "[", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["leaf", "1"], ",", 
       SubscriptBox["leaf", "2"], ",", "\[Ellipsis]"}], "}"}], "]"}], " ", 
    "gives", " ", "a", " ", "random", " ", "realisation", " ", "of", " ", 
    "the", " ", "coalescent", " ", 
    RowBox[{"process", ".", "  ", "Terminal"}], " ", "nodes", " ", "are", " ",
     "labelled", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["leaf", "1"], ",", 
      SubscriptBox["leaf", "2"], ",", "\[Ellipsis]"}], "}"}]}], ",", " ", 
   RowBox[{
   "and", " ", "internal", " ", "nodes", " ", "are", " ", "labelled", " ", 
    "by", " ", "an", " ", "integer"}], ",", " ", 
   RowBox[{
   "in", " ", "the", " ", "order", " ", "in", " ", "which", " ", "they", " ", 
    RowBox[{"occur", ".", "  ", "Each"}], " ", "node", " ", "carries", " ", 
    "its", " ", "time"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"scaled", " ", "to", " ", "2", "N", " ", 
       RowBox[{"generations", ".", "  ", "MutationRate"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{"\[Theta]", " ", "simulates", " ", "infinite"}], "-", 
       RowBox[{
       "sites", " ", "mutation", " ", "at", " ", "a", " ", "rate", " ", 
        "\[Theta]"}]}]}], "=", 
     RowBox[{"4", "N\[Mu]"}]}], ";", " ", 
    RowBox[{
     RowBox[{
     "mutations", " ", "are", " ", "labelled", " ", "by", " ", "unique", " ", 
      RowBox[{"integers", ".", " ", "NodeLabels"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["label", "1"], ",", "\[Ellipsis]"}], "}"}], " ", "can", 
      " ", "be", " ", "used", " ", "to", " ", "label", " ", "internal", " ", 
      RowBox[{"nodes", "."}]}]}]}]}], TextForm]], "Subsubsection",ExpressionUU\
ID->"52a50ffc-6e38-450d-a5b3-6799ed2408bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomGenealogy", "::", "usage"}], "=", 
   "\"\<RandomGenealogy[{\!\(\*SubscriptBox[\(leaf\), \
\(1\)]\),\!\(\*SubscriptBox[\(leaf\), \(2\)]\),\[Ellipsis]}] gives a random \
realisation of the coalescent process.  Terminal nodes are labelled \
{\!\(\*SubscriptBox[\(leaf\), \(1\)]\),\!\(\*SubscriptBox[\(leaf\), \(2\)]\),\
\[Ellipsis]}, and internal nodes are labelled by an integer, in the order in \
which they occur.  Each node carries its time, scaled to 2N generations.  \
MutationRate\[Rule]\[Theta] simulates infinite-sites mutation at a rate \
\[Theta]=4N\[Mu]; mutations are labelled by unique integers. \
NodeLabels\[Rule]{\!\(\*SubscriptBox[\(label\), \(1\)]\),\[Ellipsis]} can be \
used to label internal nodes.   RandomGenealogy[{\!\(\*SubscriptBox[\(leaf\), \
\(1\)]\),\!\(\*SubscriptBox[\(leaf\), \(2\)]\)\[Ellipsis]},n,R] gives a \
random realisation of the coalescent process with recombination; there are n \
events. RandomGenealogy[{\!\(\*SubscriptBox[\(leaf\), \
\(1\)]\),\!\(\*SubscriptBox[\(leaf\), \
\(2\)]\)\[Ellipsis]},{{\!\(\*SubscriptBox[\(t\), \(1\)]\),\!\(\*SubscriptBox[\
\(k\), \(1\)]\),\!\(\*SubscriptBox[\(x\), \(1\)]\)}\[Ellipsis]},R] gives a \
random realisation for a specific sequence of events, generated by \
RandomCoalescenceTimes[n,k,R]; this preserves null lineages, however.  \
DeleteNullLineages->True ignores null events; can only be used with the first \
form. PrintDetails\[Rule]True prints details of the construction.  MaxTime->t \
stops after time t.  Fixation->True stops when the whole genome is \
fixed.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"1421af4f-0836-4e0e-9e34-bb87c0be1d24"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MutationRate\[Rule]\[Theta] is an option for RandomGenealogy[] which sets the \
scaled mutation rate \[Theta]=4N\[VeryThinSpace]\[Mu].  Default is \
MutationRate\[Rule]None.\
\>", "Subsubsection",ExpressionUUID->"fca79ddc-c17e-42b8-b23b-5fcdcbccb6f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MutationRate", "::", "usage"}], "=", 
   "\"\<MutationRate\[Rule]\[Theta] is an option for RandomGenealogy[] which \
sets the scaled mutation rate \[Theta]=4N\[VeryThinSpace]\[Mu].  Default is \
MutationRate\[Rule]None.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"91a6699a-adf8-4049-9149-7ca9d497ddb8"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"DeletedMutations", "[", 
    RowBox[{"g", ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["T", "0"], ",", 
       SubscriptBox["T", "1"]}], "}"}]}], "]"}], " ", "lists", " ", "those", 
   " ", "mutations", " ", "that", " ", "should", " ", "be", " ", "deleted", 
   " ", "because", " ", "they", " ", "occurred", " ", "in", " ", "time", " ", 
   "interval", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["T", "0"], ",", 
      SubscriptBox["T", "1"]}], "}"}], ".", "  ", "This"}], " ", "list", " ", 
   "may", " ", "be", " ", "to", " ", "some", " ", "extent", " ", "randomly", 
   " ", 
   RowBox[{"generated", "."}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"e94ec61f-24ba-45c7-9327-019ca4d8efaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeletedMutations", "::", "usage"}], "=", 
   "\"\<DeletedMutations[g,{\!\(\*SubscriptBox[\(T\), \
\(0\)]\),\!\(\*SubscriptBox[\(T\), \(1\)]\)}] lists those mutations that \
should be deleted because they occurred in time interval {\!\(\*SubscriptBox[\
\(T\), \(0\)]\),\!\(\*SubscriptBox[\(T\), \(1\)]\)}.  This list may be to \
some extent randomly generated. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b873fdba-2526-4ba2-92d2-94dcf199ee3c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomBottleneckedGenealogy[leaves,{T0,T1},\[Theta]] gives a random \
genealogy, with no mutations occurring in time interval {T0,T1}.\
\>", "Subsubsection",ExpressionUUID->"1f84362a-a8d2-44f4-bb4c-d413e21d734a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomBottleneckedGenealogy", "::", "usage"}], "=", 
   "\"\<RandomBottleneckedGenealogy[leaves,{T0,T1},\[Theta]] gives a random \
genealogy, with no mutations occurring in time interval {T0,T1}.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0e4eeccc-94b7-43b1-bff9-504d70235e41"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generating functions", "Subsection",ExpressionUUID->"3c0a79b0-9fd8-458e-b8d2-ef43732b27f4"],

Cell[CellGroupData[{

Cell["\<\
MomentGeneratingFunction[g,\[Omega],\[Theta]] gives the generating function \
for the number of mutations along each branch of the genealogy, under the \
infinite sites model.\
\>", "Subsubsection",ExpressionUUID->"567e343a-9408-4d48-b6ad-7b528e9bfa10"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MomentGeneratingFunction", "::", "usage"}], "=", 
   "\"\<MomentGeneratingFunction[g,\[Omega],\[Theta]] gives the generating \
function for the number of mutations along each branch of the genealogy, \
under the infinite sites model. \
MomentGeneratingFunction[{{a},{b},\[Ellipsis]},\[Omega],\[Theta]] gives the \
generating function for all tree topologies, in terms of variables \
\[Omega][S] which correspond to those mutations in branches ancestral to the \
set of leaves S. Stores results. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e9b6fa00-bd73-4c88-92f2-b7ffcc4611da"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["The probability of genealogies", "Subsection",ExpressionUUID->"8cff91c9-d639-462e-a9a4-64a0fa148ae5"],

Cell[CellGroupData[{

Cell["\<\
IncidenceMatrix[g,nodelist] gives the matrix describing an ordering of \
coalescences defined by nodelist.  The last member of nodelist is the root \
node.  The elements of the matrix show whether a branch is present during the \
time for which there are 1\[LessEqual]i\[LessEqual]n lineages. Rows \
correspond to branches, in the order specified by nodelist. \
\>", "Subsubsection",ExpressionUUID->"a37e8bc4-6896-44b5-b55a-8f07d40c8f72"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IncidenceMatrix", "::", "usage"}], "=", 
   RowBox[{
    RowBox[{"IncidenceMatrix", "::", "usage"}], "<>", 
    "\"\<  For genealogies, IncidenceMatrix[g,nodelist] gives the matrix \
describing an ordering of coalescences defined by nodelist.  The last member \
of nodelist is the root node.  The elements of the matrix show whether a \
branch is present during the time for which there are 1\[LessEqual]i\
\[LessEqual]n lineages. Rows correspond to branches, in the order specified \
by nodelist. \>\""}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f7acffba-beef-4bb7-a595-0a7e042bcc5f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MonteCarloProbability[g,nodelist,J,\[Theta],ns] makes a Monte Carlo estimate \
of the probability of the genealogy g and the mutational configuration J, \
assuming that the coalescences are in the order specified by nodelist. A list \
of ns values is returned. MonteCarloProbability[g,J,\[Theta],ns] makes no \
assumptions as to the order of events.\
\>", "Subsubsection",ExpressionUUID->"560624db-95ab-4585-ab20-e3a867db1648"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MonteCarloProbability", "::", "usage"}], "=", 
   "\"\<MonteCarloProbability[g,nodelist,J,\[Theta],\!\(\*SuperscriptBox[\(\
\[Theta]\), \(*\)]\),ns] makes a Monte Carlo estimate of the probability of \
the genealogy g and the mutational configuration J, assuming that the \
coalescences are in the order specified by nodelist. A list of ns values is \
returned. \
MonteCarloProbability[g,J,\[Theta],\!\(\*SuperscriptBox[\(\[Theta]\), \
\(*\)]\),ns] makes no assumptions as to the order of events. Uses the \
arbitrary parameter \!\(\*SuperscriptBox[\(\[Theta]\), \(*\)]\) to make \
random partitions.  \!\(\*SuperscriptBox[\(\[Theta]\), \(*\)]\) must be a \
number, but \[Theta] can be symbolic.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"de32fa1a-b541-479e-909a-3394d125bfb4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
PossibleCoalescenceOrder[g] lists the possible orders in which coalescence \
events might occur; each is given by an ordered list of nodes.\
\>", "Subsubsection",ExpressionUUID->"713563d9-4cb7-4798-9907-8ffae4eb60fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PossibleCoalescenceOrder", "::", "usage"}], "=", 
   "\"\<PossibleCoalescenceOrder[g] lists the possible orders in which \
coalescence events might occur; each is given by an ordered list of nodes.  \
Leaves are listed first, and the root node last.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"4386b281-d16e-4908-9af9-75565714cb2c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomCoalescenceOrder[g] gives a random ordering of the possible coalescence \
events\
\>", "Subsubsection",ExpressionUUID->"63a372de-4f84-4cb0-abd0-3b04bf703f54"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomCoalescenceOrder", "::", "usage"}], "=", 
   "\"\<RandomCoalescenceOrder[g] gives a random ordering of the possible \
coalescence events\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"30289dc4-f738-4d69-a600-ff8bf342780c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
NumberOfPossibleCoalescences[g,nodelist] gives the number of possible \
coalescences that could occur at each step. Only internal nodes are included. \
The order of coalescences is defined by nodelist\
\>", "Subsubsection",ExpressionUUID->"3de7d576-ae30-4795-a1af-9f803d72c3f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfPossibleCoalescences", "::", "usage"}], "=", 
   "\"\<NumberOfPossibleCoalescences[g,nodelist] gives the number of possible \
coalescences that could occur at each step. Only internal nodes are included. \
The order of coalescences is defined by nodelist\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"93a46ae1-8192-4c57-ab31-3182e9a4a511"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
NumberOfMutations[g,node] gives the number of mutations that occurred on the \
branch leading down to the specified node. The set of mutations is given in \
the second element of the information for each node.\
\>", "Subsubsection",ExpressionUUID->"f5ba2fbc-ccf3-4ec6-bd2b-6b70f7277523"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfMutations", "::", "usage"}], "=", 
   "\"\<NumberOfMutations[g,node] gives the number of mutations that occurred \
on the branch leading down to the specified node. The set of mutations is \
given in the second element of the information for each node. \>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7637044a-18bc-4b1e-8183-77493493a945"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Mutations[g] gives the set of mutations that occured on g.  Mutations[g,i] \
gives the mutations that arose on the branch leading down to node i.  By \
default, these are held in the second element of the information list.  \
NodeFunction\[Rule]f uses f[i,info] to extract the mutation list.\
\>", "Subsubsection",ExpressionUUID->"67e0109e-5054-4c8a-9cbd-e2149d11c3c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Mutations", "::", "usage"}], "=", 
   "\"\<Mutations[g] gives the set of mutations that occured on g.  \
Mutations[g,i] gives the mutations that arose on the branch leading down to \
node i.  By default, these are held in the second element of the information \
list.  NodeFunction\[Rule]f uses f[i,info] to extract the mutation \
list.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"1c2533b8-4b0e-48a3-921a-a1f384650e90"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MutationOrigin[g,k] gives the first node at which mutation k appears.\
\>", "Subsubsection",ExpressionUUID->"8cf6b5cb-0ffd-44c3-85dc-be1a47a57335"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MutationOrigin", "::", "usage"}], "=", 
   "\"\<MutationOrigin[g,k] gives the first node at which mutation k appears. \
  By default, the mutations are held in the second element of the information \
list, and the coalescence time as the first element.  NodeFunction\[Rule]f \
uses f[i,info] to return {time,mutations}.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e7fb69ad-eb02-469b-8609-519c9d0ca553"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MutationInterval[g,k] gives the time .interval in which mutation k arose.  \
\>", "Subsubsection",ExpressionUUID->"4fd0daf4-7092-49cc-a071-5f17ef71f279"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MutationInterval", "::", "usage"}], "=", 
   "\"\<MutationInterval[g,k] gives the time interval in which mutation k \
arose.  By default, the mutations are held in the second element of the \
information list, and the coalescence time as the first element.  \
NodeFunction\[Rule]f uses f[i,info] to return {time,mutations}.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"75b268e3-a458-4f98-a053-a7ae5fad939c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ExactProbability[g,\[Theta]] gives the probability of this genealogy, given a \
scaled mutation rate \[Theta]=4N\[VeryThinSpace]\[Mu]. By default, the number \
of mutations is deduced from a list of unique mutations held in the second \
element of the information list.  NodeFunction\[Rule]f uses f[i,info] to find \
the number of mutations. Uses MomentGeneratingFunction[], and so is \
intractable for large numbers of mutations and for large genealogies.  \
ExactProbability[S,\[Theta]] uses the generating function over all topologies \
to find the net probability of the configuration of mutations represented by \
the matrix S.\
\>", "Subsubsection",ExpressionUUID->"a7cd0a6d-2281-422e-9ccc-373e47ad9a5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExactProbability", "::", "usage"}], "=", 
   "\"\<ExactProbability[g,\[Theta]] gives the probability of this genealogy, \
given a scaled mutation rate \[Theta]=4N\[VeryThinSpace]\[Mu]. By default, \
the number of mutations is deduced from a list of unique mutations held in \
the second element of the information list.  NodeFunction\[Rule]f uses \
f[i,info] to find the number of mutations. Uses MomentGeneratingFunction[], \
and so is intractable for large numbers of mutations and for large \
genealogies.  ExactProbability[S,\[Theta]] uses the generating function over \
all topologies to find the net probability of the configuration of mutations \
represented by the matrix S.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"84c777b7-1d05-4f9d-aacc-56b9ce5679b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
GenealogyToMatrix[g] gives a matrix whose rows specify which mutations are \
found in which leaf of the genealogy.  By default, the list of mutations is \
taken from the second element of the information list.  NodeFunction\[Rule]f \
uses f[i,info] to specify the mutations in each node.\
\>", "Subsubsection",ExpressionUUID->"cb12ff74-1cf3-4eff-b47e-80873628e981"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenealogyToMatrix", "::", "usage"}], "=", 
   "\"\<GenealogyToMatrix[g] gives a matrix whose rows specify which \
mutations are found in which leaf of the genealogy. The genealogy can be \
unrooted. By default, the list of mutations is taken from the second element \
of the information list.  NodeFunction\[Rule]f uses f[i,info] to specify the \
mutations in each node.  MutationLabels->{\!\(\*SubscriptBox[\(m\), \(1\)]\),\
\[Ellipsis]} specifies the names of the mutations; by default, the list is \
the set of mutations found in g.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"98132254-c01e-4374-af7f-0d3d9801dff1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"MatrixToGenealogy", "[", 
     RowBox[{"S", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["leaf", "1"], ",", " ", 
        SubscriptBox["leaf", "2"], ",", "\[Ellipsis]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], ",", "\[Ellipsis]"}], "}"}]}], "]"}], " ",
     "constructs", " ", "a", " ", "genealogy", " ", "from", " ", "the", " ", 
    "matrix", " ", 
    RowBox[{"S", ".", "  ", "The"}], " ", "leaves", " ", "are", " ", 
    "labelled", " ", "by", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["leaf", "1"], ",", " ", "\[Ellipsis]"}], "}"}], " ", "and",
     " ", "the", " ", "mutations", " ", "by", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Mu]", "1"], ",", "\[Ellipsis]"}], "}"}]}], ";", " ", 
   RowBox[{
   "internal", " ", "nodes", " ", "are", " ", "labelled", " ", "by", " ", 
    "unique", " ", "integers"}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"93cc50d9-a4d9-495c-a66c-336bd867d389"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixToGenealogy", "::", "usage"}], "=", 
   "\"\<MatrixToGenealogy[S,{\!\(\*SubscriptBox[\(leaf\), \(1\)]\), \
\!\(\*SubscriptBox[\(leaf\), \
\(2\)]\),\[Ellipsis]},{\!\(\*SubscriptBox[\(\[Mu]\), \(1\)]\),\[Ellipsis]}] \
constructs a genealogy from the matrix S.  The leaves are labelled by \
{\!\(\*SubscriptBox[\(leaf\), \(1\)]\), \[Ellipsis]} and the mutations by {\!\
\(\*SubscriptBox[\(\[Mu]\), \(1\)]\),\[Ellipsis]}; internal nodes are \
labelled by unique integers.  Unrooted->True yields an unrooted genealogy; no \
assumption is made as to which allele is ancestral and which derived.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ee8b7265-090c-4a35-b283-6d1f4956702c"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"MatrixToList", "[", "S", "]"}], " ", "converts", " ", "a", " ", 
    "matrix", " ", "representation", " ", "to", " ", "a", " ", "list", " ", 
    "of", " ", "the", " ", "mutations", " ", "held", " ", "by", " ", "each", 
    " ", 
    RowBox[{"leaf", ".", "  ", "By"}], " ", "default"}], ",", " ", 
   RowBox[{"mutations", " ", "are", " ", "numbered", " ", "1"}], ",", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"\[Ellipsis]", ".", "  ", "MutationLabels"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}], " ", "uses", " ", 
     "the", " ", "specified", " ", 
     RowBox[{"labels", "."}]}]}]}], TextForm]], "Subsubsection",ExpressionUUID\
->"3349053d-83c7-4933-9981-62aac1a81932"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixToList", "::", "usage"}], "=", 
   "\"\<MatrixToList[S] converts a matrix representation to a list of the \
mutations held by each leaf.  By default, mutations are numbered 1,2\
\[Ellipsis].  MutationLabels\[Rule]{\!\(\*SubscriptBox[\(m\), \(1\)]\),\
\[Ellipsis]} uses the specified labels.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c7712eab-1461-4a5a-9fae-2c2d851d1c1b"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"FindNode", "[", 
     RowBox[{"g", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}], ",", "newNode"}],
      "]"}], " ", "finds", " ", "from", " ", "where", " ", "in", " ", "the", 
    " ", "genealogy", " ", "g", " ", "a", " ", "leaf", " ", "carrying", " ", 
    "mutations", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}], " ", 
    RowBox[{"descends", ".", "  ", "If"}], " ", "no", " ", "node", " ", "or", 
    " ", "branch", " ", "matches"}], ",", " ", 
   RowBox[{"returns", " ", 
    RowBox[{"$Failed", ".", " ", "If"}], " ", "the", " ", "leaf", " ", 
    "joins", " ", "the", " ", "branch", " ", "above", " ", "node", " ", "i"}],
    ",", " ", 
   RowBox[{"returns", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "newNode", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}]}], "}"}]}], ",", 
   " ", 
   RowBox[{
   "where", " ", "newNode", " ", "is", " ", "a", " ", "new", " ", "node", " ",
     "label"}], ",", " ", 
   RowBox[{"distinct", " ", "from", " ", "any", " ", "other", " ", "in", " ", 
    RowBox[{"g", ".", " ", "The"}], " ", "last", " ", "element", " ", "lists",
     " ", "the", " ", "mutations", " ", "carried", " ", "at", " ", "the", " ",
     "new", " ", 
    RowBox[{"node", ".", "  ", "If"}], " ", "the", " ", "leaf", " ", "joins", 
    " ", "at", " ", "node", " ", "i"}], ",", " ", 
   RowBox[{"returns", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "i", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}]}], "}"}]}], ",", 
   " ", 
   RowBox[{
   "where", " ", "the", " ", "last", " ", "element", " ", "lists", " ", "the",
     " ", "mutations", " ", "carried", " ", "at", " ", "node", " ", 
    RowBox[{"i", ".", "    ", "The"}], " ", "new", " ", "leaf", " ", "MUST", 
    " ", "contain", " ", "all", " ", "the", " ", "mutations", " ", "in", " ", 
    "the", " ", "root", " ", "node", " ", "of", " ", 
    RowBox[{"g", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"b1978156-4c6e-4a7e-aa7b-b65d89f6105a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindNode", "::", "usage"}], "=", 
   "\"\<FindNode[g,{\!\(\*SubscriptBox[\(m\), \(1\)]\),\[Ellipsis]},newNode] \
finds from where in the genealogy g a leaf carrying mutations \
{\!\(\*SubscriptBox[\(m\), \(1\)]\),\[Ellipsis]} descends.  If no node or \
branch matches, returns $Failed. If the leaf joins the branch above node i, \
returns {i,newNode,{\!\(\*SubscriptBox[\(m\), \(1\)]\),\[Ellipsis]}}, where \
newNode is a new node label, distinct from any other in g. The last element \
lists the mutations carried at the new node.  If the leaf joins at node i, \
returns {i,i,{\!\(\*SubscriptBox[\(m\), \(1\)]\),\[Ellipsis]}}, where the \
last element lists the mutations carried at node i.    The new leaf MUST \
contain all the mutations in the root node of g, and g must carry at least \
one mutation on each branch, except for branches loeading down to \
leaves.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"61679b91-6638-47c0-9edd-bd9f2d29fb67"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   FormBox[
    RowBox[{"MutationLabels", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}]}],
    TextForm], " ", "is", " ", "an", " ", "option", " ", "for", " ", 
   RowBox[{"MatrixToList", "[", "]"}], " ", "which", " ", "labels", " ", 
   "the", " ", "mutations", " ", "as", " ", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}]}], 
  TextForm]], "Subsubsection",ExpressionUUID->"a5f8f520-51c9-477b-a9c2-\
e25f0a6c7bf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MutationLabels", "::", "usage"}], "=", 
   "\"\<MutationLabels is an option for MatrixToList[] which labels the \
mutations.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9271fea8-6c68-4815-ad7b-fb1243593f2c"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"ListToMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", "4", "}"}], ",", "\[Ellipsis]"}], "}"}], "]"}], " ", 
    "converts", " ", "a", " ", "list", " ", "of", " ", "mutations", " ", 
    "present", " ", "at", " ", "each", " ", "node", " ", "into", " ", "a", 
    " ", "matrix", " ", 
    RowBox[{"representation", ".", "  ", "MutationLabels"}]}], "\[Rule]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}], " ", "gives", " ", 
    "the", " ", "columns", " ", "in", " ", "the", " ", "specified", " ", 
    RowBox[{"order", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"bfb8cb1b-5dd5-403b-a207-c9c47a940540"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ListToMatrix", "::", "usage"}], "=", 
   "\"\<ListToMatrix[{{1,2,3},{4},\[Ellipsis]}] converts a list of mutations \
present at each node into a matrix representation.  \
MutationLabels\[Rule]{\!\(\*SubscriptBox[\(m\), \(1\)]\),\[Ellipsis]} gives \
the columns in the specified order.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"1557035f-f96e-4fd6-99f8-c640d51c062a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
GriffithsTavare[S,\[Theta]] uses the Griffiths-Tavare algorithm to find the \
probability of a configuration of mutations defined by the matrix S.\
\>", "Subsubsection",ExpressionUUID->"e9648605-ea77-4296-8679-d73e840ef7e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GriffithsTavare", "::", "usage"}], "=", 
   "\"\<GriffithsTavare[S,\[Theta]] uses the Griffiths-Tavare algorithm to \
find the probability of a configuration of mutations defined by the matrix S.\
\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7e551f21-eb17-4bfc-8a3e-120cb7c4757c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MonteCarloGriffithsTavare[S,\[Theta]] uses the Monte-Carlo Griffiths-Tavare \
algorithm to find the probability of a configuration of mutations defined by \
the matrix S.\
\>", "Subsubsection",ExpressionUUID->"78431a0c-8d70-46b2-99cb-9445499febb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MonteCarloGriffithsTavare", "::", "usage"}], "=", 
   "\"\<MonteCarloGriffithsTavare[S,\[Theta]] uses the Monte-Carlo \
Griffiths-Tavare algorithm to find the probability of a configuration of \
mutations defined by the matrix S.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"932ef5c5-3f6c-4944-a34c-fe57afb3216d"]
}, Closed]],

Cell[CellGroupData[{

Cell["ValidMatrixQ", "Subsubsection",ExpressionUUID->"da02840b-ca16-4f06-9b5a-e725d224a888"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ValidMatrixQ", "::", "usage"}], "=", 
   "\"\<ValidMatrixQ[S] determines whether a matrix of mutations, S, is \
compatible with a genealogy. The i'th row of S is a list of {1,0,\[Ellipsis]} \
representing the set of mutations present in the i'th leaf. \
Unrooted\[Rule]True does not assume that a '1' represents a new mutation: 0, \
1 just represent two alternative alleles. ValidMatrixQ[{0,1\[Ellipsis]},{1,0,\
\[Ellipsis]}] tests a particular pair of mutations.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c733cda5-a7a0-4e76-918e-42cffa69bc92"]
}, Closed]],

Cell[CellGroupData[{

Cell["Unrooted", "Subsubsection",ExpressionUUID->"19a17dca-4953-4254-afca-cbc867fdc224"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Unrooted", "::", "usage"}], "=", 
   "\"\<Unrooted is an option for ValidMatrixQ which specifies that the \
genealogy is unrooted - i.e., no assumption is made about which allele is \
ancestral\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8f44a624-ac72-41d8-8109-937db6c2b3b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["SwapStates", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"1c3c80f3-bec2-43e1-a7cf-028360c0f4e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SwapStates", "::", "usage"}], "=", 
   "\"\<SwapStates[s,S] swaps the states of mutations listed in the matrix S, \
according to the specification s.  The matrix S has dimensions # leaves\
\[Times]# mutations, and s is a vector of length equal to the # of mutations. \
 Both consist of 0 or 1.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7d535e91-03a8-42f9-9fc6-1ca5b0908fc5"]
}, Closed]],

Cell[CellGroupData[{

Cell["MissingCombination", "Subsubsection",ExpressionUUID->"3b7d6f32-8f25-4e5f-875f-1785f46ea0a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MissingCombination", "::", "usage"}], "=", 
   "\"\<MissingCombination[S] tabulates the missing combinations for each \
pair of mutations listed in S.  Each element contains {} if there are less \
than 3 combinations for that pair.  If there are 4 combinations, the matrix \
is invalid, and an error message is returned.  If there are three \
combinations, the missing combination is returned; swaps represented by this \
combination are not allowed.  Stores results.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"52ffa551-df1d-4296-9156-09c3972768c7"]
}, Closed]],

Cell[CellGroupData[{

Cell["PossibleRootings", "Subsubsection",ExpressionUUID->"d8b42d98-c3a9-4309-8a6b-77bf7adde7e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PossibleRootings", "::", "usage"}], "=", 
   "\"\<PossibleRootings[S] lists all valid ways of rooting the mutations \
listed in S. Returns a list, in which each row {0,1,\[Ellipsis]} indicates \
whether an allele `1` is to be taken as ancestral (1) or derived (0). \
PossibleRootings[{{Null,0,1,Null\[Ellipsis]},\[Ellipsis]},S] eliminates \
indeterminate mutations, indicated by Null, until the solution is \
found.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8c926f4f-8ad8-4c18-89bd-548b3d340967"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddMutation", "Subsubsection",ExpressionUUID->"a06ef4f2-f5c1-42e1-8888-e1534fdcbd5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddMutation", "::", "usage"}], "=", 
   "\"\<AddMutation[n,m,g] adds the mutations m to node n; m can be one \
mutation,or a list of mutations. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7653624160353203`*^9, 
  3.765362418103057*^9}},ExpressionUUID->"614f65bb-c53d-4ec8-991d-\
d181a424e452"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"AddMutation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["n", "1"], ",", 
       SubscriptBox["n", "2"], ",", "\[Ellipsis]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"], ",", "\[Ellipsis]"}], "}"}], ",", "g"}], "]"}],
    " ", "adds", " ", "to", " ", "a", " ", "list", " ", "of", " ", 
   RowBox[{"nodes", ".", " ", "Mutations"}], " ", "are", " ", "held", " ", 
   "as", " ", "the", " ", "second", " ", "element", " ", "of", " ", "the", 
   " ", "information", " ", 
   RowBox[{"list", ".", "  ", "\"\<;\>"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7653624160353203`*^9, 
  3.765362421847825*^9}},ExpressionUUID->"6c2f277a-0e33-4402-ab04-\
96cb7e9b6b6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CondenseMatrix", "Subsubsection",ExpressionUUID->"fded4f2b-fed6-4095-aca1-46a8b1767286"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CondenseMatrix", "::", "usage"}], "=", 
   "\"\<CondenseMatrix[S] reduces the matrix S to the minimum informative \
size. Columns depicting mutations with the same distribution across leaves, \
mutations fixed across the whole set, or present in only one leaf, are \
removed.  Unrooted->True also removes one of each pair of complementary \
mutations (e.g. {0,0,1,1} and {1,1,0,0}).\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9978a975-58dd-47aa-8a5b-fd5843c0749a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Recombination", "Subsection",ExpressionUUID->"814f99ac-a726-4340-9662-b1ea3e85f04a"],

Cell[CellGroupData[{

Cell["AncestralLineage", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"4546d7a0-ae10-49d8-87c4-5f6fea62d800"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AncestralLineage", "::", "usage"}], "=", 
   "\"\<AncestralLineage[l, {t0, t1}, {{a, b}, {}, {c, d}, {c}}, {r1, r2, r3, \
R}, {info}] represents one lineage in an ancestral graph.  It gives the name \
of the lineage, l; the timespan, {t0,t1}; the leaves which descend from the \
various segments, {{a,b},{},{c,d},{c}}; and the rightmost positions of each \
segment, {r1,r2,r3,R}.  The genome spans {0,R}.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"85c4462e-77f3-4866-8263-fc75eb013f55"]
}, Closed]],

Cell[CellGroupData[{

Cell["AncestralGraphPattern", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"231991c6-07fc-431b-9e25-ab3e387e48da"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AncestralGraphPattern", "::", "usage"}], "=", 
   "\"\<AncestralGraphPattern is matched by a list {AncestralLineage[\
\[Ellipsis]]...}, representing an ancestral graph. No detailed checks are \
made that this is a valid graph, however.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b4704cf6-a497-4a27-910e-c7f4ad0afd28"]
}, Closed]],

Cell[CellGroupData[{

Cell["AncestralLineagePattern", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"9fcf6144-f57d-406f-9739-9eef7ace5302"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AncestralLineagePattern", "::", "usage"}], "=", 
   "\"\<AncestralLineagePattern is matched by an \
AncestralLineage[\[Ellipsis]]\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"99da6456-91c2-4c4a-aecd-ff226426f0bd"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractLabel", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"8639c5a7-f91c-404a-acda-4bc73b7d4b78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLabel", "::", "usage"}], "=", 
   "\"\<ExtractLabel is a rule which replaces AncestralLineage[l,\[Ellipsis]] \
by its label, l.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e3caadfb-d32e-4763-8038-061abf9a0046"]
}, Closed]],

Cell[CellGroupData[{

Cell["CoalesceLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"6b7352db-5959-455e-87ab-e26319452936"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalesceLineages", "::", "usage"}], "=", 
   "\"\<CoalesceLineages[AncestralLineage[l1,\[Ellipsis]],AncestralLineage[l2,\
\[Ellipsis]],l12,t] gives a lineage l12 which is ancestral to l1, l2, \
generated by a coalescence event at time t.  By default, corresponding \
elements of information lists are put into a set; InformationFunction\[Rule]f \
generates a new information list f[\!\(\*SubscriptBox[\(i\), \
\(1\)]\),\!\(\*SubscriptBox[\(i\), \(2\)]\)]\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8e67b1f1-ecda-4ac7-bfd9-229e4d4e8f8e"]
}, Closed]],

Cell[CellGroupData[{

Cell["InformationFunction", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"e5fab877-c82f-4dca-998d-95f3087a7646"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InformationFunction", "::", "usage"}], "=", 
   "\"\<InformationFunction->f is an option for functions dealing with \
ancestral graphs, which specifies how the information associated with each \
lineage should be handled.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d92074d2-e0c4-4028-a051-8f1dd59f8d7c"]
}, Closed]],

Cell[CellGroupData[{

Cell["RecombineLineage", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"e799090a-8d54-4d9e-be91-628e1cf42907"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RecombineLineage", "::", "usage"}], "=", 
   "\"\<RecombineLineage[AncestralLineage[l,\[Ellipsis]],{lL,lR},x,t] \
generates two recombinant lineages, with breakpoint at map position x, and \
labelled lL, lR. By default, the information lists are duplicated; \
InformationFunction\[Rule]{fL,fR} generates a pair of information lists \
{fL[i],fR[i]}.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"810811e2-2b55-4dd5-b648-6721277fbe20"]
}, Closed]],

Cell[CellGroupData[{

Cell["Junctions", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"5a062edc-7b28-4fc0-9431-ad8a2067122c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Junctions", "::", "usage"}], "=", 
   "\"\<Junctions[AncestralLineage[\[Ellipsis]]] lists the junctions present \
in the lineage.  Junctions[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] lists \
all the junctions present in the ancestral graph. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"2747ae40-646c-4bd3-b553-2049036678e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["MapLength", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"c02ecd09-f543-4823-b8dc-edee02c79198"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MapLength", "::", "usage"}], "=", 
   "\"\<MapLength[AncestralLineage[\[Ellipsis]]] or \
MapLength[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] gives the map length, \
R. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9aa95df9-7afd-45fc-a97c-c674f2028693"]
}, Closed]],

Cell[CellGroupData[{

Cell["LineagesPresent", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"cdb2410f-9bae-4670-bb16-407b10969032"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LineagesPresent", "::", "usage"}], "=", 
   "\"\<LineagesPresent[{AncestralLineage[\[Ellipsis]],\[Ellipsis]},t] gives \
the set of lineages present at time t. LineagesPresent[{AncestralLineage[\
\[Ellipsis]],\[Ellipsis]}] lists all lineages\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"82787dd9-770b-46a0-91a5-9dd3fb7ce3d6"]
}, Closed]],

Cell[CellGroupData[{

Cell["RecombinantLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"1a2aaa62-3a0d-4bf0-8655-0ae17bb6f8b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RecombinantLineages", "::", "usage"}], "=", 
   "\"\<RecombinantLineages[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] gives \
lineages which start at the same time as a sister lineage\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"03944aac-fd3e-4c73-8db8-b9b02467861e"]
}, Closed]],

Cell[CellGroupData[{

Cell["CoalescentLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"3e72cd10-cf35-49c4-ad13-f9e5aa7dbc40"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalescentLineages", "::", "usage"}], "=", 
   "\"\<CoalescentLineages[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] gives \
lineages which start at the same time as two other lineages end\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"760ebf28-4340-46c6-b8f4-882055006814"]
}, Closed]],

Cell[CellGroupData[{

Cell["RootLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"a7be4e3e-ef74-4607-a117-64d8cd0dcda1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RootLineages", "::", "usage"}], "=", 
   "\"\<RootLineages[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] gives \
lineages which end when no other lineages begin.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"93c36080-4cf4-4d22-aeba-ea28246c2455"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractLineage", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"592ed084-2aa8-4065-83a9-92572559d037"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLineage", "::", "usage"}], "=", 
   "\"\<ExtractLineage[{AncestralLineage[\[Ellipsis]]\[Ellipsis]},l] extracts \
the lineage labelled by l. Checks that there is only one such lineage. \
ExtractLineage[{AncestralLineage[\[Ellipsis]]\[Ellipsis]},{\!\(\*SubscriptBox[\
\(l\), \(1\)]\),\[Ellipsis]}] extracts a list of lineages. \>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d8993e0b-cd44-4f19-9219-41c630332df8"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractLineagesEndingAtT", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"420036d9-ce73-48a8-a200-57b1bac94bb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLineagesEndingAtT", "::", "usage"}], "=", 
   "\"\<ExtractLineagesEndingAtT[{AncestralLineage[\[Ellipsis]]\[Ellipsis]},t]\
 extracts those lineages which end at time t.  These are either root \
lineages, with no ancestors, or are generated by a coalescence or \
recombination.  Checks that these are present in the appropriate \
numbers.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"07167bcb-50c7-4a9a-82d5-a8c349e123b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractLineagesStartingAtT", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"d7cfe443-b9d3-47a9-84f1-7520ee23ecfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLineagesStartingAtT", "::", "usage"}], "=", 
   "\"\<ExtractLineagesStartingAtT[{AncestralLineage[\[Ellipsis]]\[Ellipsis]},\
t] extracts those lineages which start at time t.  These are either leaves, \
with no descendants, or are generated by a coalescence or recombination.  \
Checks that these are present in the appropriate numbers.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"98ace8d6-c859-4d27-9f60-44686a6e7432"]
}, Closed]],

Cell[CellGroupData[{

Cell["TimesOfEvents", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"4263842a-10d1-41e1-9ec5-2740d5bdc86e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TimesOfEvents", "::", "usage"}], "=", 
   "\"\<TimesOfEvents[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] lists all \
the times at which lineages begin or end.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5588dbe8-3011-496a-bb39-0f64e6de9051"]
}, Closed]],

Cell[CellGroupData[{

Cell["AllEvents", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"ed588190-75dd-4581-9f75-e726e40dac53"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AllEvents", "::", "usage"}], "=", 
   "\"\<AllEvents[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] lists all \
events at which lineages begin or end, in the form \
{t,descendants,ancestors,map position}. (The last element is set if there has \
been a recombination event; otherwise it is None).\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"112eb828-1aae-48a8-afaf-8737dd6c989d"],

Cell["CoalescenceEvents", "SubsubsectionIcon",
 InitializationCell->
  True,ExpressionUUID->"7ad48a21-d650-4581-8039-3107674a0b1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalescenceEvents", "::", "usage"}], "=", 
   "\"\<CoalescenceEvents[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] lists \
events at which lineages {\!\(\*SubscriptBox[\(l\), \(1\)]\),\[Ellipsis]} \
coalesce into lineage \!\(\*SubscriptBox[\(l\), \(p\)]\), in the form \
{t,{\!\(\*SubscriptBox[\(l\), \(1\)]\),\!\(\*SubscriptBox[\(l\), \(2\)]\)},\!\
\(\*SubscriptBox[\(l\), \(P\)]\)}.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"3b15043d-22ac-4f1c-9922-42331b49c3a8"],

Cell["NullLineages", "SubsubsectionIcon",ExpressionUUID->"ce49ec4e-b933-4892-8094-660eb4df7dff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NullLineages", "::", "usage"}], "=", 
   "\"\<NullLineages[g] lists those lineages which contain no material \
ancestral to the sample.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"bcc69798-c66d-4dbe-89cd-56c3533586d8"],

Cell["RecombinationEvents", "SubsubsectionIcon",
 InitializationCell->
  True,ExpressionUUID->"0114301d-fa22-4b62-a8e5-31c8a4d86164"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RecombinationEvents", "::", "usage"}], "=", 
   "\"\<RecombinationEvents[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] lists \
events at which a lineages \!\(\*SubscriptBox[\(l\), \(1\)]\) splits into two \
lineage {\!\(\*SubscriptBox[\(l\), \(L\)]\), \!\(\*SubscriptBox[\(l\), \(R\)]\
\)} in the form {t,{\!\(\*SubscriptBox[\(l\), \
\(p\)]\)},{\!\(\*SubscriptBox[\(l\), \(L\)]\),\!\(\*SubscriptBox[\(l\), \
\(R\)]\)},r}.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"168499f8-8c96-400f-a37f-854ba2346713"],

Cell["NullRecombinationEvents", "SubsubsectionIcon",
 InitializationCell->
  True,ExpressionUUID->"47214ae7-a203-4e00-b97f-85ce5672a317"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NullRecombinationEvents", "::", "usage"}], "=", 
   "\"\<NullRecombinationEvents[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] \
lists events at which a lineages \!\(\*SubscriptBox[\(l\), \(1\)]\) splits \
into two lineages {\!\(\*SubscriptBox[\(l\), \(L\)]\), \!\(\*SubscriptBox[\(l\
\), \(R\)]\)}, but where one of these is null.  These have the form \
{t,{\!\(\*SubscriptBox[\(l\), \(p\)]\)},{\!\(\*SubscriptBox[\(l\), \
\(L\)]\),\!\(\*SubscriptBox[\(l\), \(R\)]\)},R}.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"51e5f047-75cb-4d1b-a9e5-35a97e4977f9"],

Cell["LeafEvents", "SubsubsectionIcon",
 InitializationCell->
  True,ExpressionUUID->"a9d18030-e60f-40b7-89d1-b6e30c881802"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LeafEvents", "::", "usage"}], "=", 
   "\"\<LeafEvents[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] lists events \
at which a lineages becomes extinct.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"cb2dca7e-4570-4e7d-811b-2b8560b77585"],

Cell["RootEvents", "SubsubsectionIcon",
 InitializationCell->
  True,ExpressionUUID->"e5b8bbf0-85f9-4f00-a8f3-8591dcb68057"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RootEvents", "::", "usage"}], "=", 
   "\"\<RootEvents[{AncestralLineage[\[Ellipsis]]\[Ellipsis]}] lists events \
at which an ancestral lineage begins.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"54fc5603-e8c7-457b-b7f1-cecf1dee03ad"],

Cell["TimespanOfLineage", "SubsubsectionIcon",
 InitializationCell->
  True,ExpressionUUID->"23b87020-dd7b-41ba-82d7-aed630004eb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TimespanOfLineage", "::", "usage"}], "=", 
   "\"\<TimespanOfLineage[{AncestralLineage[\[Ellipsis]]\[Ellipsis]},l] gives \
the start and end times,{t0,t1}, of lineage l.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"bb5c69b1-c553-43f5-aedb-c58747a4733a"],

Cell["MapPosition", "SubsubsectionIcon",
 InitializationCell->
  True,ExpressionUUID->"0ab24a97-6a23-425d-94b0-97cb2eca93f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MapPosition", "::", "usage"}], "=", 
   "\"\<MapPosition\[Rule]x is an option for Descendants which specifies that \
only descendants at map position x are counted.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"88dfc5ca-0daf-4f23-9537-421ed43274b9"],

Cell["AddDescendants", "SubsubsectionIcon",
 InitializationCell->
  True,ExpressionUUID->"5a165c98-ba12-45fc-9704-f460bc22148f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddDescendants", "::", "usage"}], "=", 
   "\"\<AddDescendants[g,{l}] returns {l,Descendants[g,l]}.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ec538a10-b91b-438a-b26a-eb1a551427aa"]
}, Closed]],

Cell[CellGroupData[{

Cell["AncestorList", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"6ecd5964-cab6-42ec-9c44-17d56ddfde0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AncestorList", "::", "usage"}], "=", 
   "\"\<AncestorList is an option for Ancestors; it may be set to Previous, \
All or Roots\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"805adcde-6c06-444d-a771-57a50a4e675e"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddAncestors", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"3044cb0d-d2c0-4dbd-a3be-8dd1ae79b65e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddAncestors", "::", "usage"}], "=", 
   "\"\<AddAncestors[g,{l}] returns {l,Ancestors[g,l]}.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"189cef09-d8cf-4bb3-ada6-3a4e6c513eee"]
}, Closed]],

Cell[CellGroupData[{

Cell["DeleteNullLineages", "Subsubsection",ExpressionUUID->"b19d6c83-2943-4aea-a696-abb31ca209d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeleteNullLineages", "::", "usage"}], "=", 
   "\"\<DeleteNullLineages[g] deletes ancestral lineages that have no \
descedants.  DeleteNullLineages is also an option for AddRecombinantLineages \
which specifies whether lineages carrying no material ancestral to thhe \
sample are to be included.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"283e05b1-23c2-45a6-9ae0-2661acb23b24"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddRecombinantLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"bcf6b1d2-9ab9-4395-8c20-404cfd9d4648"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddRecombinantLineages", "::", "usage"}], "=", 
   "\"\<AddRecombinantLineages[g,l,{lL,lR},x,t] terminates lineage l, and \
adds two recombinant lineages {lL,lR} to the list g. DeleteNullLineages->True \
ignores null recombination events.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d377d87a-1a9c-4625-abe4-aa702719cfdd"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddCoalescentLineage", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"eb578bf0-b0f5-4992-8a64-a108322b973a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddCoalescentLineage", "::", "usage"}], "=", 
   "\"\<AddCoalescentLineage[g,{l1,l2},lC,t] terminates lineages {l1,l2} at \
t, and adds a coalescent lineage lC to the list g.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d2efb1cb-af63-4196-b6a3-49e5d575a30c"]
}, Closed]],

Cell[CellGroupData[{

Cell["PrintDetails", "Subsubsection",ExpressionUUID->"96acf816-48e3-4e34-83af-b8010163f704"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrintDetails", "::", "usage"}], "=", 
   "\"\<PrintDetails is an option for RandomGenealogy\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"82b6368b-922f-4cc5-b6f2-533b2b5caeca"]
}, Closed]],

Cell[CellGroupData[{

Cell["Segments", "Subsubsection",ExpressionUUID->"5115e91f-d186-42a3-bc60-42e86a4daefe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Segments", "::", "usage"}], "=", 
   "\"\<Segments[AncestralLineage[\[Ellipsis]],l] gives the blocks ancestral \
to l present within the lineage.  Segments[{AncestralLineage[\[Ellipsis]]\
\[Ellipsis]},l] applies to several lineages\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"64b6bee1-d1d9-4fa5-9163-d289d7cf1168"]
}, Closed]],

Cell[CellGroupData[{

Cell["PlotSegments", "Subsubsection",ExpressionUUID->"50c94ee1-6ec0-4026-8b33-e5c0f652b648"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlotSegments", "::", "usage"}], "=", 
   "\"\<PlotSegments[AncestralLineage[\[Ellipsis]],leaf,y] gives a Graphics[] \
object depicting the segments ancestral to the leaf; drawn at height y.  \
SegmentStyle\[Rule]{Blue,\[Ellipsis]} and BackgroundStyle\[Rule]{Yellow,\
\[Ellipsis]} set the style of the lines.  PlotSegments[{AncestralLineage[\
\[Ellipsis]]\[Ellipsis]},leaf,{y0,y1}] plots a series of lineages spanning \
{y0,y1}; JunctionStyle specifies vertical lines depicting the junctions. \
\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f2c51ac0-b56e-4998-9956-0f904b2137ba"]
}, Closed]],

Cell[CellGroupData[{

Cell["BackgroundStyle", "Subsubsection",ExpressionUUID->"1db30e19-37d1-4497-b62a-ba972c7eb5e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BackgroundStyle", "::", "usage"}], "=", 
   "\"\<BackgroundStyle is an option for PlotSegments which sets the style of \
non-ancestral parts of the chromosome; default {Yellow}\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9d6a7e1c-78c0-4f79-ba5c-6021f6faaf50"]
}, Closed]],

Cell[CellGroupData[{

Cell["SegmentStyle", "Subsubsection",ExpressionUUID->"77b43533-16d7-44fd-af0a-d04d948c9161"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SegmentStyle", "::", "usage"}], "=", 
   "\"\<SegmentStyle is an option for PlotSegments which sets the style of \
ancestral parts of the chromosome; default {Blue}\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"201ad0a3-7e37-4f40-8436-df0babc38d6c"]
}, Closed]],

Cell[CellGroupData[{

Cell["JunctionStyle", "Subsubsection",ExpressionUUID->"3366689c-d17e-48c8-bb42-cdcc21f638a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JunctionStyle", "::", "usage"}], "=", 
   "\"\<JunctionStyle is an option for PlotSegments which sets the style of \
vertical lines depicting junctions; default {Black}\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a4a0244c-ee32-4276-9065-12c2cafbae71"]
}, Closed]],

Cell[CellGroupData[{

Cell["TimeSpanOfJunctions", "Subsubsection",ExpressionUUID->"8e88dc4c-c973-441d-8e2c-3b17eb300cd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TimespanOfJunction", "::", "usage"}], "=", 
   "\"\<TimespanOfJunction[{AncestralLineage[\[Ellipsis]]\[Ellipsis]},j] \
finds the first and last occurrence of j. \>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7b721aef-8341-49a1-bd1c-732e43ffdd18"]
}, Closed]],

Cell[CellGroupData[{

Cell["FixedQ", "Subsubsection",ExpressionUUID->"259223af-bfb5-48c9-b5f0-ef22319a8766"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FixedQ", "::", "usage"}], "=", 
   "\"\<FixedQ[AncestralLineage[\[Ellipsis]],lvs] tests whether this \
ancestral lineage only contains segments ancestral to the entire set lvs.  \
Can also apply to an ancestral graph\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0582a9d5-cf45-4d7f-a182-5459aa7872bf"]
}, Closed]],

Cell[CellGroupData[{

Cell["MaxTime", "Subsubsection",ExpressionUUID->"b35465c0-2ddc-4aa1-87cd-b5bc3a663814"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MaxTime", "::", "usage"}], "=", 
   "\"\<MaxTime is an option for RandomGenealogy which specifies the maximum \
time to run the coalescent with recombination.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"33092e9c-4cb7-4246-a654-0de30871c519"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixation", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"892d8289-83d2-4f79-9459-8b9e653d34d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Fixation", "::", "usage"}], "=", 
   "\"\<Fixation is an option for RandomGenealogy which specifies that the \
coalescent with recombination stops at fixation\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8e8a8cf1-1e52-432f-bd45-fdf713dde66a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Describing genealogies", "Subsection",ExpressionUUID->"fea61a0c-d4a7-49fc-89b1-ecc41bddbc43"],

Cell[CellGroupData[{

Cell["MRCA", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"a9e507aa-456a-4d5e-9236-9ffe8ccdb576"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MRCA", "::", "usage"}], "=", 
   "\"\<MRCA[g,{\!\(\*SubscriptBox[\(node\), \(1\)]\),\[Ellipsis]}] gives the \
most recent common ancestor of the list of nodes.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"1c99bf41-501f-4678-b9da-a6f2fa6d2680"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PairwiseDivergence", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"ad2a05e4-cbf9-4cd6-aaa0-1644eb843374"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDivergence", "::", "usage"}], "=", 
   "\"\<PairwiseDivergence[g] lists the time to MRCA of all pairs of leaves.  \
PairwiseDivergence[g,{\!\(\*SubscriptBox[\(node\), \
\(1\)]\),\!\(\*SubscriptBox[\(node\), \(2\)]\)}] gives the time to the MRCA \
of these nodes.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"655f98c0-a102-4116-8f74-9fc398fba590"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PairwiseDifference", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"d87bfda8-6158-4c93-adfc-6a4c0d91e81f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDifference", "::", "usage"}], "=", 
   "\"\<PairwiseDifference[g] lists the number of sites which differ between \
randomly chosen pairs.  PairwiseDifference[g,{\!\(\*SubscriptBox[\(node\), \
\(1\)]\),\!\(\*SubscriptBox[\(node\), \(2\)]\),\[Ellipsis]}] gives the \
mutations which differ between the nodes, calculated as \
Complement[Union@@ml,Intersection@@ml]], where ml is a list of the mutations \
on each of the nodes. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.818413970249557*^9, 
  3.818414006481217*^9}},ExpressionUUID->"9f6a7136-1ea9-41f4-879a-\
fa159af56d85"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MeanPairwiseDivergence", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"751a2afe-487d-4b5e-ba9d-fd0cea7a7f90"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanPairwiseDivergence", "::", "usage"}], "=", 
   "\"\<MeanPairwiseDivergence[g] gives the mean time back to a common \
ancestor between two genes.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8c9f8729-92a4-4106-bd82-b8fb78d7edde"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractCoalescenceTimes", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"fc422beb-09ad-4a53-bb67-9925a41929b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractCoalescenceTimes", "::", "usage"}], "=", 
   "\"\<ExtractCoalescenceTimes[g] extracts a list of the coalescence \
times.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5200597d-c588-457d-8f6a-9a8725fe3e2c"]
}, Closed]],

Cell[CellGroupData[{

Cell["LengthOfGenealogy", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"1a75a82b-16c6-41ab-970c-db315d2db71f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LengthOfGenealogy", "::", "usage"}], "=", 
   "\"\<LengthOfGenealogy[g] gives the total length of the genealogy.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"463bd182-e6fc-4180-a592-2571dc24c3be"]
}, Closed]],

Cell[CellGroupData[{

Cell["DepthOfGenealogy", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"2102a59e-abe7-4137-b33b-90f09ba81689"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DepthOfGenealogy", "::", "usage"}], "=", 
   "\"\<DepthOfGenealogy[g] gives the time to the last common \
ancestor.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ece50383-9cc4-4a56-9047-00951c212d8b"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairwiseDivergencePlot", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"34e4132a-9a66-4eeb-8733-543371c44f90"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDivergencePlot", "::", "usage"}], "=", 
   "\"\<PairwiseDivergencePlot[g,{Dmax,\[Delta]}] plots the distribution of \
pairwise divergence as a histogram, on the range {0,Dmax}.  \
PairwiseDivergencePlot[{\!\(\*SubscriptBox[\(g\), \
\(1\)]\),\[Ellipsis]},{Dmax,\[Delta]}] plots the overall distribution for a \
set of replicate genealogies.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"050ae5a5-04cc-4bf3-a0fc-dc8d9489d56b"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairwiseDifferencePlot", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"acc26247-3d00-4440-af1e-0a36cf6b4295"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDifferencePlot", "::", "usage"}], "=", 
   "\"\<PairwiseDifferencePlot[g,{Dmax,\[Delta]}] plots the distribution of \
pairwise difference as a histogram, on the range {0,Dmax}.  \
PairwiseDifferencePlot[{\!\(\*SubscriptBox[\(g\), \
\(1\)]\),\[Ellipsis]},{Dmax,\[Delta]}] plots the overall distribution for a \
set of replicate genealogies.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"eba6b095-87f0-4a03-bbe6-25e912a9f21f"]
}, Closed]],

Cell[CellGroupData[{

Cell["BlockSizes", "Subsubsection",ExpressionUUID->"407c7968-6452-4f13-a975-a550184357cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockSizes", "::", "usage"}], "=", 
   "\"\<BlockSizes[AncestralLineage[l,{\!\(\*SubscriptBox[\(t\), \
\(0\)]\),\!\(\*SubscriptBox[\(t\), \(1\)]\)},{{},{\[Ellipsis]},\[Ellipsis]},{\
\!\(\*SubscriptBox[\(r\), \(1\)]\),\[Ellipsis],R},{\[Ellipsis]}]] returns the \
sizes of blocks with different descendants. BlockSizes[g] applies to a whole \
ancestral graph.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"6995ee3f-43aa-4961-917f-d77d1e999850"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Private parts", "Section",ExpressionUUID->"64fd5d6d-eb59-4944-85b9-7c70288a89d2"],

Cell[CellGroupData[{

Cell["\<\
Muddle[{a,b,c,..}] gives a random reordering of the list (obsolete: replaced \
by RandomSample[{a,b,c,\[Ellipsis]}])\
\>", "Subsubsection",
 CellChangeTimes->{{3.571282503384427*^9, 
  3.571282529759162*^9}},ExpressionUUID->"87cbf0b9-a717-4e23-8a8f-\
b91a5f778efb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Muddle", "[", "s_List", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"s", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Random", "[", "]"}], "<", 
        RowBox[{"1", "/", "2"}]}], ")"}], "&"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"54d84eba-b322-4b14-bd95-3ea3b0934e59"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Subdivide[{a,b,..},{1,2,3,..}] splits the list into subsets of the specified \
length.  BEWARE: the lengths must match.\
\>", "Subsubsection",ExpressionUUID->"2ec79627-10fc-4058-96c2-38a6a38b6874"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Subdivide", "::", "usage"}], "=", 
   "\"\<Subdivide[{a,b,..},{1,2,3,..}] splits the list into subsets of the \
specified length.  BEWARE: the lengths must match.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5712826024316797`*^9, 
  3.571282617798849*^9}},ExpressionUUID->"a1ca3df8-0370-4cde-82d8-\
e169040c5fcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Subdivide", "::", "lengthMismatch"}], "=", 
   "\"\<Length of set `1` does not match that requested,  `2`\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"256a2579-ccdc-4d45-9123-c791ed68fff7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Subdivide", "[", 
    RowBox[{"s_List", ",", 
     RowBox[{"{", 
      RowBox[{"j_Integer", ",", "k__Integer"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Take", "[", 
       RowBox[{"s", ",", "j"}], "]"}], "}"}], ",", 
     RowBox[{"Subdivide", "[", 
      RowBox[{
       RowBox[{"Drop", "[", 
        RowBox[{"s", ",", "j"}], "]"}], ",", 
       RowBox[{"{", "k", "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Subdivide", "[", 
    RowBox[{"s_List", ",", 
     RowBox[{"{", "k_Integer", "}"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"k", "==", 
      RowBox[{"Length", "[", "s", "]"}]}], ",", 
     RowBox[{"{", "s", "}"}], ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"Subdivide", "::", "lengthMismatch"}], ",", "s", ",", "k"}], 
       "]"}], ";", "s"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"c6f6f128-c0da-4ac8-a2ec-e5fb1c13a96f"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"Subdivide\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Subdivide\\\", \\\"[\\\", RowBox[{\\\"s_List\\\", \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"j_Integer\\\", \\\",\\\", \
\\\"k__Integer\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is Protected.\"",2,527,8,
   19604041926407031907,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.764759179861116*^9, 3.765348751433508*^9, 3.808039326750564*^9, 
   3.810726985761035*^9, 3.812092844082233*^9, 3.812793058830121*^9, 
   3.813456038957758*^9, 3.8134606239625998`*^9, 3.814611681517517*^9, 
   3.815717764321151*^9, 3.817256941167059*^9, 3.8173837083645763`*^9, 
   3.8173850119506817`*^9, 3.817653412129422*^9, 3.818405359032565*^9, 
   3.81959611917342*^9, 3.8235915747940598`*^9, 3.8263608566441708`*^9, {
   3.844841033416401*^9, 
   3.844841043893428*^9}},ExpressionUUID->"6578b6e0-140e-4bfc-ade3-\
ee55e6fb4729"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"Subdivide\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Subdivide\\\", \\\"[\\\", RowBox[{\\\"s_List\\\", \
\\\",\\\", RowBox[{\\\"{\\\", \\\"k_Integer\\\", \\\"}\\\"}]}], \
\\\"]\\\"}]\\) is Protected.\"",2,528,9,19604041926407031907,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.764759179861116*^9, 3.765348751433508*^9, 3.808039326750564*^9, 
   3.810726985761035*^9, 3.812092844082233*^9, 3.812793058830121*^9, 
   3.813456038957758*^9, 3.8134606239625998`*^9, 3.814611681517517*^9, 
   3.815717764321151*^9, 3.817256941167059*^9, 3.8173837083645763`*^9, 
   3.8173850119506817`*^9, 3.817653412129422*^9, 3.818405359032565*^9, 
   3.81959611917342*^9, 3.8235915747940598`*^9, 3.8263608566441708`*^9, {
   3.844841033416401*^9, 
   3.844841044154602*^9}},ExpressionUUID->"f6952841-e20b-4442-83fd-\
caf1fc594747"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomSet[j,k] gives a random (ordered) set of j distinct integers in the \
range {1,k}.  (j\[LessEqual]k).  RandomSet[j,{a,b,..}] gives j randomly \
chosen elements from the set {a,b,..}.\
\>", "Subsubsection",ExpressionUUID->"b98b10bc-7fb1-4673-8066-a0a49366993a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomSet", "::", "usage"}], "=", 
   "\"\<RandomSet[j,k] gives a random (ordered) set of j distinct integers in \
the range {1,k}.  (j\[LessEqual]k).  RandomSet[j,{a,b,..}] gives j randomly \
chosen elements from the set {a,b,..}. OBSOLETE: replaced by \
Sort[RandomSample[Range[k],j]] or RandomSample[{a,b,\[Ellipsis]},j]. \>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571282679624055*^9, 3.571282771654059*^9}, {
  3.571282824074667*^9, 
  3.571282832252378*^9}},ExpressionUUID->"1433c9f5-a99a-4868-8e3f-\
fb5658a9dac6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RandomSet", "[", 
    RowBox[{"j_Integer", ",", "s_List"}], "]"}], ":=", 
   RowBox[{"Extract", "[", 
    RowBox[{"s", ",", 
     RowBox[{"List", "/@", 
      RowBox[{"RandomSet", "[", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "s", "]"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomSet", "[", 
    RowBox[{"j_Integer", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"RandomSetCompiled", "[", 
    RowBox[{"j", ",", "k"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"cd11f57a-43f4-4fe5-8d6a-c48755c89ef0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"RandomSet", "[", 
     RowBox[{"0", ",", "_Integer"}], "]"}], ":=", 
    RowBox[{"{", "}"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"RandomSet", "[", 
     RowBox[{"j_Integer", ",", "k_Integer"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rs", "=", 
         RowBox[{"RandomSet", "[", 
          RowBox[{
           RowBox[{"j", "-", "1"}], ",", "k"}], "]"}]}], ",", 
        RowBox[{"jj", "=", 
         RowBox[{"Random", "[", 
          RowBox[{"Integer", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"k", "-", "j", "+", "1"}]}], "}"}]}], "]"}]}]}], "}"}], 
      ",", "\n", 
      RowBox[{"Sort", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"rs", ",", 
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", "k", "]"}], ",", "rs"}], "]"}], 
          "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}], "]"}], 
       "]"}]}], "]"}]}], ";"}], "*)"}]], "Input",ExpressionUUID->"785f7639-\
72c2-427b-a702-73ef740bcfe5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RandomSet", "[", 
    RowBox[{
     RowBox[{"{", "x__Integer", "}"}], ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"RandomSet", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"Range", "[", "k", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomSet", "[", 
    RowBox[{
     RowBox[{"{", "x__Integer", "}"}], ",", "s_List"}], "]"}], ":=", 
   RowBox[{"Subdivide", "[", 
    RowBox[{
     RowBox[{"RandomSample", "[", "s", "]"}], ",", 
     RowBox[{"{", "x", "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.571282569810788*^9},ExpressionUUID->"72ce6b15-5b4c-481d-b603-\
edaea7ca6d3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomSetCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"aa", "=", 
          RowBox[{"Range", "[", "n", "]"}]}], ",", 
         RowBox[{"na", "=", "n"}], ",", 
         RowBox[{"ns", "=", 
          RowBox[{"{", "}"}]}], ",", "k", ",", "new"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", ">", "n"}], "\[Or]", 
           RowBox[{"j", "<", "0"}]}], ",", 
          RowBox[{"Message", "[", 
           RowBox[{"RandomSet", "::", "tooBig"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Quotient", "[", 
            RowBox[{"n", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Sort", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", "=", 
                RowBox[{"Random", "[", 
                 RowBox[{"Integer", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "na"}], "}"}]}], "]"}]}], ";", 
               RowBox[{"na", "-=", "1"}], ";", 
               RowBox[{"new", "=", 
                RowBox[{
                "aa", "\[LeftDoubleBracket]", "k", 
                 "\[RightDoubleBracket]"}]}], ";", 
               RowBox[{"aa", "=", 
                RowBox[{"Delete", "[", 
                 RowBox[{"aa", ",", "k"}], "]"}]}], ";", "new"}], ")"}], ",", 
             RowBox[{"{", "j", "}"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Sort", "[", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Range", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", "=", 
                  RowBox[{"Random", "[", 
                   RowBox[{"Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "na"}], "}"}]}], "]"}]}], ";", 
                 RowBox[{"na", "-=", "1"}], ";", 
                 RowBox[{"new", "=", 
                  RowBox[{
                  "aa", "\[LeftDoubleBracket]", "k", 
                   "\[RightDoubleBracket]"}]}], ";", 
                 RowBox[{"aa", "=", 
                  RowBox[{"Delete", "[", 
                   RowBox[{"aa", ",", "k"}], "]"}]}], ";", "new"}], ")"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"n", "-", "j"}], "}"}]}], "]"}]}], "]"}], "]"}]}], 
         "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ns", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"new", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", "_Integer", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b105befd-1dcf-4db2-9bb2-eeafe676860a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomSet", "::", "tooBig"}], "=", 
   "\"\<The number of distinct elements chosen must be no greater than the \
size of the set.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ba050378-3da9-499a-b8da-b1dcd23bcbdf"]
}, Closed]],

Cell[CellGroupData[{

Cell["TakeAway", "Subsubsection",ExpressionUUID->"039b95f2-3979-4df5-b63c-fd15547cc6e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "::", "usage"}], "=", 
   "\"\<TakeAway[U,V]  gives the set U, minus elements V. Note that this is \
not the same as Complement[U,V] if U contains repeated elements.  \>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5712843296303864`*^9, 
  3.5712843366293573`*^9}},ExpressionUUID->"0492bb78-d24e-4d4c-afd8-\
bb2c844d67a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "[", 
    RowBox[{"U_List", ",", 
     RowBox[{"{", "}"}]}], "]"}], ":=", "U"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "[", 
    RowBox[{"U_List", ",", 
     RowBox[{"{", "v_", "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Drop", "[", 
     RowBox[{"U", ",", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"U", ",", "v"}], "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"{", "v", "}"}], ",", "U"}], "]"}], "==", 
     RowBox[{"{", "}"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "[", 
    RowBox[{"U_List", ",", "V_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"TakeAway", "[", 
     RowBox[{
      RowBox[{"TakeAway", "[", 
       RowBox[{"U", ",", 
        RowBox[{"Take", "[", 
         RowBox[{"V", ",", "1"}], "]"}]}], "]"}], ",", 
      RowBox[{"Drop", "[", 
       RowBox[{"V", ",", "1"}], "]"}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{"V", ",", "U"}], "]"}], "==", 
     RowBox[{"{", "}"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "[", 
    RowBox[{"U_List", ",", "W__List", ",", "V_List"}], "]"}], ":=", 
   RowBox[{"TakeAway", "[", 
    RowBox[{
     RowBox[{"TakeAway", "[", 
      RowBox[{"U", ",", "W"}], "]"}], ",", "V"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"17930f96-2327-4eed-86cc-a3d5eef31633"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ExactIntersection[U,V] gives those elements that appear in both U and V.\
\>", "Subsubsection",ExpressionUUID->"4ad85068-0658-4e1c-885c-884d61f679cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExactIntersection", "::", "usage"}], "=", 
   "\"\<ExactIntersection[U,V] gives those elements that appear in both U and \
V. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571288358672427*^9, 
  3.571288361870306*^9}},ExpressionUUID->"959cc405-ae31-4cd5-8ef1-\
cc93172531ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExactIntersection", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a___", ",", "x_", ",", "b___"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c___", ",", "x_", ",", "d___"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"ExactIntersection", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}]}], "]"}], ",", "x"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExactIntersection", "[", 
    RowBox[{"a_List", ",", "b_List"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Intersection", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "==", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"ExactIntersection", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"3acb1601-f9c1-41fd-a865-7f9bc9a93be8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Describing genealogies", "Subsection",ExpressionUUID->"325b82ba-5912-4991-a938-2b5d074a1747"],

Cell[CellGroupData[{

Cell["\<\
CollapseGenealogy[genealogy] reduces the genealogy to a nested list. \
CollapseGenealogy[genealogy, Node\[Rule]False] only lists the leaves.\
\>", "Subsubsection",ExpressionUUID->"ddd46a84-6e9a-4f52-91d5-534a6da32b5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CollapseGenealogy", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Node", "\[Rule]", "True"}], ",", 
     RowBox[{"NodeFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"#1", "&"}], ")"}]}], ",", 
     RowBox[{"Nested", "\[Rule]", "True"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"597aeb0e-13b7-46fc-9b32-48a7395b828c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CollapseGenealogy", "[", 
    RowBox[{"g_Node", ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"NodeFunction", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "CollapseGenealogy", "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Nested", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "CollapseGenealogy", "]"}]}], ",", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Node", "/.", 
           RowBox[{"{", "opts", "}"}]}], "/.", 
          RowBox[{"Options", "[", "CollapseGenealogy", "]"}]}], ",", 
         RowBox[{
          RowBox[{"g", "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Node", "[", 
              RowBox[{"i_", ",", "s_List", ",", 
               RowBox[{"{", "m___Node", "}"}]}], "]"}], ":>", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ff", "[", 
                RowBox[{"i", ",", "s"}], "]"}], ",", 
               RowBox[{"{", "m", "}"}]}], "}"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i_", ",", 
              RowBox[{"{", "}"}]}], "}"}], ":>", "i"}], "}"}]}], ",", "\n", 
         "\t\t", 
         RowBox[{"g", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Node", "[", 
              RowBox[{"i_", ",", "s_List", ",", 
               RowBox[{"{", "m__Node", "}"}]}], "]"}], ":>", 
             RowBox[{"{", "m", "}"}]}], ",", 
            RowBox[{
             RowBox[{"Node", "[", 
              RowBox[{"i_", ",", "s_List", ",", 
               RowBox[{"{", "}"}]}], "]"}], ":>", 
             RowBox[{"ff", "[", 
              RowBox[{"i", ",", "s"}], "]"}]}]}], "}"}]}]}], "]"}], ",", "\n", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Node", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "CollapseGenealogy", "]"}]}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{
              RowBox[{"{", "g", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"{", "g", "}"}], ",", 
             RowBox[{"Node", "[", 
              RowBox[{"i_", ",", "s_List", ",", 
               RowBox[{"{", "m___Node", "}"}]}], "]"}]}], "]"}]}], ",", "\n", 
          "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{
              RowBox[{"{", "g", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"{", "g", "}"}], ",", 
             RowBox[{"Node", "[", 
              RowBox[{"i_", ",", "s_List", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]}], "]"}], "//.", 
        RowBox[{
         RowBox[{"Node", "[", 
          RowBox[{"i_", ",", "s_List", ",", 
           RowBox[{"{", "m___Node", "}"}]}], "]"}], ":>", 
         RowBox[{"ff", "[", 
          RowBox[{"i", ",", "s"}], "]"}]}]}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"838e6173-5562-4b2c-aa29-a9bf2d1cbe4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CollapseGenealogy", "[", 
    RowBox[{
     RowBox[{"{", "g__Node", "}"}], ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"NodeFunction", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "CollapseGenealogy", "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Node", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "CollapseGenealogy", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "g", "}"}], "/.", 
        RowBox[{
         RowBox[{"Node", "[", 
          RowBox[{"i_", ",", "s_List", ",", "_List"}], "]"}], ":>", 
         RowBox[{"ff", "[", 
          RowBox[{"i", ",", "s"}], "]"}]}]}], ",", "\n", "\t       ", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"{", "g", "}"}], ",", " ", 
          RowBox[{"Node", "[", 
           RowBox[{"_", ",", "_", ",", 
            RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"Node", "[", 
          RowBox[{"i_", ",", "s_List", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], ":>", 
         RowBox[{"ff", "[", 
          RowBox[{"i", ",", "s"}], "]"}]}]}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"6bbecafc-12ce-4e3a-b812-d0752c060982"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Nodes[g] lists all the nodes of the genealogy g, including the leaves. \
\>", "Subsubsection",ExpressionUUID->"ab614f31-b7bf-4b96-9ba7-78e92300f83b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nodes", "[", "g_Node", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Extract", "[", 
       RowBox[{
        RowBox[{"{", "g", "}"}], ",", "#"}], "]"}], "\[LeftDoubleBracket]", 
      "1", "\[RightDoubleBracket]"}], "&"}], "/@", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"{", "g", "}"}], ",", 
      RowBox[{"Node", "[", 
       RowBox[{"_", ",", "_List", ",", 
        RowBox[{"{", "___Node", "}"}]}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"af63598a-37c6-4611-864a-52a454c88450"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nodes", "[", 
    RowBox[{"{", "g___Node", "}"}], "]"}], ":=", "\t", 
   RowBox[{
    RowBox[{"{", "g", "}"}], "/.", 
    RowBox[{
     RowBox[{"Node", "[", 
      RowBox[{"i_", ",", "_List", ",", "_List"}], "]"}], ":>", "i"}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d23d8de6-b53b-4107-9555-124f4f328b2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
InternalNodes[g] lists the internal nodes of the genealogy g.\
\>", "Subsubsection",ExpressionUUID->"530471e9-1938-4220-902d-ccd473d42dd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InternalNodes", "[", "g_Node", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Extract", "[", 
       RowBox[{
        RowBox[{"{", "g", "}"}], ",", "#"}], "]"}], "\[LeftDoubleBracket]", 
      "1", "\[RightDoubleBracket]"}], "&"}], "/@", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"{", "g", "}"}], ",", 
      RowBox[{"Node", "[", 
       RowBox[{"_", ",", "_List", ",", 
        RowBox[{"{", "m__Node", "}"}]}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a170ce60-4c28-4064-aa08-bd0af8210165"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InternalNodes", "[", 
    RowBox[{"{", "g___Node", "}"}], "]"}], ":=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Nodes", "[", 
      RowBox[{"{", "g", "}"}], "]"}], ",", 
     RowBox[{"Leaves", "[", 
      RowBox[{"{", "g", "}"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"1ca79b75-1d1a-4a08-876b-37be2f8c453e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Leaves[g] lists the terminal nodes of the genealogy g.", "Subsubsection",ExpressionUUID->"48d2644d-e067-4978-81bc-ca88347f0c12"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Leaves", "[", "g_Node", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Extract", "[", 
       RowBox[{
        RowBox[{"{", "g", "}"}], ",", "#"}], "]"}], "\[LeftDoubleBracket]", 
      "1", "\[RightDoubleBracket]"}], "&"}], "/@", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"{", "g", "}"}], ",", 
      RowBox[{"Node", "[", 
       RowBox[{"i_", ",", "s_List", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c8017e81-814f-43b3-831e-1276e1e771da"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Leaves", "[", 
    RowBox[{"{", "g___Node", "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"{", "g", "}"}], ",", " ", 
      RowBox[{"Node", "[", 
       RowBox[{"_", ",", "_List", ",", 
        RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "/.", 
    RowBox[{
     RowBox[{"Node", "[", 
      RowBox[{"i_", ",", "_List", ",", 
       RowBox[{"{", "_", "}"}]}], "]"}], ":>", "i"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b61e0435-70f1-480c-b88a-95097655eeeb"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ExtractInformation[g,i] gives the information associated with node i.\
\>", "Subsubsection",ExpressionUUID->"c0829424-91ad-4dba-9886-70b445579959"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractInformation", "[", 
    RowBox[{"g_Node", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ps", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"g", ",", 
         RowBox[{"Node", "[", 
          RowBox[{"i", ",", "_List", ",", "_List"}], "]"}]}], "]"}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Length", "[", "ps", "]"}], ",", "\n", "\t\t\t", "1", ",", 
       RowBox[{"Extract", "[", 
        RowBox[{"g", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{
           "ps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "2"}], "]"}]}], "]"}], ",", "\n", "\t\t\t", "0", ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"i", ",", "\"\< does not appear in \>\"", ",", "g"}], "]"}], 
        ";"}], ",", "\n", "\t\t\t", "_", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"i", ",", "\"\< appears more than once in \>\"", ",", "g"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f32e36fa-7eb6-42c3-b088-85735754fe59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractInformation", "[", "g_Node", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractInformation", "[", 
      RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Nodes", "[", "g", "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"6803b713-878b-46ae-a912-c1a25a367b56"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractInformation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"___Node", ",", 
       RowBox[{"Node", "[", 
        RowBox[{"i_", ",", "info_List", ",", "_List"}], "]"}], ",", 
       "___Node"}], "}"}], ",", "i_"}], "]"}], ":=", "info"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0413eeb2-18fc-4fc1-8cff-53a39217a928"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractInformation", "[", 
    RowBox[{"{", "g__Node", "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractInformation", "[", 
      RowBox[{
       RowBox[{"{", "g", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Nodes", "[", 
     RowBox[{"{", "g", "}"}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"12c91a2d-880f-400b-b7e8-41580ee573d4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
TransformInformation[g,f] replaces the information list info by f[node,info].\
\>", "Subsubsection",ExpressionUUID->"edf6f645-62fb-4be5-aaf2-71dc0b58724b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TransformInformation", "[", 
    RowBox[{"g_Node", ",", "f_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"g", "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Node", "[", 
        RowBox[{"i_", ",", "si_List", ",", 
         RowBox[{"{", "nn___Node", "}"}]}], "]"}], ":>", 
       RowBox[{"NodeTemp", "[", 
        RowBox[{"i", ",", 
         RowBox[{"f", "[", 
          RowBox[{"i", ",", "si"}], "]"}], ",", 
         RowBox[{"{", "nn", "}"}]}], "]"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"NodeTemp", "\[Rule]", "Node"}], "}"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b9b5c3d7-b561-40f0-a684-3d62ed663d6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TransformInformation", "[", 
    RowBox[{
     RowBox[{"{", "g__Node", "}"}], ",", "f_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "g", "}"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Node", "[", 
        RowBox[{"i_", ",", "si_List", ",", 
         RowBox[{"{", "nn___", "}"}]}], "]"}], ":>", 
       RowBox[{"NodeTemp", "[", 
        RowBox[{"i", ",", 
         RowBox[{"f", "[", 
          RowBox[{"i", ",", "si"}], "]"}], ",", 
         RowBox[{"{", "nn", "}"}]}], "]"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"NodeTemp", "\[Rule]", "Node"}], "}"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c235a8b4-deb0-4f71-9d2c-3df55b4934fd"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
DeleteGenealogy[g,i] deletes the genealogy that descends from node i.\
\>", "Subsubsection",ExpressionUUID->"50bac34e-578b-47e8-8737-509c41d009ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeleteGenealogy", "[", 
    RowBox[{"g_Node", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ps", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"g", ",", 
         RowBox[{"Node", "[", 
          RowBox[{"i", ",", "_List", ",", "_List"}], "]"}]}], "]"}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Length", "[", "ps", "]"}], ",", "\n", "\t\t\t", "1", ",", 
       RowBox[{"Delete", "[", 
        RowBox[{"g", ",", 
         RowBox[{
         "ps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}], ",", "\n", "\t\t\t", "0", ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"i", ",", "\"\< does not appear in \>\"", ",", "g"}], "]"}], 
        ";"}], ",", "\n", "\t\t\t", "_", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"i", ",", "\"\< appears more than once in \>\"", ",", "g"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d7a6007c-2c36-4a7f-9bff-f27b29d680ad"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
CondenseGenealogy[g] removes all nodes that have only one descendant.\
\>", "Subsubsection",ExpressionUUID->"07db6e8b-3117-4c94-bbdc-3d80bca71154"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CondenseGenealogy", "[", "g_Node", "]"}], ":=", 
   RowBox[{"g", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Node", "[", 
       RowBox[{"p_", ",", "pi_List", ",", 
        RowBox[{"{", 
         RowBox[{"m1___Node", ",", 
          RowBox[{"Node", "[", 
           RowBox[{"x_", ",", "y_List", ",", 
            RowBox[{"{", "z_Node", "}"}]}], "]"}], ",", "m2___Node"}], 
         "}"}]}], "]"}], ":>", 
      RowBox[{"Node", "[", 
       RowBox[{"p", ",", "pi", ",", 
        RowBox[{"{", 
         RowBox[{"m1", ",", "z", ",", "m2"}], "}"}]}], "]"}]}], "}"}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"6862bfc2-9d5c-473f-8532-3fcd5e3f4710"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ExtractGenealogy[g,i] gives the genealogy that descends from node i.\
\>", "Subsubsection",ExpressionUUID->"f2b7edcb-ef1f-421a-aa18-4cbd63ac9974"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractGenealogy", "[", 
    RowBox[{"g_Node", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ps", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"g", ",", 
         RowBox[{"Node", "[", 
          RowBox[{"i", ",", "_List", ",", "_List"}], "]"}]}], "]"}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Length", "[", "ps", "]"}], ",", "\n", "\t\t\t", "1", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
          RowBox[{"{", "}"}]}], ",", "g", ",", 
         RowBox[{"Extract", "[", 
          RowBox[{"g", ",", 
           RowBox[{
           "ps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}]}], "]"}], ",", "\n", "\t\t\t", "0", ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"i", ",", "\"\< does not appear in \>\"", ",", "g"}], "]"}], 
        ";"}], ",", "\n", "\t\t\t", "_", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"i", ",", "\"\< appears more than once in \>\"", ",", "g"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c4839606-cd32-4791-930d-7b0651e39dc1"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"AddGenealogy", "[", 
     RowBox[{
      SubscriptBox["g", "1"], ",", 
      SubscriptBox["g", "2"], ",", "i", ",", "j", ",", "info"}], "]"}], " ", 
    "adds", " ", "genealogy", " ", 
    SubscriptBox["g", "2"], " ", "to", " ", "genealogy", " ", 
    SubscriptBox["g", "1"]}], ",", " ", 
   RowBox[{
   "immediately", " ", "above", " ", "existing", " ", "node", " ", "i", " ", 
    "of", " ", 
    RowBox[{
     SubscriptBox["g", "1"], ".", "  ", "The"}], " ", "new", " ", "node", " ",
     "is", " ", "labelled", " ", "j"}], ",", " ", 
   RowBox[{"and", " ", "carries", " ", "information", " ", 
    RowBox[{
     StyleBox["info",
      FontSlant->"Italic"], "."}]}]}], TextForm]], "Subsubsection",ExpressionU\
UID->"6c7bc961-a4c7-4a5b-ae36-fb567bb428c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AddGenealogy", "[", 
    RowBox[{"g1_Node", ",", "g2_Node", ",", "nn_", ",", "nn_"}], "]"}], ":=", 
   RowBox[{"g1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Node", "[", 
       RowBox[{"nn", ",", "s1_List", ",", 
        RowBox[{"{", "n1___", "}"}]}], "]"}], ":>", 
      RowBox[{"Node", "[", 
       RowBox[{"nn", ",", "s1", ",", 
        RowBox[{"{", 
         RowBox[{"n1", ",", "g2"}], "}"}]}], "]"}]}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AddGenealogy", "[", 
    RowBox[{"g1_Node", ",", "g2_Node", ",", "nn_", ",", "nn_", ",", "info_"}],
     "]"}], ":=", 
   RowBox[{"AddGenealogy", "[", 
    RowBox[{"g1", ",", "g2", ",", "nn", ",", "nn"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"5e0c4d4c-6d79-4c0a-b4fe-4eba5b43d822"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddGenealogy", "[", 
    RowBox[{"g1_Node", ",", "g2_Node", ",", "i_", ",", "nn_", ",", "info_"}], 
    "]"}], ":=", 
   RowBox[{"g1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Node", "[", 
       RowBox[{"i", ",", "s1_List", ",", "n1_List"}], "]"}], ":>", 
      RowBox[{"Node", "[", 
       RowBox[{"nn", ",", "info", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Node", "[", 
           RowBox[{"i", ",", "s1", ",", "n1"}], "]"}], ",", "g2"}], "}"}]}], 
       "]"}]}], "}"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"270e9846-9159-4131-a46e-d923a2850b83"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddGenealogy", "[", 
    RowBox[{
     RowBox[{"{", "g1__Node", "}"}], ",", 
     RowBox[{"{", "g2__Node", "}"}], ",", "i1_", ",", "i2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g1", ",", "g2"}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Node", "[", 
         RowBox[{"i1", ",", "inf1_", ",", 
          RowBox[{"{", "a___", "}"}]}], "]"}], ":>", 
        RowBox[{"Node", "[", 
         RowBox[{"i1", ",", "inf1", ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "i2"}], "}"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Node", "[", 
         RowBox[{"i2", ",", "inf2_", ",", 
          RowBox[{"{", "a___", "}"}]}], "]"}], ":>", 
        RowBox[{"Node", "[", 
         RowBox[{"i2", ",", "inf2", ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "i1"}], "}"}]}], "]"}]}]}], "}"}]}], "//", 
    "Sort"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"68027e8d-8406-4532-a9df-85c319e9162f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
AddNode[g,i,k,info] adds a new node k immediately above existing node i of g. \
 The new node carries information info.  AddNode[g,i,j,k,info] adds a new \
node k between nodes i and j of an unrooted genealogy\
\>", "Subsubsection",ExpressionUUID->"73a061b1-1418-4f89-b8cb-976923c143d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddNode", "[", 
    RowBox[{"g_Node", ",", "i_", ",", "k_", ",", "info_"}], "]"}], " ", ":=", 
   "\n", "\t", 
   RowBox[{"g", "/.", 
    RowBox[{
     RowBox[{"Node", "[", 
      RowBox[{"i", ",", "si_", ",", 
       RowBox[{"{", "m___Node", "}"}]}], "]"}], ":>", 
     RowBox[{"Node", "[", 
      RowBox[{"k", ",", "info", ",", 
       RowBox[{"{", 
        RowBox[{"Node", "[", 
         RowBox[{"i", ",", "si", ",", 
          RowBox[{"{", "m", "}"}]}], "]"}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"47e96ca3-ba5d-4759-8c0e-2423e3f87d36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddNode", "[", 
    RowBox[{
     RowBox[{"{", "g__Node", "}"}], ",", "i_", ",", "j_", ",", "k_", ",", 
     "info_"}], "]"}], " ", ":=", "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", ",", 
      RowBox[{"Node", "[", 
       RowBox[{"k", ",", "info", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Node", "[", 
        RowBox[{"i", ",", "si_", ",", 
         RowBox[{"{", "m___Node", "}"}]}], "]"}], ":>", 
       RowBox[{"Node", "[", 
        RowBox[{"i", ",", "si", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "k"}], "}"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Node", "[", 
        RowBox[{"j", ",", "sj_", ",", 
         RowBox[{"{", "m___Node", "}"}]}], "]"}], ":>", 
       RowBox[{"Node", "[", 
        RowBox[{"j", ",", "sj", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "k"}], "}"}]}], "]"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e55efc1c-948c-45d2-b711-7b04b5958dcc"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListToGenealogy", "[", "list", "]"}], " ", "constructs", " ", 
     "a", " ", "genealogy", " ", "from", " ", "a", " ", "nested", " ", "list",
      " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"label", ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["node", "1"], ",", 
          SubscriptBox["node", "2"], ",", "\[Ellipsis]"}], "}"}]}], "}"}], 
      ".", "  ", "Information"}], " ", "on", " ", "each", " ", "node", " ", 
     "can", " ", "be", " ", "included", " ", "using", " ", "NodeFunction"}], 
    "\[Rule]", "f"}], ",", " ", 
   RowBox[{"where", " ", 
    RowBox[{"f", "[", "label", "]"}], " ", "gives", " ", "a", " ", "list", 
    " ", "of", " ", "information", " ", "for", " ", "the", " ", "node", " ", 
    "with", " ", "that", " ", 
    RowBox[{"label", ".", "  ", 
     RowBox[{"ListToGenealogy", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "d"}], "}"}]}], "}"}], ",", 
       RowBox[{"Node", "\[Rule]", "False"}]}], "]"}]}], " ", "gives", " ", 
    "a", " ", "genealogy", " ", "relating", " ", "objects", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "\[Ellipsis]"}], "}"}], ".", "  ", 
     "Internal"}], " ", "nodes", " ", "are", " ", 
    RowBox[{"unlabelled", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUI\
D->"b6dec7d2-f106-4760-a67c-ab1631a6e44c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ListToGenealogy", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Node", "\[Rule]", "True"}], ",", 
     RowBox[{"NodeFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", "}"}], "&"}], ")"}]}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ecff2556-99e8-4c9f-bb90-b31e1d4308de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ListToGenealogy", "[", 
    RowBox[{"s_List", ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"NodeFunction", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "ListToGenealogy", "]"}]}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Node", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "ListToGenealogy", "]"}]}], ",", "\n", 
          "\t\t\t", 
          RowBox[{"s", "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"List", "[", 
              RowBox[{"i_", ",", 
               RowBox[{"{", "m___", "}"}]}], "]"}], ":>", 
             RowBox[{"Node", "[", 
              RowBox[{
               RowBox[{"i", "/.", 
                RowBox[{"List", "->", "ListTemp"}]}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ff", "[", "i", "]"}], "/.", 
                 RowBox[{"List", "->", "ListTemp"}]}], ")"}], ",", 
               RowBox[{"ListTemp", "[", "m", "]"}]}], "]"}]}], "}"}]}], ",", 
          "\n", "\t\t", 
          RowBox[{"s", "//.", 
           RowBox[{
            RowBox[{"{", "m___", "}"}], ":>", 
            RowBox[{"Node", "[", 
             RowBox[{
              RowBox[{"ListTemp", "[", "]"}], ",", 
              RowBox[{"ListTemp", "[", "]"}], ",", 
              RowBox[{"ListTemp", "[", "m", "]"}]}], "]"}]}]}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"ListTemp", "->", "List"}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Node", "[", 
          RowBox[{"i_", ",", "z_List", ",", 
           RowBox[{"{", 
            RowBox[{"x___", ",", 
             RowBox[{"m_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "Node"}], "]"}], "&&", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "NodeTemp"}], "]"}]}], ")"}], "&"}], 
               ")"}]}], ",", "y___"}], "}"}]}], "]"}], ":>", 
         RowBox[{"Node", "[", 
          RowBox[{"i", ",", "z", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"NodeTemp", "[", 
              RowBox[{"m", ",", 
               RowBox[{"ff", "[", "m", "]"}], ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", "y"}], "}"}]}], "]"}]}], 
        "}"}]}], "/.", 
      RowBox[{"NodeTemp", "->", "Node"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e0e928a1-86b8-42f1-9b4f-8d807402fa5a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
OrderedNodes[g,f] gives a list of the nodes in the genealogy, in the order \
defined by f[ i,{info}]\
\>", "Subsubsection",ExpressionUUID->"e44ef2fb-b96e-496c-a36e-4d2c332e3d4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "OrderedNodes", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"Node", "\[Rule]", "False"}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e944914e-f51f-421d-a0c5-b18dd51bf677"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrderedNodes", "[", 
    RowBox[{"g_Node", ",", "f_", ",", "opts___Rule"}], "]"}], " ", ":=", "\n",
    "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tt", "=", 
        RowBox[{"CollapseGenealogy", "[", 
         RowBox[{"g", ",", 
          RowBox[{"NodeFunction", "\[Rule]", "f"}]}], "]"}]}], ",", 
       RowBox[{"nn", "=", 
        RowBox[{"CollapseGenealogy", "[", "g", "]"}]}], ",", "leaves"}], 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Node", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "OrderedNodes", "]"}]}], ",", "\n", "\t\t  ", 
       RowBox[{
        RowBox[{"leaves", "=", 
         RowBox[{"CollapseGenealogy", "[", 
          RowBox[{"g", ",", 
           RowBox[{"Node", "\[Rule]", "False"}]}], "]"}]}], ";", "\n", 
        "\t\t  ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"OrderedNodes", "[", 
           RowBox[{"g", ",", "f"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"leaves", ",", " ", "#"}], "]"}], ")"}], "&"}]}], 
         "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Extract", "[", 
              RowBox[{"nn", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"Position", "[", 
             RowBox[{"tt", ",", " ", "#"}], "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Sort", "[", 
            RowBox[{"Union", "[", 
             RowBox[{"tt", "//", "Flatten"}], "]"}], "]"}], ")"}]}], 
         ")"}]}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"bac503bc-4c98-4690-80a4-37a614fe73e5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ancestors[g,node] lists the ancestors of the node.", "Subsubsection",ExpressionUUID->"f1f7661f-f658-4d7d-a385-89c30023209c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ancestors", "[", 
    RowBox[{"g_Node", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"g", "/.", 
      RowBox[{
       RowBox[{"Node", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", "___", "}"}], ",", 
         RowBox[{"{", "Node___", "}"}]}], "]"}], ":>", 
       RowBox[{"{", "None", "}"}]}]}], "//.", 
     RowBox[{
      RowBox[{"Node", "[", 
       RowBox[{"j_", ",", 
        RowBox[{"{", "___", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"___", ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", "k___"}], "}"}], ",", "___"}], "}"}]}], "]"}],
       ":>", 
      RowBox[{"{", 
       RowBox[{"None", ",", "j", ",", "k"}], "}"}]}]}], "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"None", ",", "j___"}], "}"}], ":>", 
     RowBox[{"{", "j", "}"}]}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"00026bc7-f6be-4109-bbf0-1fbec2265720"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Descendants[g,node] lists the immediate descendants of the node.  \
Descendants[g,node,DescendantList\[Rule]All] lists all the descendants of the \
node. Descendants[g,node,DescendantList\[Rule]Leaves] lists only the \
descendant leaves of the node.\
\>", "Subsubsection",ExpressionUUID->"537b323c-ff00-496a-89e9-e78906b407cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Descendants", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"DescendantList", "\[Rule]", "Next"}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"659912cf-ddff-4567-81d4-37f5cccfabb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Descendants", "[", 
    RowBox[{"g_Node", ",", "i_", ",", "opts___Rule"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dl", "=", 
        RowBox[{
         RowBox[{"DescendantList", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "Descendants", "]"}]}]}], ",", "tt", ",", 
       "dd", ",", "ddn"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"Switch", "[", 
      RowBox[{"dl", ",", "\n", "\t\t  ", "Next", ",", "\n", "\t\t    ", 
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"ExtractGenealogy", "[", 
          RowBox[{"g", ",", "i"}], "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"Node", "[", 
          RowBox[{"j_", ",", "_List", ",", "_List"}], "]"}], ":>", "j"}]}], 
       ",", "\n", "\t\t  ", "All", ",", "\n", "\t\t    ", 
       RowBox[{
        RowBox[{"tt", "=", 
         RowBox[{"dd", "=", 
          RowBox[{"Descendants", "[", 
           RowBox[{"g", ",", "i"}], "]"}]}]}], ";", "\n", "         ", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dd", "]"}], ">", "0"}], ",", "\n", 
          "\t\t\t\t  ", 
          RowBox[{
           RowBox[{"ddn", "=", 
            RowBox[{"{", "}"}]}], ";", 
           RowBox[{"Scan", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ddn", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"ddn", ",", 
                  RowBox[{"Descendants", "[", 
                   RowBox[{"g", ",", "#"}], "]"}]}], "]"}]}], ")"}], "&"}], 
             ",", "dd"}], "]"}], ";", "\n", "\t\t\t\t  ", 
           RowBox[{"dd", "=", "ddn"}], ";", "\n", "\t\t\t\t  ", 
           RowBox[{"tt", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"tt", ",", "dd"}], "]"}]}]}]}], "]"}], ";", "tt"}], ",", 
       "\n", "\t\t  ", "Leaves", ",", "\n", "\t\t    ", 
       RowBox[{"Intersection", "[", 
        RowBox[{
         RowBox[{"Descendants", "[", 
          RowBox[{"g", ",", "i", ",", 
           RowBox[{"DescendantList", "\[Rule]", "All"}]}], "]"}], ",", 
         RowBox[{"Leaves", "[", "g", "]"}]}], "]"}], ",", "\n", "\t\t  ", "_",
        ",", "\n", "\t\t    ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "dl", ",", "\"\< is not a valid setting for DescendantList\>\""}], 
         "]"}], ";", "\n", "\t\t\t", "$Failed"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"050e6cf5-0e58-4fa1-9eec-f8333a447329"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Descendants", "[", 
    RowBox[{
     RowBox[{"{", "g__Node", "}"}], ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"{", "g", "}"}], ",", 
      RowBox[{"Node", "[", 
       RowBox[{"i", ",", "_List", ",", "_List"}], "]"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Node", "[", 
        RowBox[{"_", ",", "_List", ",", "s_List"}], "]"}], "}"}], ":>", "s"}],
      "}"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"73815c49-f27b-4f75-b4e2-4cec555cfcb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MostRecentCommonAncestor[pop,i,j] gives the most recent common ancestor of \
nodes i, j\
\>", "Subsubsection",ExpressionUUID->"bb9058d7-251c-4d75-8f0d-eef9e6d3b9d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MostRecentCommonAncestor", "[", 
    RowBox[{"g_Node", ",", "i_", ",", "j_"}], "]"}], " ", ":=", 
   RowBox[{"First", "[", 
    RowBox[{"Intersection", "[", 
     RowBox[{
      RowBox[{"Ancestors", "[", 
       RowBox[{"g", ",", "i"}], "]"}], ",", 
      RowBox[{"Ancestors", "[", 
       RowBox[{"g", ",", "j"}], "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"50b4f99d-4133-4901-a470-f67ae0ddbc61"]
}, Closed]],

Cell[CellGroupData[{

Cell["UnrootedGenealogy[g] gives an unrooted genealogy.", "Subsubsection",ExpressionUUID->"9271a841-77ec-4305-a039-768337114612"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UnrootedGenealogy", "[", "g_Node", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"aa", ",", "dd"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"aa", "=", 
          RowBox[{"Ancestors", "[", 
           RowBox[{"g", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}]}], ";", 
         RowBox[{"dd", "=", 
          RowBox[{"Descendants", "[", 
           RowBox[{"g", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}]}], ";", "\n", "\t", 
         RowBox[{"Node", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"aa", "===", 
              RowBox[{"{", "}"}]}], ",", "dd", ",", 
             RowBox[{"Append", "[", 
              RowBox[{"dd", ",", 
               RowBox[{"Last", "[", "aa", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
        ")"}], "&"}], "/@", 
      RowBox[{"Sort", "[", 
       RowBox[{"CollapseGenealogy", "[", 
        RowBox[{"g", ",", 
         RowBox[{"Nested", "\[Rule]", "False"}], ",", 
         RowBox[{"NodeFunction", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ")"}]}]}], "]"}], 
       "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"91424ed3-2fff-4941-aced-9d647b49d077"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{"RootedGenealogy", "[", 
      RowBox[{"g", ",", "i"}], "]"}], 
     RowBox[{
     "roots", " ", "an", " ", "unrooted", " ", "genealogy", " ", "at", " ", 
      "node", " ", "i"}]}
   }], TextForm]], "Subsubsection",ExpressionUUID->"e3fad6eb-abbe-492c-98c6-\
f74aac68195c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RootedGenealogy", "[", 
    RowBox[{
     RowBox[{"{", "g__Node", "}"}], ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Node", "[", 
     RowBox[{"k", ",", 
      RowBox[{"ExtractInformation", "[", 
       RowBox[{
        RowBox[{"{", "g", "}"}], ",", "k"}], "]"}], ",", 
      RowBox[{"List", "/@", 
       RowBox[{"Descendants", "[", 
        RowBox[{
         RowBox[{"{", "g", "}"}], ",", "k"}], "]"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Node", "[", 
       RowBox[{"i_", ",", "si_List", ",", 
        RowBox[{"{", "m__List", "}"}]}], "]"}], ":>", "\n", "\t\t\t\t\t\t", 
      RowBox[{"Node", "[", 
       RowBox[{"i", ",", "si", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Node", "[", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"ExtractInformation", "[", 
             RowBox[{
              RowBox[{"{", "g", "}"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"List", "/@", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Descendants", "[", 
                RowBox[{
                 RowBox[{"{", "g", "}"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", "i"}], "]"}]}]}], 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "m", "}"}]}]}], "]"}]}], "}"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a5e2bd58-1e10-49a8-ac3d-bded7c6deb8c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
SiblingList[g] lists all pairs of leaves which are directly related.\
\>", "Subsubsection",ExpressionUUID->"cc655ccf-e9d3-426d-840c-b64d44bd5eeb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SiblingList", "[", "g_Node", "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"leaves", "=", 
        RowBox[{"Leaves", "[", "g", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"nodes", "=", 
        RowBox[{"InternalNodes", "[", "g", "]"}]}], ",", "\n", "\t\t\t", "dl",
        ",", "ff", ",", "ss", ",", "i", ",", "j", ",", "n"}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "leaves", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"dl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Descendants", "[", 
          RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "nodes"}]}], ";", "\n",
       "\t ", 
      RowBox[{
       RowBox[{"ff", "[", 
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
       RowBox[{"Or", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"#", ",", " ", "x"}], "]"}], "&&", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"#", ",", " ", "y"}], "]"}]}], ")"}], "&"}], "/@", 
          "dl"}], ")"}]}]}], ";", "\n", "\t  ", 
      RowBox[{"ss", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "leaves", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              ",", 
             RowBox[{
             "leaves", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", 
             RowBox[{"Length", "[", "leaves", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
      ";", "\n", "\t  ", 
      RowBox[{"Select", "[", 
       RowBox[{"ss", ",", "ff"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b0723877-9873-4632-9597-65126800e4e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
SizeOfGenealogyPlot[g] gives the minimum and maximum coordinates, held as the \
last element of the information lists in g.\
\>", "Subsubsection",ExpressionUUID->"f0fec6a2-f7a6-4f1d-8c86-d397430a774e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SizeOfGenealogyPlot", "[", "g_Node", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ei", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Last", "/@", 
         RowBox[{"ExtractInformation", "[", "g", "]"}]}], "]"}]}], "}"}], ",",
      "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "/@", "ei"}], ",", 
       RowBox[{"Max", "/@", "ei"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"2f8f328d-5096-4d15-925e-7ffe2fc0cbe1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MakeGenealogyPlot[g] appends coordinates to the information lists; these are \
used by PlotGenealogy[].\
\>", "Subsubsection",ExpressionUUID->"f9fd7d7d-21bd-44df-b9df-403da7980a68"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeGenealogyPlot", "[", " ", 
    RowBox[{"Node", "[", 
     RowBox[{"i_", ",", "si_", ",", 
      RowBox[{"{", "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"Node", "[", 
    RowBox[{"i", ",", 
     RowBox[{"Append", "[", 
      RowBox[{"si", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"2a5360ca-6374-4a48-b0c6-d37c606e4abb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeGenealogyPlot", "[", 
    RowBox[{"Node", "[", 
     RowBox[{"i_", ",", "si_List", ",", 
      RowBox[{"{", "nn__Node", "}"}]}], "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "nn", "}"}], "]"}]}], ",", "j", ",", 
       RowBox[{"gl", "=", 
        RowBox[{"MakeGenealogyPlot", "/@", 
         RowBox[{"{", "nn", "}"}]}]}], ",", "xl", ",", "xt", ",", "al", ",", 
       "ngl"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"sl", "=", 
       RowBox[{"SizeOfGenealogyPlot", "/@", "gl"}]}], ";", "\n", "\t\t", 
      RowBox[{"xl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}], 
         "&"}], "/@", "sl"}]}], ";", "\n", "\t\t", 
      RowBox[{"al", "=", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "k"}], "]"}], "+", 
        RowBox[{"FoldList", "[", 
         RowBox[{"Plus", ",", "0", ",", "xl"}], "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"ngl", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"TransformInformation", "[", 
          RowBox[{
           RowBox[{
           "gl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ReplacePart", "[", 
              RowBox[{"#2", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#2", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}],
                   "+", 
                  RowBox[{
                  "al", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{"#2", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "2"}], 
                  "\[RightDoubleBracket]"}]}], "}"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "&"}], ")"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "k"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"Node", "[", 
       RowBox[{"i", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"si", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Last", "[", "al", "]"}], "-", "1"}], ")"}], "/", 
             "2"}], ",", 
            RowBox[{"1", "+", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "/.", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "y_"}], "}"}]}], "}"}], ":>", "y"}]}], 
                 ")"}], "&"}], "/@", "sl"}], "]"}]}]}], "}"}]}], "]"}], ",", 
        "ngl"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b140868c-5846-402b-bd9e-d44ec1e6ce36"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
PlotGenealogy[g] plots a genealogy; the coordinates are held as the last \
element of the information lists.  These may be generated by \
MakeGenealogyPlot[g].   PlotGenealogy[g,NodeFunction\[Rule]f] uses f[i,info] \
to derive the coordinates; this might represent coalescence time, for example.\
\>", "Subsubsection",ExpressionUUID->"76e0a4aa-cfbf-4a50-a393-8306a8e22373"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotGenealogy", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NodeFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#2", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "&"}], ")"}]}], ",", 
     RowBox[{"NodeLabels", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"#1", "&"}], ")"}]}], ",", 
     RowBox[{"LeafLabels", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"#1", "&"}], ")"}]}], ",", 
     RowBox[{"MakeGenealogyPlot", "\[Rule]", "True"}], ",", 
     RowBox[{"LeafOffset", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "0.2"}]}], "}"}]}], ",", 
     RowBox[{"NodeOffset", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}]}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"65b27632-5788-47fd-9098-9c67796c582c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlotGenealogy", "[", 
    RowBox[{"gg_Node", ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nf", "=", 
        RowBox[{
         RowBox[{"NodeFunction", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "PlotGenealogy", "]"}]}]}], ",", "nlab", ",",
        "llab", ",", "\n", "\t\t   ", 
       RowBox[{"lv", "=", 
        RowBox[{"Leaves", "[", "gg", "]"}]}], ",", 
       RowBox[{"nl", "=", 
        RowBox[{"Nodes", "[", "gg", "]"}]}], ",", "\n", "\t\t\t ", "dl", ",", 
       "ll", ",", "j", ",", "gl", ",", "nlF", ",", "llF", ",", "g", ",", "\n",
        "\t\t\t ", 
       RowBox[{"lo", "=", 
        RowBox[{
         RowBox[{"LeafOffset", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "PlotGenealogy", "]"}]}]}], ",", "\n", 
       "\t\t\t ", 
       RowBox[{"no", "=", 
        RowBox[{
         RowBox[{"NodeOffset", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "PlotGenealogy", "]"}]}]}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"g", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MakeGenealogyPlot", "/.", 
           RowBox[{"{", "opts", "}"}]}], "/.", 
          RowBox[{"Options", "[", "PlotGenealogy", "]"}]}], ",", 
         RowBox[{"MakeGenealogyPlot", "[", "gg", "]"}], ",", "gg"}], "]"}]}], 
      ";", "\n", "\t\t", 
      RowBox[{"nlF", "=", 
       RowBox[{
        RowBox[{"NodeLabels", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "PlotGenealogy", "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"llF", "=", 
       RowBox[{
        RowBox[{"LeafLabels", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "PlotGenealogy", "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"nl", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"nl", ",", "lv"}], "]"}]}], ";", 
      RowBox[{"dl", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Descendants", "[", 
           RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "nl"}], ")"}]}], ";", 
      "\n", "\t  ", 
      RowBox[{"ll", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "nl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               ",", "#"}], "}"}], "&"}], "/@", 
            RowBox[{
            "dl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "dl", "]"}]}], "}"}]}], "]"}], ",", "1"}],
         "]"}]}], ";", "\n", "\t  ", 
      RowBox[{"gl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nf", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"ExtractInformation", "[", 
               RowBox[{"g", ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "]"}]}], "]"}], ",", 
            RowBox[{"nf", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"ExtractInformation", "[", 
               RowBox[{"g", ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                "]"}]}], "]"}]}], "}"}], "]"}], "&"}], "/@", "ll"}]}], ";", 
      "\n", "\t  ", 
      RowBox[{"nlab", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ExtractInformation", "[", 
          RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "nl"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"nlab", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nlF", "===", "None"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"{", "}"}], ",", "\n", "\t\t\t", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Text", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"nlF", ",", 
               RowBox[{"{", 
                RowBox[{"nl", ",", "nlab"}], "}"}]}], "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"nf", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"ExtractInformation", "[", 
                    RowBox[{"g", ",", "#"}], "]"}]}], "]"}], "+", "no"}], 
                 ")"}], "&"}], "/@", "nl"}], ")"}]}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\n", "     ", 
      RowBox[{"llab", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ExtractInformation", "[", 
          RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "lv"}]}], ";", "\n", 
      "\t\t ", 
      RowBox[{"llab", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"llF", "===", "None"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"{", "}"}], ",", "\n", "\t\t\t", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Text", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"llF", ",", 
               RowBox[{"{", 
                RowBox[{"lv", ",", "llab"}], "}"}]}], "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"nf", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"ExtractInformation", "[", 
                    RowBox[{"g", ",", "#"}], "]"}]}], "]"}], "+", "lo"}], 
                 ")"}], "&"}], "/@", "lv"}], ")"}]}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\n", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"gl", ",", "nlab", ",", "llab"}], "]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"SizeOfGenealogyPlot", "[", "g", "]"}], "]"}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ")"}]}]}], 
       "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"13bb6c40-1acf-41cb-8e6e-4e342530274a"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Family structures", "Subsection",ExpressionUUID->"34250874-3d6a-4160-a3e6-2a4d8b20f3b6"],

Cell[CellGroupData[{

Cell["\<\
GenealogyToFamily[g,f] gives a list of the family structures following \
successive coalescences. The function f[i,{info}] gives the ordering of the \
coalescence for node i.\
\>", "Subsubsection",ExpressionUUID->"fe616bc7-60ee-4c03-9c0d-fd1815d57522"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenealogyToFamily", "[", 
    RowBox[{"g_Node", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"no", "=", 
        RowBox[{"OrderedNodes", "[", 
         RowBox[{"g", ",", "f"}], "]"}]}], ",", 
       RowBox[{"leaves", "=", 
        RowBox[{"CollapseGenealogy", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Node", "\[Rule]", "False"}]}], "]"}]}], ",", "ng", ",", 
       "fl"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"no", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"no", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"leaves", ",", " ", "#"}], "]"}], ")"}], "&"}]}], "]"}]}],
       ";", "\n", "\t\t", 
      RowBox[{"ng", "=", 
       RowBox[{
        RowBox[{"g", "//.", 
         RowBox[{
          RowBox[{"Node", "[", 
           RowBox[{"i_", ",", "s_List", ",", "m_List"}], "]"}], ":>", 
          RowBox[{"NodeTemp", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"NumberOfLineages", "[", 
              RowBox[{"g", ",", "i"}], "]"}], "}"}], ",", "m"}], "]"}]}]}], "/.", 
        RowBox[{"NodeTemp", "->", "Node"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"fl", "=", 
       RowBox[{"FoldList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#1", "/.", 
            RowBox[{
             RowBox[{"Node", "[", 
              RowBox[{"#2", ",", "x_", ",", "m_List"}], "]"}], ":>", 
             RowBox[{"Node", "[", 
              RowBox[{"#2", ",", "x", ",", 
               RowBox[{"{", "}"}]}], "]"}]}]}], ")"}], "&"}], ",", "ng", ",", 
         "no"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"CollapseGenealogy", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Node", "->", "False"}], ",", 
           RowBox[{"NodeFunction", "->", 
            RowBox[{"(", 
             RowBox[{"#2", "&"}], ")"}]}]}], "]"}], "]"}], "&"}], "/@", 
       "fl"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"565ec32c-4c35-496f-92ef-7d6fb4ec80c0"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"FamilyToGenealogy", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "\[Ellipsis]"}], "}"}], ",", 
      "S"}], "]"}], " ", "gives", " ", "a", " ", "randomly", " ", 
    "constructed", " ", "genealogy", " ", "which", " ", "satistfies", " ", 
    "the", " ", "sequence", " ", "of", " ", "family", " ", "structures", " ", 
    "S"}], ",", " ", 
   RowBox[{"and", " ", "which", " ", "relates", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "\[Ellipsis]"}], "}"}], ".", "  ",
      "The"}], " ", "terminal", " ", "nodes", " ", "are", " ", "labelled", 
    " ", "by", " ", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "\[Ellipsis]"}], "}"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "and", " ", "the", " ", "internal", " ", "nodes", " ", "are", " ", 
     "labelled", " ", "by", " ", "integers", " ", "giving", " ", "the", " ", 
     "order", " ", "of", " ", "the", " ", "coalescence", " ", 
     RowBox[{"events", ".", " ", "NodeLabels"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["label", "1"], ",", "\[Ellipsis]"}], "}"}], " ", 
      "allows", " ", "an", " ", "arbitrary", " ", "list", " ", "of", " ", 
      "labels", " ", "for", " ", "the", " ", "internal", " ", 
      RowBox[{"nodes", ".", "  ", "NodeInformation"}]}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["info", "1"], ",", "\[Ellipsis]"}], "}"}]}]}], ",", " ", 
   RowBox[{"LeafInformation", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["info", "a"], ",", "\[Ellipsis]"}], "}"}], " ", "allow", 
     " ", "arbitrary", " ", "lists", " ", "of", " ", "information", " ", "to",
      " ", "be", " ", "associated", " ", "with", " ", "the", " ", "nodes", 
     " ", "and", " ", 
     RowBox[{"leaves", ".", "  ", "With"}], " ", "n", " ", "items"}]}], ",", 
   " ", 
   RowBox[{"there", " ", "are", " ", "n", " ", "nodes"}], ",", " ", 
   RowBox[{
   "and", " ", "so", " ", "all", " ", "the", " ", "optional", " ", "lists", 
    " ", "must", " ", "have", " ", "length", " ", 
    RowBox[{"n", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"d1440942-5ab2-46d3-9dea-8d63d4f7151a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FamilyToGenealogy", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NodeInformation", "\[Rule]", "None"}], ",", 
     RowBox[{"LeafInformation", "\[Rule]", "None"}], ",", 
     RowBox[{"NodeLabels", "\[Rule]", "None"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e91b911f-8bcb-4a8d-83c9-00ba18158980"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FamilyToGenealogy", "[", 
    RowBox[{"ls_", ",", "sf_", ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ss", ",", "ds", ",", "ts", ",", "j", ",", "k", ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "sf", "]"}]}], ",", "nl", ",", "ni", ",", 
       "li"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ni", "=", 
       RowBox[{
        RowBox[{"NodeInformation", "/.", "\[VeryThinSpace]", 
         RowBox[{"{", "opts", "}"}]}], "/.", "\[VeryThinSpace]", 
        RowBox[{"Options", "[", "FamilyToGenealogy", "]"}]}]}], ";", 
      RowBox[{"nl", "=", 
       RowBox[{
        RowBox[{"NodeLabels", "/.", "\[VeryThinSpace]", 
         RowBox[{"{", "opts", "}"}]}], "/.", "\[VeryThinSpace]", 
        RowBox[{"Options", "[", "FamilyToGenealogy", "]"}]}]}], ";", 
      RowBox[{"li", "=", 
       RowBox[{
        RowBox[{"LeafInformation", "/.", "\[VeryThinSpace]", 
         RowBox[{"{", "opts", "}"}]}], "/.", "\[VeryThinSpace]", 
        RowBox[{"Options", "[", "FamilyToGenealogy", "]"}]}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nl", "\[Equal]", "None"}], ",", 
        RowBox[{"nl", "=", 
         RowBox[{"Range", "[", "n", "]"}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ni", "\[Equal]", "None"}], ",", 
        RowBox[{"ni", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", "}"}], "&"}], ")"}], "/@", "nl"}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"li", "\[Equal]", "None"}], ",", 
        RowBox[{"li", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", "}"}], "&"}], ")"}], "/@", "nl"}]}]}], "]"}], ";", 
      RowBox[{"ss", "=", 
       RowBox[{"Node", "[", 
        RowBox[{
         RowBox[{"nl", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"ni", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Node", "[", 
             RowBox[{"#1", ",", "#2", ",", 
              RowBox[{"{", "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"ls", ",", "li"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ds", "=", 
          RowBox[{"Reverse", "[", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"Tally", "[", 
              RowBox[{"TakeAway", "[", 
               RowBox[{
                RowBox[{
                "sf", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"ExactIntersection", "[", 
                 RowBox[{
                  RowBox[{
                  "sf", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"sf", "\[LeftDoubleBracket]", 
                   RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], 
                 "]"}]}], "]"}], "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
         RowBox[{"ts", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomSample", "[", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{
                  "ss", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"NumberOfLineages", "[", "#1", "]"}], "\[Equal]", 
                    RowBox[{"ds", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                   "&"}]}], "]"}], ",", 
                RowBox[{"ds", "\[LeftDoubleBracket]", 
                 RowBox[{"k", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Length", "[", "ds", "]"}]}], "}"}]}], "]"}], ",", 
            "1"}], "]"}]}], ";", 
         RowBox[{"ss", "=", 
          RowBox[{"Node", "[", 
           RowBox[{
            RowBox[{"nl", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"ni", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"TakeAway", "[", 
               RowBox[{
                RowBox[{
                "ss", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                ",", "ts"}], "]"}], ",", 
              RowBox[{"Node", "[", 
               RowBox[{
                RowBox[{
                "nl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "ni", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
                ",", "ts"}], "]"}]}], "]"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", "ss"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571237263355899*^9, 3.57123727778664*^9}, {
  3.571237457865922*^9, 3.571237479849092*^9}, {3.57128457107833*^9, 
  3.571284598223424*^9}, {3.571288474652068*^9, 3.5712884776819973`*^9}, {
  3.571288551334202*^9, 
  3.571288555033119*^9}},ExpressionUUID->"9648fc28-70f2-46eb-b7cb-\
51f275deef3e"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"GenealogyB", "[", 
     RowBox[{"j", ",", "i", ",", "k"}], "]"}], " ", "is", " ", "the", " ", 
    "coefficient", " ", "of", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[Lambda]", "i"]}], 
      RowBox[{"t", "/", "2"}], "N"}], "]"}], " ", "in", " ", "the", " ", 
    "expression", " ", "for", " ", 
    SubscriptBox["P", "j"]}], ",", " ", 
   RowBox[{
   "the", " ", "probability", " ", "of", " ", "j", " ", "coalescences", " ", 
    "having", " ", 
    RowBox[{"occurred", "."}]}]}], TextForm]], "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"7bcd1864-e018-4832-9b3d-10e7a29feb77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GenealogyB", "[", 
    RowBox[{"k_", ",", "k_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"GenealogyB", "[", 
     RowBox[{"k", ",", "k", ",", "k"}], "]"}], "=", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GenealogyB", "[", 
    RowBox[{"j_", ",", "i_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"GenealogyB", "[", 
     RowBox[{"j", ",", "i", ",", "k"}], "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "<", "j"}], ",", "0", ",", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "==", "j"}], ",", 
        RowBox[{"-", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"ii", "=", 
            RowBox[{"j", "+", "1"}]}], "k"], 
          RowBox[{"GenealogyB", "[", 
           RowBox[{"j", ",", "ii", ",", "k"}], "]"}]}]}], ",", 
        RowBox[{
         FractionBox[
          RowBox[{"j", 
           RowBox[{"(", 
            RowBox[{"j", "+", "1"}], ")"}]}], 
          RowBox[{
           RowBox[{"j", 
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}]}], "-", 
           RowBox[{"i", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}]}]], 
         RowBox[{"GenealogyB", "[", 
          RowBox[{
           RowBox[{"j", "+", "1"}], ",", "i", ",", "k"}], "]"}]}]}], "]"}]}], 
     "]"}]}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"f3ad80ca-4e75-4e5d-8aa1-4b2a5dc6d23e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
CoalescenceDistribution[j,k,t] is the probability of j coalescences having \
occurred among k lineages over t generations (scaled to 2N)\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"b163b7c0-af8d-4362-8269-0de402df06cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalescenceDistribution", "[", 
    RowBox[{"j_", ",", "k_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GenealogyB", "[", 
         RowBox[{"j", ",", "i", ",", "k"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "i"}], 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], 
          RowBox[{"t", "/", "2"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "]"}]}], " ", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e61f7262-95b9-4d1e-9b04-4fb2172baa16"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
SimplifyFamilies replaces duplications such as {{1,3},{2,2},{2,1}} by \
{{1,3},{2,3}}\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"9b439feb-7554-4a46-85fa-93cc6764b4ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimplifyFamilies", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x___List", ",", 
       RowBox[{"{", 
        RowBox[{"n1a_", ",", "a_"}], "}"}], ",", "y___List", ",", 
       RowBox[{"{", 
        RowBox[{"n2a_", ",", "a_"}], "}"}], ",", "z___List"}], "}"}], ":>", 
     RowBox[{"Sort", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n1a", "+", "n2a"}], ",", "a"}], "}"}], ",", "y", ",", 
        "z"}], "}"}], "]"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9840b0a3-ee03-4e93-8bdb-79c1ae8f3914"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
FamilyProbability[S] gives the probability that this family structure would \
be produced, given a certain number of coalescence events\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"b1105e0b-c1a2-47f9-98e5-fad736a3bb61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FamilyProbability", "[", 
    RowBox[{"{", "x__Integer", "}"}], "]"}], ":=", 
   RowBox[{"FamilyProbability", "[", 
    RowBox[{"Frequencies", "[", 
     RowBox[{"{", "x", "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FamilyProbability", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"_", ",", "1"}], "}"}], "}"}], "]"}], ":=", "1"}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"08a8eab4-6d2e-4301-9161-7094a7ccbd72"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FamilyProbability", "[", "s_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"FamilyProbability", "[", 
     RowBox[{"s", "/.", "SimplifyFamilies"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ss", ",", "i", ",", "\[Alpha]", ",", "l", ",", "j", ",", "tl", ",", 
        "tr", ",", "ni", ",", "mi", ",", "nm", ",", "ns", ",", "n1", ",", 
        "n2"}], "}"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"s", "/.", "SimplifyFamilies"}]}], ";", 
       RowBox[{"l", "=", 
        RowBox[{"Length", "[", "ss", "]"}]}], ";", 
       RowBox[{"j", "=", 
        RowBox[{"NumberOfFamilies", "[", "ss", "]"}]}], ";", "\n", "\t\t\t", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tl", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"ss", ",", 
              RowBox[{"i", "-", "1"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"ni", "=", 
            RowBox[{"ss", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\t", 
           RowBox[{"mi", "=", 
            RowBox[{"ss", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
           RowBox[{"nm", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mi", "-", "1"}], ",", "ni"}], "}"}]}], ";", "\n", 
           "\t\t\t\t", 
           RowBox[{"tr", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"ss", ",", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"l", "-", "i"}], ")"}]}]}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mi", ">", "1"}], ",", 
             RowBox[{"tr", "=", 
              RowBox[{"Prepend", "[", 
               RowBox[{"tr", ",", " ", "nm"}], "]"}]}]}], "]"}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ns", "=", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{"tl", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "\[Alpha]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"ni", "-", "\[Alpha]"}]}], "}"}]}], "}"}], ",", 
                   "tr"}], "]"}], "//.", "SimplifyFamilies"}]}], ";", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"n1", "=", 
                RowBox[{"ns", "/.", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"___", ",", 
                    RowBox[{"{", 
                    RowBox[{"x_", ",", "\[Alpha]"}], "}"}], ",", "___"}], 
                   "}"}], "->", "x"}]}]}], ";", "\t", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"n2", "=", 
                RowBox[{"ns", "/.", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"___", ",", 
                    RowBox[{"{", 
                    RowBox[{"x_", ",", 
                    RowBox[{"ni", "-", "\[Alpha]"}]}], "}"}], ",", "___"}], 
                   "}"}], "->", "x"}]}]}], ";", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Alpha]", "==", 
                   RowBox[{"ni", "-", "\[Alpha]"}]}], ",", 
                  FractionBox[
                   RowBox[{"n1", 
                    RowBox[{"(", 
                    RowBox[{"n1", "-", "1"}], ")"}]}], 
                   RowBox[{"j", 
                    RowBox[{"(", 
                    RowBox[{"j", "+", "1"}], ")"}]}]], ",", 
                  FractionBox[
                   RowBox[{"n1", " ", "n2"}], 
                   RowBox[{"j", 
                    RowBox[{"(", 
                    RowBox[{"j", "+", "1"}], ")"}]}]]}], "]"}], 
                RowBox[{"FamilyProbability", "[", "ns", "]"}]}]}], ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", "1", ",", 
               RowBox[{"ni", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c2eb2f3d-b23d-45b6-976e-a951fb56d162"]
}, Closed]],

Cell[CellGroupData[{

Cell["NumberOfLineages[S] gives the total number of genes involved", \
"Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"59787706-cc18-4158-a42e-b7969ce5ee89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfLineages", "[", 
    RowBox[{"{", "s__Integer", "}"}], "]"}], ":=", 
   RowBox[{"NumberOfLineages", "[", 
    RowBox[{"Frequencies", "[", 
     RowBox[{"{", "s", "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfLineages", "[", 
    RowBox[{"{", "s___Integer", "}"}], "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Times", "@@", "#"}], ")"}], "&"}], "/@", 
      RowBox[{"{", "s", "}"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfLineages", "[", "g_Node", "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"Position", "[", 
     RowBox[{"g", ",", 
      RowBox[{"Node", "[", 
       RowBox[{"_", ",", "_List", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfLineages", "[", 
    RowBox[{"g_Node", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"ExtractGenealogy", "[", 
       RowBox[{"g", ",", "i"}], "]"}], ",", 
      RowBox[{"Node", "[", 
       RowBox[{"_", ",", "_List", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfLineages", "[", 
    RowBox[{"{", "g__Node", "}"}], "]"}], ":=", 
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"{", "g", "}"}], ",", 
     RowBox[{"Node", "[", 
      RowBox[{"_", ",", "_", ",", 
       RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfLineages", "[", 
    RowBox[{
     RowBox[{"{", "g__Node", "}"}], ",", "_"}], "]"}], ":=", 
   RowBox[{"NumberOfLineages", "[", 
    RowBox[{"{", "g", "}"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"4723c243-8772-4c24-94be-67463ff52cfc"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairwiseIdentity[S] gives the mean pairwise identity", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"0610f577-d8fd-43f2-9f5f-7f5bcea5aca0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseIdentity", "[", 
    RowBox[{"{", "s__Integer", "}"}], "]"}], ":=", 
   RowBox[{"PairwiseIdentity", "[", 
    RowBox[{"Frequencies", "[", 
     RowBox[{"{", "s", "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseIdentity", "[", "s__List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"k", "=", 
        RowBox[{"NumberOfLineages", "[", "s", "]"}]}]}], "}"}], ",", "\n", 
     FractionBox[
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
         RowBox[{"s", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], "-", "1"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}], 
      RowBox[{"k", 
       RowBox[{"(", 
        RowBox[{"k", "-", "1"}], ")"}]}]]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"bc63ae35-564b-4552-a4db-890d168c1b4f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
AllSets[j,k] lists all the family structures that could yield j families and \
k genes\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"e569da9c-4ae2-4c84-9210-b1981c72abae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AllSets", "[", "1", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AllSets", "[", "k_Integer", "]"}], ":=", 
   RowBox[{
    RowBox[{"AllSets", "[", "k", "]"}], "=", "\n", "\t\t\t", 
    RowBox[{"Union", "[", 
     RowBox[{"Sort", "/@", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"NewS", "/@", 
         RowBox[{"AllSets", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}], ",", "1"}], "]"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"7588bf23-4356-4b5c-a3da-875c826516f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AllSets", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AllSets", "[", 
    RowBox[{"j_Integer", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AllSets", "[", 
     RowBox[{"j", ",", "k"}], "]"}], "=", "\n", "\t\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "==", "0"}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{"k", "==", "0"}], ")"}]}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Union", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"NewS", "[", 
               RowBox[{"#", ",", "same"}], "]"}], "&"}], "/@", 
             RowBox[{"AllSets", "[", 
              RowBox[{"j", ",", 
               RowBox[{"k", "-", "1"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"NewS", "[", 
               RowBox[{"#", ",", "diff"}], "]"}], "&"}], "/@", 
             RowBox[{"AllSets", "[", 
              RowBox[{
               RowBox[{"j", "-", "1"}], ",", 
               RowBox[{"k", "-", "1"}]}], "]"}]}]}], "]"}], ",", "1"}], 
         "]"}]}], "]"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"fb4eb1ac-7a72-4779-acbf-e84c430f5c7f"]
}, Closed]],

Cell[CellGroupData[{

Cell["NewS[S] gives a recursion for the family structures", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"4834d19f-fecf-4647-8d70-60a6c4264b37"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NewS", "[", 
    RowBox[{"s_", ",", "same"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"l", "=", 
        RowBox[{"Length", "[", "s", "]"}]}], ",", "tl", ",", "tr", ",", "ni", 
       ",", "mi"}], "}"}], ",", "\n", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tl", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"s", ",", 
            RowBox[{"i", "-", "1"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{"ni", "=", 
          RowBox[{"s", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\t", 
         RowBox[{"mi", "=", 
          RowBox[{"s", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         RowBox[{"nm", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mi", "-", "1"}], ",", "ni"}], "}"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{"tr", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"s", ",", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"l", "-", "i"}], ")"}]}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"mi", ">", "1"}], ",", 
           RowBox[{"tr", "=", 
            RowBox[{"Prepend", "[", 
             RowBox[{"tr", ",", " ", "nm"}], "]"}]}]}], "]"}], ";", "\n", 
         "\t\t", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"tl", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"ni", "+", "1"}]}], "}"}], "}"}], ",", "tr"}], "]"}], "//.",
           "SimplifyFamilies"}]}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NewS", "[", 
    RowBox[{"s_", ",", "diff"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{"s", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "//.", "SimplifyFamilies"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NewS", "[", "s_", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"NewS", "[", 
      RowBox[{"s", ",", "diff"}], "]"}], ",", 
     RowBox[{"NewS", "[", 
      RowBox[{"s", ",", "same"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"eac60a10-5435-4902-8dab-01f13847a345"]
}, Closed]],

Cell[CellGroupData[{

Cell["NumberOfFamilies[S] gives the number of families", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"5aece391-2cb9-460d-8935-8ebb2c7a91fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfFamilies", "[", 
    RowBox[{"{", "s__Integer", "}"}], "]"}], ":=", 
   RowBox[{"NumberOfFamilies", "[", 
    RowBox[{"Frequencies", "[", 
     RowBox[{"{", "s", "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfFamilies", "[", "s__List", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Plus", "@@", "s"}], ")"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"95e565d5-5024-49ea-806d-5ba5fd8db381"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Random genealogies", "Subsection",ExpressionUUID->"20e2b8e3-5c72-4ff5-aec0-be76ad4b8a7d"],

Cell[CellGroupData[{

Cell["\<\
RandomCoalescenceTimes[k] gives a list of random coalescence times\
\>", "Subsubsection",ExpressionUUID->"891e158d-9bd8-4616-90c5-8050aac5abc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomCoalescenceTimes", "[", "k0_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", "=", 
       RowBox[{"k0", "+", "1"}]}], "}"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"FoldList", "[", 
        RowBox[{"Plus", ",", "0", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"k", "-=", "1"}], ";", 
            RowBox[{"Random", "[", 
             RowBox[{"ExponentialDistribution", "[", 
              FractionBox[
               RowBox[{"k", 
                RowBox[{"(", 
                 RowBox[{"k", "-", "1"}], ")"}]}], "2"], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k0", "-", "1"}], "}"}]}], "]"}]}], "]"}], ",", "1"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5c5b0257-c9e1-4e25-a940-715f74172b41"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
RandomCoalescenceTimesG[k,\[Lambda]] gives a list of random coalescence times \
for a growing population\
\>", "Subsubsection",
 CellChangeTimes->{{3.8121608689385633`*^9, 
  3.812160894091728*^9}},ExpressionUUID->"44f2e3dd-5bb2-422d-acf4-\
819762ccfcfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomCoalescenceTimesG", "[", 
    RowBox[{"k0_", ",", 
     RowBox[{"0", "|", "0."}]}], "]"}], ":=", 
   RowBox[{"RandomCoalescenceTimes", "[", "k0", "]"}]}], ";", 
  RowBox[{
   RowBox[{"RandomCoalescenceTimesG", "[", 
    RowBox[{"k0_", ",", "\[Lambda]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"Clip", "[", 
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"RandomCoalescenceTimes", "[", "k0", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "]"}], "/", 
    "\[Lambda]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.812160515886126*^9, 3.812160568565737*^9}, {
  3.812160900881393*^9, 3.812160902649835*^9}, {3.812165371807786*^9, 
  3.812165379142367*^9}},ExpressionUUID->"d44bbab3-c7d8-4c69-9370-\
5ac9467e609e"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomCoalescenceTimesG (notes)", "Subsubsection",
 CellChangeTimes->{{3.812165191483313*^9, 
  3.8121651973214912`*^9}},ExpressionUUID->"4d146851-a224-42f4-9e38-\
590d13b5f854"],

Cell[TextData[{
 "What are the coalescence times if population size changed as an arbitrary \
function ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"n", "[", "t", "]"}], "?"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5ccad311-e232-4204-8162-b18a3002f378"],
 "  The probability density has rate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["1", "n"], 
    RowBox[{"exp", "[", 
     RowBox[{"-", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "t"], 
       FractionBox[
        RowBox[{"\[DifferentialD]", "t"}], 
        RowBox[{"n", "[", "\[Tau]", "]"}]]}]}], "]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2af5dd4f-6538-4b95-9185-07a7e55a9eae"],
 ". Therefore, if we supply ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "t"], 
     FractionBox[
      RowBox[{"\[DifferentialD]", "t"}], 
      RowBox[{"n", "[", "t", "]"}]]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "70cf4b1d-23e0-4a3a-959d-c7afab262254"],
 ", we can construct random variables with the required density.  When there \
are ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6041db7c-aa1d-41b6-a634-ee0b841c52c1"],
 " lineages, the time to the next event has density ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["1", "n"], 
    RowBox[{"exp", "[", 
     RowBox[{"-", "\[CapitalDelta]g"}], "]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7c833a78-5fea-41a1-87a7-f1d0085828b7"],
 ".  The easiest way to construct such a distribution is to use a transform, \
such that the effective amount of drift is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Tau]", "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "t"], 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{"\[Tau]", "'"}]}], 
      RowBox[{"n", "[", 
       RowBox[{"\[Tau]", "'"}], "]"}]]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e9edc8e8-9bd8-468f-a435-c684c94fe166"],
 "; we then draw random values with an exponential distribution on this \
transformed timescale.  For example, for a growing population ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"n", " ", "=", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[Lambda]"}], "\[VeryThinSpace]", "t"}]]}], ",", " ", 
    RowBox[{"\[Tau]", " ", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Lambda]", "\[VeryThinSpace]", "t"}]], "-", "1"}], ")"}], 
      "/", "\[Lambda]"}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6af36d5a-cb38-4f45-8792-8b8f71bc7f8e"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", 
    RowBox[{
     RowBox[{"log", "[", 
      RowBox[{"1", "+", 
       RowBox[{"\[Lambda]", "\[VeryThinSpace]", "t"}]}], "]"}], "/", 
     "\[Lambda]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "79ce1ad4-96ed-4537-b695-45b1fa1b1c40"],
 ".  We can simply draw RandomCoalescenceTimes[k] and make the transformation."
}], "Text",
 CellChangeTimes->{{3.81210044263697*^9, 3.812100521701642*^9}, {
  3.812100732796139*^9, 3.812100739896365*^9}, {3.812100879088645*^9, 
  3.8121010022877617`*^9}, {3.812107929440961*^9, 3.8121079895643044`*^9}, {
  3.812110807332741*^9, 3.812110939222299*^9}, {3.81211098355732*^9, 
  3.812111035460299*^9}, {3.812111079495286*^9, 
  3.812111140415029*^9}},ExpressionUUID->"89cccf6f-6925-4248-9249-\
4c84645f4d6d"],

Cell["\<\
This shows an extreme example, with \[Lambda]=50.  The early distribution of \
values is similar, but deeper coalescences are forced to be much earlier \
(right side of right plot)\
\>", "Text",
 CellChangeTimes->{{3.812161197936252*^9, 3.8121612240217323`*^9}, {
   3.8121612821317177`*^9, 3.812161325366865*^9}, 
   3.8121651640745707`*^9},ExpressionUUID->"4060637f-a03a-402e-b32a-\
985db01aedda"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"1", "+", 
           RowBox[{"10", "t"}]}], "]"}], "/", "10"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLogLogPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RandomCoalescenceTimesG", "[", 
            RowBox[{"100", ",", "0"}], "]"}], ",", 
           RowBox[{"RandomCoalescenceTimesG", "[", 
            RowBox[{"100", ",", "10"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", "Red"}], "}"}]}], "}"}]}], "]"}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.812160576018662*^9, 3.812160620532342*^9}, {
  3.812160926139779*^9, 3.8121610003752403`*^9}, {3.812161116018084*^9, 
  3.812161191014455*^9}, {3.812161228017268*^9, 3.812161276444921*^9}, {
  3.812161330254169*^9, 
  3.8121613439273567`*^9}},ExpressionUUID->"47589fff-2c28-4ffd-b549-\
314dc6d41b51"],

Cell[BoxData[
 GraphicsBox[{{}, {InsetBox[
     GraphicsBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
          Opacity[1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQ7ZX64uKBl6l2MJrFWargvqSLPYw2nj9jzmbJEDjt
ffb6prmSKXA6POX73kmSJXD6rn67c69kC5xeIOrf1iU5BU43cmxW75RcAqcj
Iheu//BxC5zm/t8Y4y63H06rBr57cbj7CJwuP2dpP+PLSTgtvkXwHiPjeTi9
7ZHzmfM2l+D0oay50pFvrsDpr2q2/Gtzr8Nppp+rBaRVb8Fps/8J24LX3YHT
Z1pMzh3Tug+n5Se8/rny3QM4/fr7/XtXDR7B6SWvdp/i63sMp/lkl79/8uQJ
nO7J3Jq2QOUZnP7msPpJRv1zOF1idGSL2OEXcPr+uiPdFxVfwenfWVdma1a9
htPajuz/0na/gdPuixTTN4q/g9PlsvFKD2Pew2kGMPgApwEs5/62
           "]]},
         Annotation[#, "Charting`Private`Tag$2845#1"]& ], 
        TagBox[
         {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], 
          Opacity[1.], LineBox[CompressedData["
1:eJwVynk41IkDx3FhJRVJpSFZV6eQDtlVH6XoR2pFbImsI5pdx+Qu0rTGImJr
VuScknLsIDMqTetskBwz39lVbpIjcrSGCN+f/ePzvJ/X83w0XH1Pe0hKSEi4
L+2/WnoMCSqGPQ4553yJ+q/SZip+3ZSjsN+Z4bhV7ij2ZCanlVDsQJkPZLrP
2cKqsfVJOsUdcVXZr663u8HBfeblbUoAhONn9E9m+qNT/zezeEokzhjuZ9B0
f0XW+lNRsRQmLC/k+uw7dxtXG+/W2JcxoeCdFmXRcxv2jB5JLcc/UGBdOZvn
cQerxLSIF2lJ6PgQs/CLDxMhImbIqHoKNJ58sV8dkgSbO23Uk1syEPv525jt
3vdAly3ZGkPJRm2tsuS1qSzssPg9+olfNu5kjZNjhiwIGb7D7bXZKNeK27OO
xoK2lG6+XtBDRE+J118bZYG/kK0nEuagIXRM7333faz6N2mfelwuxLcMlKOe
ZyO584oZd5GNoF5e6VmTx/jxLKtwYpIDnj5NqjOVjfF2O7n7KlyMdlkUxNWx
EeUs62FrxkU8uzpovZiNEjdflVImFz1bYsJLrAsh73OQcdWoFDNUdtS2hUK8
uvHunEz4UxSk/CBzN68IhgWKMptky7DYazrMEhdjJUk/b7G5HAoJAVepThwk
X3Jw1jUvR233q388fDnQFum6KPqUI+hyUIodnYNDua1u7S/LYTqzL3XVQw6e
5yZxn+pVoH3Ngv/QCAefbEd5Vk0V2HiqVsc5mIszj+82+K+uwk+ccM0iRil0
bMaGqm/WoLjoAyn16zMENxkjeaoeRu9ufMB5HpQ5il3LljXDqcucX3GtHKV9
Zm+aTYQQzppulztciSpquurZUREy5Z48VGJWQbzloMKf3q3YHfp8Y3RJNSRn
89eo6rRhrKc3TEtQg/2kS6ktuwNHdhvUSde+wpvIvU38Hd2gntgZ/tMjPtQT
R2Zzx3pgcGy+8l5sLUZmurv+NujDkGVPg6VNHbI/vngtf+s9TJ9T/+pSrYe8
2qPx/v5+WBptuHiktR5xl7gXs7QHcMzsUVBH2GtMm+b3e0UMYjAyjha+tQEB
hjWcDdVDWO65om1TeQO62TU3BRofMRWgxG9zfIOvVFHq9isjmJD3f80fe4Od
h5cvXnwxCr8/cqa0LzfC4r6GZ7HyGDJ7ddw65xoRrHZBs/f8OA54SuonBjZB
d/TMylbrCQzWJczFDTdBSWFCtmZuArLdNK9B12ZIl6cWaqVNQnpCScGkpRk/
733xboXVZ0zuKRu6oNGC/P+5Zv01/RmDm1VDOQ4tEI+orBlI+hfDqlqnmqJb
wLW1kGIencL1cM0ZP14LIo4zMjkDUyjYpX/JaKQFGp2Wbx8wxLCSKjZvVhbg
O6NIJsVwGjbyzyY7zAU4v7l5dhkxjcXf6jYyaQKIX8f3+dFnYLimdv5xhgDJ
0s4Bp7W/QN3TeHderQBKXdz7kjVfIFdNfdo/JsA34XQ7Y9osbrV8k+e1UQiJ
XOfCvrVzuP6If+e7Q0JcvlcYv7ZqDobiIkPTi0K83Bktq+jzFVIfl9unxwmh
aHlZ94b8PNJTK+XSCoXo2NVChPLmES9qvVEmEqIoA9r9zgvoGwvjP5gWwqlw
v6La4gLoLnI0I2UC1xksekfeIhIMPVtbjQn8OaSWKn+CxIHYr0L6WQLR6QyX
rpMkKoJtRavPEXA//UmHbUPi2yJufcqSN/F4RdYOJG7qshKLHQnEJjjy41xJ
pLlbJ/Q4EfDanzIpF0oilVVpY+JKQDNy3fHlOSRknu2d/UglsHggbHXrYxIT
KpURgT8TePfpvTAnn0SLTvIcueREhxIn8+Klv5pe4zpvAuSO0/4MHokVbw0G
DvoS6BAkZEgRJD4rWQ7H+xN4FjXjRvxNwuSEN1c5gADz+wvbH7wl0Z88F8ha
stVDPc6RLhIbjB1FnEACZSGN9fRhEoqLVJn2YAJJu/Yl2IySqDu2Psg9hACt
L81OY5wEZ5tx26clbzvxS3fFFAm7K+IIiSsEpJeJshNnSAzU/F4Zs+Qe7vdU
lzkSXq6FM2uvEuBRH+gbLJC4jR8005Z8V32lmCRJZB0POqwTRuD/Raoxxw==

           "]]},
         Annotation[#, "Charting`Private`Tag$2845#2"]& ]}, {}, {}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, 
         Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
         Charting`ScaledFrameTicks[{Identity, Identity}]}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->All,
      Method->{
       "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
        AbsolutePointSize[6], "ScalingFunctions" -> None, 
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}},
      PlotRange->{{0, 2}, {0, 1}},
      PlotRangeClipping->True,
      PlotRangePadding->{{0, 0}, {0, 0}},
      Ticks->{Automatic, Automatic}], {192., -116.80842387373012}, 
     ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}], InsetBox[
     GraphicsBox[{{{}, {{}, 
         {RGBColor[0, 0, 1], PointSize[0.011000000000000001`], 
          AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw1VAs0lAkbxowZ45v55vu+GWNFrEuLDH6WJinzTos/l1S2VnRZe5nDakpF
dLHrsvyyf4R0WVsiiVKqtZSk76V/qBw2Ku1W243VTaUzNpeG2fYc/3vOe97z
nPec9/K8F/svEyPVJkZGRl+913/s/+X7i6rCx0Ez8bXfxNRCj0GlJD8nYDTS
BgnOqe3P97xRch1irH4Pt5n2v1WeqbludCDEGj/OfzmqwnHloVpHQdU8azT5
cPYEUatXvmRURpUtVhgV41232cGgFFW3BnK1lphU66/8+YgR5B53I6s+spyO
bwzbru8KjLgrQ9mKhuaz60yANktpD9shw3BF+rl+Dw44TWXcN4TI8NuyGxdl
jziQe79b9zpYhst2eblxc7iwXG4lzxTIsLr5tuyajSlUnSzKfMyXod2ixX6y
E6ZgcJAE8votpuvngeL56WXaSgvcnj7Ruu4ED8IsbUzKPC3wP0Xr5u2w48PZ
a6YtIXYWKK/n8uYU8EHjFfNXQ68Ui/qTdiwc5cPuqc/tAjqleLYuscRjlRmI
dJ8MHqiX4hXtgtTkC2bQyEYddFRJcbi+Z/JbCwH4tN1ymPSU4ri8OK1aI4DU
r+Ujnh9Kp/kTwGhZneA+T4pdM4afl1DmAENpAf/TSbAwm3P+wRpzaAuvPPRb
vwQdQ/f1xdSYQ8Hw+oSrv0jQbqqrc+6wOaz3qHO2rZDgT33E+DFfApwrOhaz
2RKMcSta1L2VgGfx0hlDSRJcd+X8pRtNBOx9lfHHE7kEe87fGvltjADyX6s+
Ur1h8K2oKVPvKwTVYVfbo+cZ1OrEn8ZsEsJd+1a/rUnM9HyFEFfwRNnjz2BL
x7xXLv1CKPhAsalcwWCN6rK23UoE/MC07pWmDPaJdsaPR4ggZ7bTkPYNjaLN
3v43skTwYMTqtvIVjREnC4LUDSJwnkWaZD+k0X2Bx3J2UARhK0+PtmlppIek
smEZCWy6ZkvKPho/Wa6fYxpMgm9Yc4KLGY1Hr1amEMkkrMp4vDe3nELNwsIW
soKEO04/HCxNp7BxuNBzRhcJXdEJtsoNFG5pXjp/7hgJ1wUG//nzqOn9FAOf
mNvtYEXhaeuT53rDxFBBfGZMiCg0GC0zxCaLgffpOVItoDDkeN2JWQfF8GvN
rgQ1h8La+Q7xLpfF0OB1hQh5KUahpC114zMxtIu/vsddIEbd1IXoLD4Fvg1J
4z5lJC7VzO78y4oCdd1N0/ZEEqNLT1VYyCnISujJ2+NI4uLgdu3AAgrcQ/3P
3KVJ3ObaMa5eQgE1J38nECT+11t976dYCmjT/bqqXSIUaZgXOze9x4W3H4aG
ifDFPedszywK6uzST2VOCtH6g/6nRcUUONUMeYxvFk7fHwU5nP09B82EuMW1
ZE/xzxTUXzlOZQ0ReMwx9I5PGwVLtzkf3n2fQHfa5U1pDwVjnfGhFt0E+nU3
l7c/pCC3oOSSHRDYPKPkUNNrCv594sEZezGB9qq4vC1TFGSHb+yMLjfHq31O
I++ENGSltLdG3hKgMmpkdYQ1DQs/W0vnLebjoKfDxxtcaVC4eq+Kq+fhzFp9
32oFDWk5G7uj83i4mn+k1DqIBvPAEn0vl4fMU2yrjaQhtsshecDdFOd7h+eS
sTQs+t7vqq6Pi64RjtKg9TTMXeT+6748LiadPZ23dDsNoy8bHScyOBiYsXXS
K/d9/uCA/T4KzvT/oUH/YF9hqQ8H1YeOmewop+GFzYFGg94Eswa+zB84SYOE
6dp9RG+MN9VvBS5NNLjnVeW8khujeeXY2mAtDYkDGTclF4wwuOVZAvTQsKfj
bqRmg4HtVRZzLf+gIbP2nkdLkIGN3bTm3bWn7/srPqzwJwzs2x/qLNeM0BBt
yIxbop5iKbmXdbeBBu/cMtsAFz17afWsVluCAafoAyGzmkbY5PjqS0tkDCSm
VPOjLuvYjX26ti/sGZgoSvUNkz5hf2SrU1fIGdBsXflN7/FBtv/iZIabgoGx
qFrPdx1/smNH+d8NqBjY8E3++C8zH7NjYX+aZYYz0LRX2uNn95BNSB5rNI5i
YIVoW/+jxial20yZVdwXDKjuaNIy1z5S/g1g6Lzn
           "]]}, {}}, {}, {}, {}, {}}, {{}, {{}, 
         {RGBColor[1, 0, 0], PointSize[0.011000000000000001`], 
          AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw1VH001XcYx73c93t/39/lcq9u8lIjF6NG3nYfSkOozE7RVdKU0itKI5Kt
LU0WaVsWsQwhJYUSHkytN/PS7tqmJVdlbKORLvOy7Rx7znnO88fnnOd8zufz
eR7zyD3BUXo6Ojpb/u3/5v/1Z6NoojbQHIddJ2e87Z8rY0/YJT5LN0Me42Li
4KmXSr/Yw3Lrgflz+LhydZ6Q63NWjktO/PHaCyeUr5JsS2MS5ai3YPEkr3xK
KY8PHvcMnYfrwpwqYy1mlQqX3JvmfjKMK3dXXvlaB9bZeGsds6Vz+3XBTPZN
FtkkRcl71+qrYvRgT6ZHiGy9FANcDtdq7BnQ7hsXecZfisn53TclTxnwftnp
ySa1Ca7NcLRlHmVCJXvaPhZNsKT+R8ndefrwxe1Vql+sTNDMN9BVUqYPDz12
18Gw8Rx/A2DLslzuZxlj4uHJ5pgyAxjc27u5wtQYP86KcUsyY0F3X1jAoxIJ
KqqZBs6ZLChdzh0tzZRgliYuyfs1C7YKAhd2bZFgVeWeHPsNbOjRJJ/MD5Dg
d22eCfE32FB/ZUdkulCCI9Wd08lGHLgan5rY97MRTiiyD5Xs5ADHSxE5RIzm
9OOAz5usFe/eN8QHspHBHIoLCyw8CwvBEE9+xKh7Es6FiCtDRlZLDNHS/3N1
WCkXMmpjV01JDNFs5sG9ZSNc+KbA+XLOCzF+peZNFL/FA/Mv8wQF3WIMs83y
bT/Ig7TmbTNMFGPMd3WN3dd50LrpU9/oFDF21v0w9kjLA1V2vuz4LjGOC64f
mXqLD3TdofaEcDG2jYreDdvHB4tXDa6X1ojn/OVDtKbTxM9PjA233f601vCh
Q+RYccJbjKVerW23pALoPZIdlC4Ro1pwLHoiSAD7h0ddS67RKIh1cu9OE8Dz
xw+yDmTQGFSR6RN1TQBW65vlR/fSaOdpH9L0XAD6BSFWu+bRSH43lIxIhBC8
yKVb9RfB5SFTzvorhXD3ycGOwUGCRXfOH+DFC6Esoqss5ynBnd4nG4SFQjh3
VT+3p4NgzchJB9kDISSs1S3quUdwf/0aj2VaIRQUrAj/vInM5VME+W/MXnb5
kuAl04rarlUiaJEvHzyVQnBWZ+1sRLwIihJ/vREqIOh3obJs4VkRZJ479ZP/
DQrLPSyirVtFMFw8mrf9bQr54paEvb+JoLl1yuqsO4WjMzdC01gUGPpe2O0l
pnDNzsX3XkkpKOyUxjGEFIbmXiw0UlCw1cGuWVstwsCVt9r6PSlYWN4W9bZM
hB/Y3J6IWk1BlPv9c9JhIX7qFNXzVQQFVxmHqpadFqBgJz10bB8FHr97Ot8P
EeBQzxsfOaRRYPC9gZmbmwBNTTQDWdkUeA5+sIz7mj93fxSEFh/skH/Lx/02
Oaeyr1AQuPzM0g9r+Fhs6f/z0hYKvuXfXe+QxEc7Yv0yt5OCfSbBMvFiHrq2
1xfc6qXggPXSc7/yeFgvy8m7PkzBpsd2Ws0zDpp7bUvfP0NBSMIxdcdDDt5R
W439zSfQJwmd16LgoHLdmCrIlADpP3K1xpKDzx0sluy2IfDx4caNL4fZKC+f
UqtcCGz8fveFXBUbVayvc019CFheHm5jbGAjPYAt5cEEtHd2bNjkxkYPp4BP
hBEEtiZbpDwaYaFNkKWhzy4CjvlVQ61bWBhXdSl9TSKBxTTExSlYuCL14LTj
JwTaRaPPFhmx5v4PAZuWs++cX2KAUXnFekkFBDK3U58t6GViWn/kif4KAv4B
0/apPzHxYdQ4x/o6gaVVp/2eIBO557UbV7YRMHrRnSLMYeLKht92QCeBhqqx
5hoeE7uU2UzjxwSct2UwRqoZGLEv/O+7AwR6bx1ofTqlh+PHK43Dxwikzu8L
3fVEDymFo2n7LIHA28nlL2r1sFG1sHk+jwZuidaW7aSH8dEljaslNNiY1GnE
9bq4Vz3astmchnugVV1K08UzTSUJ7yloUFflVWcm6qLm5nSqrQsNhseFzV1m
OqgtYqX0e9GwfeRii87rmSbtqmfsIwE0uFOjOcWNk0074rU1uutoEGUUhGsH
Jpps5RLpts00LDrapywSjTX9AykxwPE=
           "]]}, {}}, {}, {}, {}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{-0.16902621844570595`, -7.888805962153317},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{
         Charting`ScaledTicks[{Log, Exp}], 
         Charting`ScaledFrameTicks[{Log, Exp}]}, {
         Charting`ScaledTicks[{Log, Exp}], 
         Charting`ScaledFrameTicks[{Log, Exp}]}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->All,
      Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Exp[#]& )[
             Part[#, 1]], 
            (Exp[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Exp[#]& )[
             Part[#, 1]], 
            (Exp[#]& )[
             Part[#, 2]]}& )}},
      PlotRange->{{-0.09573166354447063, 
       4.59511985013459}, {-7.754971163498049, 0.5427863531284133}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.02], 
         Scaled[0.05]}},
      Ticks->FrontEndValueCache[{
         Charting`ScaledTicks[{Log, Exp}], 
         Charting`ScaledTicks[{Log, Exp}]}, {{{0., 
           FormBox["1", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {1.6094379124341003`, 
           FormBox["5", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {2.302585092994046, 
           FormBox["10", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {3.912023005428146, 
           FormBox["50", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {4.605170185988092, 
           FormBox["100", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.6931471805599453, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.5108256237659907, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.35667494393873245`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.2231435513142097, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.10536051565782628`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {0.6931471805599453, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.0986122886681098`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.3862943611198906`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.791759469228055, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.9459101490553132`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.0794415416798357`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.1972245773362196`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.995732273553991, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {3.4011973816621555`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {3.6888794541139363`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {4.0943445622221, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {4.248495242049359, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {4.382026634673881, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {4.499809670330265, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {5.298317366548036, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {5.703782474656201, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {5.991464547107982, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {6.214608098422191, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}}, {{-6.907755278982137, 
           FormBox["0.001`", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-4.605170185988091, 
           FormBox[
            TagBox[
             InterpretationBox["\"0.010\"", 0.01, AutoDelete -> True], 
             NumberForm[#, {
               DirectedInfinity[1], 3}]& ], TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.3025850929940455`, 
           FormBox[
            TagBox[
             InterpretationBox["\"0.100\"", 0.1, AutoDelete -> True], 
             NumberForm[#, {
               DirectedInfinity[1], 3}]& ], TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {0., 
           FormBox["1", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-9.210340371976182, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-8.517193191416238, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-8.111728083308073, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.824046010856292, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.600902459542082, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.418580902748128, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.264430222920869, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.1308988302963465`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.013115794639964, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-6.214608098422191, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-5.809142990314028, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-5.521460917862246, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-5.298317366548036, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-5.115995809754082, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-4.961845129926823, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-4.8283137373023015`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-4.710530701645918, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-3.912023005428146, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-3.506557897319982, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-3.2188758248682006`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.995732273553991, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.8134107167600364`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.659260036932778, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.5257286443082556`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.4079456086518722`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-1.6094379124341003`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-1.2039728043259361`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.916290731874155, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.6931471805599453, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.5108256237659907, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.35667494393873245`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.2231435513142097, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.10536051565782628`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {0.6931471805599453, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.0986122886681098`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.3862943611198906`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.6094379124341003`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.791759469228055, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.9459101490553132`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.0794415416798357`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.1972245773362196`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.302585092994046, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.70805020110221, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.995732273553991, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {3.2188758248682006`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}}}]], {576., -116.80842387373012}, 
     ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}]}, {}},
  ContentSelectable->True,
  ImageSize->{
    UpTo[600], 
    UpTo[360]},
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{{3.812161161739871*^9, 3.812161191945696*^9}, {
   3.812161231622909*^9, 3.812161277302897*^9}, {3.812161335223702*^9, 
   3.812161344808556*^9}, 
   3.844841045184972*^9},ExpressionUUID->"cc73de43-905f-40da-96ec-\
a81edba4296a"]
}, Open  ]],

Cell[TextData[{
 "With a shrinking population, deeper coalescences may never occur: the \
ancestral population grows faster than lineages coalesce. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "crit"], "=", 
    RowBox[{
     RowBox[{"-", "1"}], "/", "\[Lambda]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "52657e18-a76b-4506-bd9a-ae02c8d7446b"],
 ", here giving an upper bound of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", "0.1"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e206c6f5-d986-40e1-bcf8-1ff3bfc04b8d"],
 ". "
}], "Text",
 CellChangeTimes->{{3.812161448893005*^9, 3.812161509140093*^9}, {
  3.812161546308131*^9, 3.8121615592918653`*^9}, {3.812161590597424*^9, 
  3.812161605717519*^9}},ExpressionUUID->"44804617-1159-4322-8967-\
a807850f3ebe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", 
            RowBox[{"10", "t"}]}], "]"}]}], "/", "10"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLogLogPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RandomCoalescenceTimesG", "[", 
            RowBox[{"100", ",", "0"}], "]"}], ",", 
           RowBox[{"RandomCoalescenceTimesG", "[", 
            RowBox[{"100", ",", 
             RowBox[{"-", "10"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", "Red"}], "}"}]}], "}"}]}], "]"}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.812160576018662*^9, 3.812160620532342*^9}, {
  3.812160926139779*^9, 3.8121610003752403`*^9}, {3.812161116018084*^9, 
  3.812161191014455*^9}, {3.812161228017268*^9, 3.812161276444921*^9}, {
  3.812161330254169*^9, 3.8121613439273567`*^9}, {3.812161401519587*^9, 
  3.81216141829358*^9}},ExpressionUUID->"eec6c4e2-a798-4b39-9bc6-\
6d2b8d2e94d5"],

Cell[BoxData[
 GraphicsBox[{{}, {InsetBox[
     GraphicsBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
          Opacity[1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGBQBGIQ7ZX64uKBl6l2MJrFWargvqSLPYw2nj9jzmbJEDjt
ffb6prmSKXA6POX73kmSJXD6rn67c69kC5xeIOrf1iU5BU43cmxW75RcAqcj
Iheu//BxC5yeNRMEdsJp7v+NMe5y++G0auC7F4e7j8Dp8nOW9jO+nITT4lsE
7zEynofT2x45nzlvcwlOH8qaKx355gqc/qpmy7829zqcZvq5WkBa9RacNvuf
sC143R04fabF5NwxrftwWn7C658r3z2A06+/37931eARnF7yavcpvr7HcJpP
dvn7J0+ewOmezK1pC1SewelvDqufZNQ/h9MlRke2iB1+AafvrzvSfVHxFZz+
nXVltmbVazit7cj+L233GzjtvkgxfaP4OzhdLhuv9DDmPZxmAIMPcBoAvFoH
5A==
           "]]},
         Annotation[#, "Charting`Private`Tag$3780#1"]& ], 
        TagBox[
         {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], 
          Opacity[1.], LineBox[CompressedData["
1:eJwVxX80EwgAB/BdhZ1cLqVnbjXlR2Gpe6o5D19ZV1JPp6Sk56kmpXt+dHQr
5JXMyGRujMyVbBfKZpv9ojI7+jXyO4XojpYfyYqdepe76/74vM/qo/F7oxcQ
CITAz/4/KHqsUzse7afQTZGbPr+Ibp8wTNqGtt22XLXrNnheKxbISaE46F7e
y/ouFLva+mRlJAbIyvwL+nAGDjDm7haQkjD42mbpSkESXmzIonNIl9A7tnh2
dG0meNfstM4RmaA1JpTVcVgIsq72uSdgQdHhpfpoyoLybevmaUo2ooSWARZP
cpBXY7MuxCUPGRwLMT84H9dt97BySDxs6B4RekQVIaWN3xxWz0PVRNytRa58
hGW+XOAYUQiS7YMbMTN8WJkS0xsERVDZUP2mckvA7OEx31BKcO5ff1ZNtwAh
v/THBrv8ioe6fdkOA+W4QJSvzSYJERnc3gJWFdx2cNmyBCHSQt1L2Cuq0ZUZ
Pz7wQIjbHL+8Hyur4bSQesvjjAifKEs2uXfewv15oUdP128gqs6HldLEsJop
2kzJrcKjD14uzlIpFN8mFwWOVOG4WUG3gihDZMK+uUTvahCmLWzPHJFBMmWt
aR6rxibt2KKbK+TYO8b2if3+NgJrnKz1+XUofnGOrvhHDKp3anphmwpbyeHC
of0SUOIyJCYfNSYO0cyINRLUlrR0BIjVWPXm7LGa9bVwpE1vmSjSIP7kFmfC
YC1mky6+5V5sQDNb1MuzkOKOpKOCufAO7CqXs1w9pahliOJNrDvQGt4b9uZI
Qex3O00pugsbhqRS5CXD4/QOs+vPGnE8Y1W4N0OGe1HnmK1eWjTc4HzZfkWG
nxmNE+QsLRh/nIr9YJAhIl1M5bs2QU0YsOfYyOHYtt5jNq0JVg5B+tV+csQU
27673NMEReQ66q5COWaqlu6YYOtgeZ4/OKyVI5etGPvLoENkmTkn6Y0ciRqx
lX7H7zAfHJ0qo9fhY9mnnSk2zTgYXi4xvqvD6+SdFf2dLZgeCLW8Ya8A01DD
raPfByuSGL2PrsCVS5P1NzX3IT8Wb6/kKbAy5EgEWf4AQYY1yTF3Fcj1pZ08
QHuIlyeettsZFOBFdTmsaXqIJXG+mSk0JQLWbR459foRREbjMDVKiY0C7/lv
Mh/D5yeh9xBbiaP1VeEtbnp0mw4UXpEqcbXBN2nrcz1imYuN/v1KqK1kF/K4
rfji73tB7xeokFDh5vkstA3FaadFFe4qmJTpWzOcnqDl4vND5mkqkDfynlsb
23HYjKNQiVRw3N837s/swPss/69PPlGBVl95NXJhJ7ItZ2Pt51QIYZI8Y0o7
4cC52aKnqHG45PZ2Ar0LKusIh7RANXzTj4lV810ILliS4pGoBlEszUvp6Mar
5bre4RI1Vqt/4JzS9SCVn7yRq1MjOnXxQNRQL5bZu14OmFRj1GXEd8WWPlQL
Bl/NLNMgtGD+BG/8Gfwp+f4iHw1krVzyWZ8B9JXTS8OiNWjc82eucXIIcU5z
Jos8Daip5j3bd47Czky4e1OxBra9xqedX03iP9zGMc0=
           "]]},
         Annotation[#, "Charting`Private`Tag$3780#2"]& ]}, {}, {}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, 
         Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
         Charting`ScaledFrameTicks[{Identity, Identity}]}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->All,
      Method->{
       "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
        AbsolutePointSize[6], "ScalingFunctions" -> None, 
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}},
      PlotRange->{{0, 2}, {0, 1}},
      PlotRangeClipping->True,
      PlotRangePadding->{{0, 0}, {0, 0}},
      Ticks->{Automatic, Automatic}], {192., -116.80842387373012}, 
     ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}], InsetBox[
     GraphicsBox[{{{}, {{}, 
         {RGBColor[0, 0, 1], PointSize[0.011000000000000001`], 
          AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw1VAsw1AkYX2vZXfv6/xd/eaU8OqyIzrtuP2qbkOjFtaezaZYNiWzqOJf0
Pq7LY5qurgs5lEeTppDYj6K445JLXVepFik93K1bu1Kum3HfzG+++c1v5pvv
PT9u+1o5nUajbfmI//z/xvd0bkvVLMC3/lMfgt1HxHX9AU5ZxxyQY1ib+bLo
L3FxiQneSpg/q2vFF6Utu/NezsPF372eDEK9uGJKoZXk2yJ9nusUp3paXKYR
WMm4thgt9arbYT8j7uXbHi2X2WB6daC4vowGDYVvDL9fYjMb3wD0X2zNOBpi
jdSGy80Xk+iwb9XWBUWkJa7y3dOgdjeECxbRww9S52D2T/3XqKeGwBYQx4E7
B9fke4oYBxgQGVkztj/KAiub71HdNkZQYKlJYP9Bod3KcH/qvBHIuhpuDJdQ
s/kbQ9iI7Lr9aQoz90y1JZ03BtdTmd7luyg8WJAUkGXHhK+Ltm3JCaDQ7RLD
2OcoE9p60refZVNYoE7PCp5kArHoBH1AbY4X67YXu3/BAp/2xp2xH/mtjqW7
lFdZMJ3M2xydZo7jl/reZ5uzIT5l7uOZjeaodyv8ujKZDRv08eGjOrPZ/rHB
/TrvHsvPDHusxl8WEyZgvzZ8qM3YDI/tN2wc3GQCzylZY9MJU3QIPT4grTIB
6b078edTTNHuQ88vfuMmUDultM9XmOKpAY6+wpsD/geOWNyINkWpqGBl724O
RN6ftDX2N8WkW42t/U0csNSVR+VYmWJf492J+zoOxGSbiO5rhajlNe2d9uaC
m4fMR6IWYodGsE6axoUJ/wLxj6XC2fly4arE4fai5UJsuRnwxlnNhZQMkSKO
FGJV0PWOTkseBJdWJZaNkTjAO6zQr+bBO81xy9ODJPJ2eAX25/LAO/aCnXsR
iatrjkrkl3lwLj98NGwfiQuXuq9XjfAgbTrx16RcEslXZtQ4xQf74fLOhs9I
XLZ+2sdoBR8qz/m9yXQisbzrbAZHyYd5XupvssxJTA4+1sIv5UNgVO/nYSwS
r4wf87Dq4cPUqzGHK88J3NkcucRPx4eUuMW37OqJ2f0UwOuUJ2fkPxF4wbqm
4U6YAIoTQlgHtxI4Q1szI1MKgFW+Q28eSGDIubrzTj8KwOeQRzB6E1i9xF7h
fF0ABlEtWxe4EMg1bd+V+kIAK5e/uvurgEDNh6sbc5kE/HxmXdUjIwIjk11/
+ceSAJtSka6iWIAbT9aWmrsRcCXUp/I1W4DhKzo7hpYS8GQ7p9WDLsCvXG7q
5REEdJdmlLxt5WOel/zhKRkBa86MynoZfOQlC8cOpxHw7JEmzvE9D8cefrLf
I5cA9HSKUZ7jofUc9WhBIQGJ+6gEaR5v9v4IqO3WX5N8y8OdLsVFhfUEvFFM
rtn0GxcrHEIffNpOQHtiZ5lxJhcXks5/newjIHuZltbuykX/3uaSzicE3Fwb
qCtq4GCzVfHpprcEPBfIK27GcnB+UMKRnR8IuLMj35vuy8GuAceJd1wSNB2t
JqFz2SiOnohZbU2C9PHmkdeTTBzxsF+c4kJCWWyvKGGIibbV0wMxviTE11pN
KTOZGMMsO2ktIWHZn+lfvQhmonAU26vXkuC9pTA9NcUYl3itOsSXkVB/ewOj
zcYIXVY7mEm2feSLWP1hMwxMv3jhSGQmCfnxokzFMwYuz9n93vMQCSfWBVAx
XYzZ/0OC/SItuJUzUH66gp5VQgLLVWktP8zA3KG474ZqSNAuGDQdPGWIv8u1
bOcmEkL2lg1bRhiiyVndlys6SKB37S+rX2iIK1peJEIfCQ8dHRz7pHS8Iy5k
WDwiYZvkHe3MZQOUpW161z36sZ40hn4wwgC139ZZbJogoXpjtizvNg0JN0/r
3hkScsYPhf5dQsPWGKe2uRwhpPS8Cmk4SEOlorI1ghLCuoPLwjqbplWpA5r2
zfOF0BzkJ1Hs1qp+UFXu2uAmBMff2t62joyr1Nfe54h8hRCVEXFZfHZcpStn
fjMUJITpbovY4T1DKl3YMGvvKiEELi7xPcDoVyUqdVcMooUgflql7nh6QyWy
pSwTNguhJq9YIwp5Lv4XSh/CpQ==
           "]]}, {}}, {}, {}, {}, {}}, {{}, {{}, 
         {RGBColor[1, 0, 0], PointSize[0.011000000000000001`], 
          AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw1Uw0wlAkYtnZZ+/99fr5dy10sTW2FS1JI+yJNPxtb6UScuqy646L8VIQo
J12ZSGlId1SbEK2mLIoXSSV1rktd11Xay3T9SCXstrhuZu+deeedZ56ZZ555
n/d1/DZ+ldLUxMRE8bn/m/+X+o8DW3we2+FbL/2Ev+uAbPx0tyqsUYwc+rnU
l4ffyeTs82VqtdjIj8h2Pu9uWw5inHPwzagf6mS2/A2//ym3RVOHGXpOtUHm
X7uLI3kpwtBw99ptkknZ0pHQE3l0ESZW+8jqK0zAEOnhcnGf0KhPg3SLlHHW
aiFSay42q2NNYeMazzSBVIjyeZkNWlc6eOR41IkthZh+4u5lqp8O7gkzc5sm
KVx5YPZMRg4DMqRRw14jFJ5pvk/dtDcDs+t1Kx0/4ylLVnhRVWaQ+0rzXv2G
Mvo3h5aTOs+mfgpTM/VtsVXmEC09pWc0U/hjQax32hQm3BIG0DLPUzjrAsPc
M58JD95+ovuUUligTUzzH2VCS1BKf0wxhera+CLXdRbg1DM2YL+awuudvtuT
miyg0r9mafc0Cocu9I6n27AgO8rtoYncBnWzCnediWNBRFuOfYWLjXF/LFij
oD2989Eae8RDL4sINgRESbTRF6zx0F665kkkG/x2b9LNcLRGp2VH+8Ir2WCo
inTforbCKRM93fOH2OAaIfFXfmeFpX0cnWouBx4EHr88rLTC8JkFS27v4EBI
CGdjwmcce13TcreRA7vaMxjrvrHCXs294QdjHEig9pJMuRWO8BqzDHO5oH7z
5eIYCyvs/CBYHb6VC7dObxjTqy2N+XIhNMCL1S61xCtd3oPTtVyIDn59sN/B
Eiv9Ojqv2fLghWH8PnOAxD7evs26IB7kn/RIiKkikbfN3eduNg98GLu/Tgwn
MagmP1B5kQfH5s/hDrJIdPF1DWkd4IGqSb4s6BmB5GtraojiQ7mInBB3EBgQ
YvA0W8yHtdGzo25lEnjqxskUThIfJA61i+rjCYzzP3SFX84HGzl97qiSwEtD
h9zEPXwI8FGyahcSmNysWDB/jA/vv+IZpE6E8T4FkDg1cpVzowDr7Goaflsu
gF77Lk3hRgFOmqycXJ8kAG8X57WqMT4uPVtbNfW4AFKiGjJyyvlYvUCyeXqH
AP66I/KvLOMj16p9e8I/Aji8/+ZVVPDxw0RTWDaTAO2Ng5KSfh4q4mZ0f7Ql
QOdbXJ9WxsOwknPlNrMIeLp9sE2t4+KKxdc6//YlIGuFc0yGBxd3Srt0ymAC
ft50pehSJAd/clc+Kl1PQHJe8FRkc5AXZ/lq31YCVKOj+3sq2Pjq0bS9btkE
OKVmRfjls9FOpH1RUEjAM8advmkpbOP/EZBayih++CsLk6VFhwvrCTiSJzoQ
zGKhymnZQ492AjRXhb73jlmgCzn9XUkvAY+2Pu46NslEr9vNv1x7SsBC+tqM
I/cZ2CwuKmt8S4Cb6OrmtkwGOvptykueIKBCQSvs9mbgjT7n4U9cEmoCzczy
JAyUhQ5HBNmRkDwSX6U6S8cBN8mcLVISOvbsuay9aYpfVBv6IuaRoGGl8NKP
0jCCWVFiF0iCg2jn91xbGlq+wPbqVSSEd9gJM0U0XOAuz+WvJyHk+XJ14cRk
qzTIyTrwBxIWyvWDxd6TrYnqujxFKglJLbHmDe361kW7d4zPziXh3nDqk7Ci
sdZ/AcFoNvo=
           "]]}, {}}, {}, {}, {}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{-0.16902621844570595`, -12.361182248134455`},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{
         Charting`ScaledTicks[{Log, Exp}], 
         Charting`ScaledFrameTicks[{Log, Exp}]}, {
         Charting`ScaledTicks[{Log, Exp}], 
         Charting`ScaledFrameTicks[{Log, Exp}]}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->All,
      Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Exp[#]& )[
             Part[#, 1]], 
            (Exp[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Exp[#]& )[
             Part[#, 1]], 
            (Exp[#]& )[
             Part[#, 2]]}& )}},
      PlotRange->{{-0.09573166354447063, 
       4.59511985013459}, {-12.153422496727337`, 0.7276820905138854}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.02], 
         Scaled[0.05]}},
      Ticks->FrontEndValueCache[{
         Charting`ScaledTicks[{Log, Exp}], 
         Charting`ScaledTicks[{Log, Exp}]}, {{{0., 
           FormBox["1", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {1.6094379124341003`, 
           FormBox["5", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {2.302585092994046, 
           FormBox["10", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {3.912023005428146, 
           FormBox["50", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {4.605170185988092, 
           FormBox["100", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.6931471805599453, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.5108256237659907, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.35667494393873245`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.2231435513142097, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.10536051565782628`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {0.6931471805599453, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.0986122886681098`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.3862943611198906`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.791759469228055, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.9459101490553132`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.0794415416798357`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.1972245773362196`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.995732273553991, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {3.4011973816621555`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {3.6888794541139363`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {4.0943445622221, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {4.248495242049359, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {4.382026634673881, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {4.499809670330265, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {5.298317366548036, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {5.703782474656201, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {5.991464547107982, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {6.214608098422191, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}}, {{-11.512925464970229`, 
           FormBox[
            TemplateBox[{"10", 
              RowBox[{"-", "5"}]}, "Superscript", SyntaxForm -> 
             SuperscriptBox], TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-9.210340371976182, 
           FormBox[
            TemplateBox[{"10", 
              RowBox[{"-", "4"}]}, "Superscript", SyntaxForm -> 
             SuperscriptBox], TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-6.907755278982137, 
           FormBox["0.001`", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-4.605170185988091, 
           FormBox[
            TagBox[
             InterpretationBox["\"0.010\"", 0.01, AutoDelete -> True], 
             NumberForm[#, {
               DirectedInfinity[1], 3}]& ], TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.3025850929940455`, 
           FormBox[
            TagBox[
             InterpretationBox["\"0.100\"", 0.1, AutoDelete -> True], 
             NumberForm[#, {
               DirectedInfinity[1], 3}]& ], TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {0., 
           FormBox["1", TraditionalForm], {0.01, 0.}, {
            AbsoluteThickness[0.1]}}, {-13.815510557964274`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-13.122363377404328`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-12.716898269296165`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-12.429216196844383`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-12.206072645530174`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-12.02375108873622, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-11.86960040890896, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-11.736069016284437`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-11.618285980628055`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-10.819778284410283`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-10.41431317630212, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-10.126631103850338`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-9.903487552536127, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-9.721165995742174, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-9.567015315914915, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-9.433483923290392, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-9.315700887634009, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-8.517193191416238, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-8.111728083308073, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.824046010856292, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.600902459542082, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.418580902748128, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.264430222920869, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.1308988302963465`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-7.013115794639964, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-6.214608098422191, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-5.809142990314028, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-5.521460917862246, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-5.298317366548036, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-5.115995809754082, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-4.961845129926823, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-4.8283137373023015`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-4.710530701645918, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-3.912023005428146, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-3.506557897319982, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-3.2188758248682006`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.995732273553991, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.8134107167600364`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.659260036932778, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.5257286443082556`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-2.4079456086518722`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-1.6094379124341003`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-1.2039728043259361`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.916290731874155, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.6931471805599453, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.5108256237659907, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.35667494393873245`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.2231435513142097, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {-0.10536051565782628`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {0.6931471805599453, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.0986122886681098`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.3862943611198906`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.6094379124341003`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.791759469228055, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {1.9459101490553132`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.0794415416798357`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.1972245773362196`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.302585092994046, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {2.995732273553991, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {3.4011973816621555`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}, {3.6888794541139363`, 
           FormBox[
            TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}, {
            AbsoluteThickness[0.1]}}}}]], {576., -116.80842387373012}, 
     ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}]}, {}},
  ContentSelectable->True,
  ImageSize->{
    UpTo[600], 
    UpTo[360]},
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{3.812161419441848*^9, 
  3.844841046111327*^9},ExpressionUUID->"5fa33919-b6e6-4806-a606-\
9fba5e2b6e7c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
NumberOfCoalescences[k,T] gives a randomly sampled number of coalescence \
events that occur in T (scaled to 2N) NumberOfCoalescences[{t1,t2..}] does \
the same, for a given list of coalescence times.\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"728058cc-9e8f-4b36-856b-7cfbd83869fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfCoalescences", "[", 
    RowBox[{"k_Integer", ",", "T_"}], "]"}], ":=", 
   RowBox[{"NumberOfCoalescences", "[", 
    RowBox[{
     RowBox[{"RandomCoalescenceTimes", "[", "k", "]"}], ",", "T"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5d79a151-6769-4d78-a8b0-1057a68eb955"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfCoalescences", "[", 
    RowBox[{"tl_List", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"Select", "[", 
     RowBox[{"tl", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "<", "T"}], ")"}], "&"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7e45e6bb-e915-4980-91c1-14e9d28a3818"]
}, Closed]],

Cell[CellGroupData[{

Cell["TotalLength[{t1,t2,..}] is the total length of the tree", \
"Subsubsection",ExpressionUUID->"eba2af27-4aac-42fc-bc5d-8d28d887a35f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TotalLength", "[", "tl_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"Plus", "@@", "tl"}], "+", 
    RowBox[{"Last", "[", "tl", "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7a6f3799-b163-4688-b01a-89ef33b0f53c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomFamilies[k] generates a list of the family sizes going back through \
time to the common ancestor of k genes.\
\>", "Subsubsection",ExpressionUUID->"6b7a0f4b-948f-40a8-8ffc-b4541e4f60d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomFamilies", "[", "k_Integer", "]"}], ":=", 
   RowBox[{"NestList", "[", 
    RowBox[{"RandomPreviousFamily", ",", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{"1", "&"}], ",", "k"}], "]"}], ",", 
     RowBox[{"k", "-", "1"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"3295f198-3a7a-4ea9-9f63-1c15b9352ecd"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomPreviousFamily[{1,1,2,3}] generates a random coalescence to give the \
previous family structure\
\>", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"bdea6484-dc98-49de-8d34-f3f13c26036c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RandomPreviousFamily", "[", 
    RowBox[{"{", "k_Integer", "}"}], "]"}], ":=", 
   RowBox[{"{", "k", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPreviousFamily", "[", "n_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rp", ",", 
       RowBox[{"k", "=", 
        RowBox[{"Length", "[", "n", "]"}]}], ",", "n2"}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"rp", "=", 
        RowBox[{"RandomSet", "[", 
         RowBox[{"2", ",", "k"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rp", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"RandomSample", "[", 
         RowBox[{
          RowBox[{"Range", "[", "k", "]"}], ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{"n", "\[LeftDoubleBracket]", 
        RowBox[{"rp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[RightDoubleBracket]"}]}], ";", 
      RowBox[{"Sort", "[", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{"n", ",", 
           RowBox[{
           "rp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", 
         RowBox[{"n2", "+", 
          RowBox[{"n", "\[LeftDoubleBracket]", 
           RowBox[{
           "rp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{
         "rp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571282922725039*^9, 
  3.5712829468675833`*^9}},ExpressionUUID->"2f7c590d-04d7-4b79-861d-\
430b4d9a2b5c"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"RandomGenealogy", "[", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["leaf", "1"], ",", 
       SubscriptBox["leaf", "2"], ",", "\[Ellipsis]"}], "}"}], "]"}], " ", 
    "gives", " ", "a", " ", "random", " ", "realisation", " ", "of", " ", 
    "the", " ", "coalescent", " ", 
    RowBox[{"process", ".", "  ", "Terminal"}], " ", "nodes", " ", "are", " ",
     "labelled", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["leaf", "1"], ",", 
      SubscriptBox["leaf", "2"], ",", "\[Ellipsis]"}], "}"}]}], ",", " ", 
   RowBox[{
   "and", " ", "internal", " ", "nodes", " ", "are", " ", "labelled", " ", 
    "by", " ", "an", " ", "integer"}], ",", " ", 
   RowBox[{
   "in", " ", "the", " ", "order", " ", "in", " ", "which", " ", "they", " ", 
    RowBox[{"occur", ".", "  ", "Each"}], " ", "node", " ", "carries", " ", 
    "its", " ", "time"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"scaled", " ", "to", " ", "2", "N", " ", 
       RowBox[{"generations", ".", "  ", "MutationRate"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{"\[Theta]", " ", "simulates", " ", "infinite"}], "-", 
       RowBox[{
       "sites", " ", "mutation", " ", "at", " ", "a", " ", "rate", " ", 
        "\[Theta]"}]}]}], "=", 
     RowBox[{"4", "N\[Mu]"}]}], ";", " ", 
    RowBox[{
     RowBox[{
     "mutations", " ", "are", " ", "labelled", " ", "by", " ", "unique", " ", 
      RowBox[{"integers", ".", " ", "NodeLabels"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["label", "1"], ",", "\[Ellipsis]"}], "}"}], " ", "can", 
      " ", "be", " ", "used", " ", "to", " ", "label", " ", "internal", " ", 
      RowBox[{"nodes", ".", " "}]}]}]}]}], TextForm]], "Subsubsection",
 CellChangeTimes->{{3.8121654720476933`*^9, 
  3.8121654865779552`*^9}},ExpressionUUID->"f6f717fa-ffb5-42a5-b4a0-\
9e248becf201"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "RandomGenealogy", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NodeLabels", "\[Rule]", "None"}], ",", 
     RowBox[{"MutationRate", "\[Rule]", "None"}], ",", 
     RowBox[{"CoalescenceTimes", "\[Rule]", "Random"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a513c99c-5894-4306-9808-c2f536c07c9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomGenealogy", "[", 
    RowBox[{"ls_", ",", "opts___Rule"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "ls", "]"}]}], ",", "nl", ",", "li", ",", "ni",
        ",", "mu", ",", "\[Mu]T", ",", "rt", ",", "rg", ",", 
       RowBox[{"nm", "=", "0"}], ",", "j", ",", "\[Lambda]"}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"rt", "=", 
       RowBox[{
        RowBox[{"CoalescenceTimes", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "RandomGenealogy", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "             ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"rt", "===", "Random"}], ",", 
        RowBox[{"rt", "=", 
         RowBox[{"RandomCoalescenceTimes", "[", "n", "]"}]}]}], "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"nl", "=", 
       RowBox[{
        RowBox[{"NodeLabels", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "RandomGenealogy", "]"}]}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"mu", "=", 
       RowBox[{
        RowBox[{"MutationRate", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "RandomGenealogy", "]"}]}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"li", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mu", "===", "None"}], ",", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "0", "}"}], "&"}], ",", "n"}], "]"}], ",", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Mu]T"}], "}"}], "&"}], ",", "n"}], "]"}]}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"ni", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mu", "===", "None"}], ",", 
         RowBox[{"(", 
          RowBox[{"List", "/@", "rt"}], ")"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "\[Mu]T"}], "}"}], "&"}], "/@", "rt"}]}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"rg", "=", 
       RowBox[{"FamilyToGenealogy", "[", 
        RowBox[{"ls", ",", 
         RowBox[{"RandomFamilies", "[", "n", "]"}], ",", 
         RowBox[{"NodeLabels", "\[Rule]", "nl"}], ",", 
         RowBox[{"NodeInformation", "\[Rule]", "ni"}], ",", 
         RowBox[{"LeafInformation", "\[Rule]", "li"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mu", "===", "None"}], ",", "\n", "\t\t\t", "rg", ",", "\n", 
        "\t\t  ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "rg", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rt", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"rg", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Node", "[", 
             RowBox[{"i1_", ",", 
              RowBox[{"{", 
               RowBox[{"t1_", ",", "\[Mu]_List"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a___", ",", 
                RowBox[{"Node", "[", 
                 RowBox[{"i2_", ",", 
                  RowBox[{"{", 
                   RowBox[{"t2_", ",", "\[Mu]T"}], "}"}], ",", 
                  RowBox[{"{", "m___", "}"}]}], "]"}], ",", "b___"}], "}"}]}],
              "]"}], ":>", "\n", "\t\t\t\t\t\t", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Lambda]", "=", 
               RowBox[{"mu", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"t1", "-", "t2"}], ")"}], "/", "2"}]}]}], ";", "\n",
               "\t\t\t\t\t\t\t", 
              RowBox[{"j", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"\[Lambda]", "==", "0"}], ",", "0", ",", 
                 RowBox[{"Random", "[", 
                  RowBox[{"PoissonDistribution", "[", "\[Lambda]", "]"}], 
                  "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"nm", "=", 
               RowBox[{"nm", "+", "j"}]}], ";", 
              RowBox[{"Node", "[", 
               RowBox[{"i1", ",", 
                RowBox[{"{", 
                 RowBox[{"t1", ",", "\[Mu]"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", 
                  RowBox[{"Node", "[", 
                   RowBox[{"i2", ",", 
                    RowBox[{"{", 
                    RowBox[{"t2", ",", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"\[Mu]", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"nm", "-", "j", "+", "1"}], ",", "nm"}], "]"}]}], 
                    "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}], ",", "b"}], "}"}]}], 
               "]"}]}], ")"}]}], "}"}]}]}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"aa303c4b-4085-4c0a-aa51-6f5756522247"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"DeletedMutations", "[", 
    RowBox[{"g", ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["T", "0"], ",", 
       SubscriptBox["T", "1"]}], "}"}]}], "]"}], " ", "lists", " ", "those", 
   " ", "mutations", " ", "that", " ", "should", " ", "be", " ", "deleted", 
   " ", "because", " ", "they", " ", "occurred", " ", "in", " ", "time", " ", 
   "interval", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["T", "0"], ",", 
      SubscriptBox["T", "1"]}], "}"}], ".", "  ", "This"}], " ", "list", " ", 
   "may", " ", "be", " ", "to", " ", "some", " ", "extent", " ", "randomly", 
   " ", 
   RowBox[{"generated", "."}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"e02a2adf-930e-4dfb-a899-44bd3cb5d23d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeletedMutations", "[", 
    RowBox[{"g_Node", ",", 
     RowBox[{"{", 
      RowBox[{"T0_", ",", "T1_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tt", "=", 
        RowBox[{"{", "}"}]}], ",", "ii", ",", "mi"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"mi", "=", 
            RowBox[{"MutationInterval", "[", 
             RowBox[{"g", ",", "#1"}], "]"}]}], ";", 
           RowBox[{"ii", "=", 
            RowBox[{"IntervalIntersection", "[", 
             RowBox[{
              RowBox[{"Interval", "[", 
               RowBox[{"{", 
                RowBox[{"T0", ",", "T1"}], "}"}], "]"}], ",", 
              RowBox[{"Interval", "[", "mi", "]"}]}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"ii", "===", 
               RowBox[{"Interval", "[", "]"}]}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Max", "[", "mi", "]"}], "-", 
                   RowBox[{"Min", "[", "mi", "]"}]}], ")"}], " ", 
                 RowBox[{"RandomReal", "[", "]"}]}], "<", 
                RowBox[{
                 RowBox[{"Max", "[", "ii", "]"}], "-", 
                 RowBox[{"Min", "[", "ii", "]"}]}]}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"tt", ",", "#1"}], "]"}]}], "]"}]}], "]"}]}], ")"}], 
         "&"}], ")"}], "/@", 
       RowBox[{"Mutations", "[", "g", "]"}]}], ";", "tt"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b2b57555-bf5e-4cab-89e9-5b41198336b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomBottleneckedGenealogy[leaves,{T0,T1},\[Theta]] gives a random \
genealogy, with no mutations occurring in time interval {T0,T1}.\
\>", "Subsubsection",ExpressionUUID->"dfbcf62d-42ba-4ca4-859f-29deb566103b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomBottleneckedGenealogy", "[", 
    RowBox[{"lv_", ",", 
     RowBox[{"{", 
      RowBox[{"T0_", ",", "T1_"}], "}"}], ",", "\[Theta]_"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g", "=", 
        RowBox[{"RandomGenealogy", "[", 
         RowBox[{"lv", ",", 
          RowBox[{"MutationRate", "\[Rule]", "\[Theta]"}]}], "]"}]}], " ", 
       ",", "dl"}], "}"}], ",", "\n", "\t   ", 
     RowBox[{
      RowBox[{"dl", "=", 
       RowBox[{"DeletedMutations", "[", 
        RowBox[{"g", ",", 
         RowBox[{"{", 
          RowBox[{"T0", ",", "T1"}], "}"}]}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"TransformInformation", "[", 
       RowBox[{"g", ",", 
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "dl"}], "]"}], ",", "2"}], "]"}], "&"}]}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d2487a72-20c7-43ef-a074-3055c0a052cd"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Generating functions", "Subsection",ExpressionUUID->"19482457-7af0-438f-84e9-2e6764ff9053"],

Cell[CellGroupData[{

Cell["\<\
MomentGeneratingFunction[g,\[Omega],\[Theta]] gives the generating function \
for the number of mutations along each branch of the genealogy, under the \
infinite sites model.\
\>", "Subsubsection",ExpressionUUID->"226c8c0f-fcc7-46fd-a227-59da13cc6dc3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MomentGeneratingFunction", "[", 
    RowBox[{
     RowBox[{"Node", "[", 
      RowBox[{"i_", ",", "_List", ",", 
       RowBox[{"{", 
        RowBox[{"Node", "[", 
         RowBox[{"a_", ",", "s_List", ",", 
          RowBox[{"{", "nn__Node", "}"}]}], "]"}], "}"}]}], "]"}], ",", 
     "\[Omega]_", ",", "\[Theta]_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"MomentGeneratingFunction", "[", 
    RowBox[{
     RowBox[{"Node", "[", 
      RowBox[{"a", ",", "s", ",", 
       RowBox[{"{", "nn", "}"}]}], "]"}], ",", "\[Omega]", ",", "\[Theta]"}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"cefc19f5-47da-4821-aba9-e342373c5f06"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"MomentGeneratingFunction\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"MomentGeneratingFunction\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Node\\\", \\\"[\\\", RowBox[{\\\"i_\\\", \\\",\\\", \
\\\"_List\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"Node\\\", \\\"[\\\", \
RowBox[{\\\"a_\\\", \\\",\\\", \\\"s_List\\\", \\\",\\\", RowBox[{\\\"{\\\", \
\\\"nn__Node\\\", \\\"}\\\"}]}], \\\"]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \
\\\",\\\", \\\"\[Omega]_\\\", \\\",\\\", \\\"\[Theta]_\\\"}], \\\"]\\\"}]\\) \
is Protected.\"",2,627,10,19604041926407031907,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.535108956194178*^9, 3.571236594631056*^9, 3.5712376931080103`*^9, 
   3.571237759374979*^9, 3.764759180470096*^9, 3.765348752671043*^9, 
   3.808039327366695*^9, 3.810726986577793*^9, 3.81209284480293*^9, 
   3.812793059740528*^9, 3.813456039874489*^9, 3.813460624559993*^9, 
   3.814611682119441*^9, 3.815717765026124*^9, 3.81725694181182*^9, 
   3.817383709029229*^9, 3.817385012420681*^9, 3.8176534128383293`*^9, 
   3.81840535946692*^9, 3.819596119596675*^9, 3.823591575533269*^9, 
   3.826360857137755*^9, {3.844841036489154*^9, 
   3.8448410469730577`*^9}},ExpressionUUID->"491f64b7-42d3-4c23-bf86-\
c629bb0e5068"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MomentGeneratingFunction", "[", 
    RowBox[{
     RowBox[{"Node", "[", 
      RowBox[{"i_", ",", "_List", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Node", "[", 
          RowBox[{"a_", ",", "_List", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"Node", "[", 
          RowBox[{"b_", ",", "_List", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], ",", "\[Omega]_", 
     ",", "\[Theta]_"}], "]"}], ":=", "\n", "\t", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     RowBox[{"\[Theta]", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", "[", "a", "]"}], "+", 
           RowBox[{"\[Omega]", "[", "b", "]"}]}], ")"}], "/", "2"}]}], 
       ")"}]}]}]]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b2db052d-30b0-4f79-b32e-ac4b16b7451f"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"MomentGeneratingFunction\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"MomentGeneratingFunction\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Node\\\", \\\"[\\\", RowBox[{\\\"i_\\\", \\\",\\\", \
\\\"_List\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Node\\\", \\\
\"[\\\", RowBox[{\\\"a_\\\", \\\",\\\", \\\"_List\\\", \\\",\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"Node\\\", \\\"[\\\", RowBox[{\\\"b_\\\", \\\",\\\", \
\\\"_List\\\", \\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"]\\\"}]}], \\\
\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \\\"\[Omega]_\\\", \\\",\\\", \\\"\
\[Theta]_\\\"}], \\\"]\\\"}]\\) is Protected.\"",2,628,11,
   19604041926407031907,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.535108956246677*^9, 3.571236594681363*^9, 3.571237693154026*^9, 
   3.571237759446026*^9, 3.764759180497525*^9, 3.765348752734771*^9, 
   3.8080393273943996`*^9, 3.8107269865837307`*^9, 3.812092844809169*^9, 
   3.8127930597480907`*^9, 3.813456039882947*^9, 3.813460624579802*^9, 
   3.8146116821266823`*^9, 3.815717765070891*^9, 3.8172569418181047`*^9, 
   3.8173837090356607`*^9, 3.817385012459333*^9, 3.8176534128507767`*^9, 
   3.818405359556962*^9, 3.819596119624277*^9, 3.823591575542286*^9, 
   3.826360857143441*^9, {3.844841036820221*^9, 
   3.8448410473071823`*^9}},ExpressionUUID->"50a785fc-3bb6-4a2a-9d64-\
d30883fc3cc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MomentGeneratingFunction", "[", 
    RowBox[{"g_Node", ",", "\[Omega]_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"leaves", "=", 
        RowBox[{"Leaves", "[", "g", "]"}]}], ",", "\n", "\t\t", "n", ",", 
       "\[Lambda]", ",", "\[Phi]"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "leaves", "]"}]}], ";", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{
        FractionBox["n", "2"], 
        RowBox[{"(", 
         RowBox[{"\[Theta]", "+", "n", "-", "1"}], ")"}]}]}], ";", 
      RowBox[{"\[Phi]", "=", 
       FractionBox["\[Theta]", 
        RowBox[{"n", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "+", "n", "-", "1"}], ")"}]}]]}], ";", "\n", 
      "\t\t\t", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"\[Lambda]", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Phi]", 
            RowBox[{"(", 
             RowBox[{"Plus", "@@", 
              RowBox[{"(", 
               RowBox[{"\[Omega]", "/@", "leaves"}], ")"}]}], ")"}]}]}], 
          ")"}]}]], "*", 
       RowBox[{"(", 
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"MomentGeneratingFunction", "[", 
              RowBox[{
               RowBox[{"g", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Node", "[", 
                    RowBox[{"x_", ",", "y_", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Node", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"Node", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "_", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], ":>", 
                   RowBox[{"Node", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Node", "[", 
                    RowBox[{"x_", ",", "y_", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Node", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "_", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"Node", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], ":>", 
                   RowBox[{"Node", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}]}], "}"}]}], ",", "\[Omega]",
                ",", "\[Theta]"}], "]"}], ")"}], "&"}], "/@", 
           RowBox[{"SiblingList", "[", "g", "]"}]}], ")"}]}], ")"}]}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ceeb6c76-2f08-4457-be00-296e6ecf89f9"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"MomentGeneratingFunction\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"MomentGeneratingFunction\\\", \\\"[\\\", \
RowBox[{\\\"g_Node\\\", \\\",\\\", \\\"\[Omega]_\\\", \\\",\\\", \
\\\"\[Theta]_\\\"}], \\\"]\\\"}]\\) is Protected.\"",2,629,12,
   19604041926407031907,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.535108956277441*^9, 3.5712365947253227`*^9, 3.5712376931974163`*^9, 
   3.57123775951432*^9, 3.76475918052559*^9, 3.765348752805159*^9, 
   3.80803932740191*^9, 3.8107269866255007`*^9, 3.8120928448520203`*^9, 
   3.812793059792099*^9, 3.813456039927507*^9, 3.813460624589424*^9, 
   3.8146116821652203`*^9, 3.815717765109599*^9, 3.817256941849304*^9, 
   3.817383709071507*^9, 3.8173850124660263`*^9, 3.817653412906406*^9, 
   3.8184053595654087`*^9, 3.819596119631137*^9, 3.823591575563472*^9, 
   3.826360857150017*^9, {3.844841037239132*^9, 
   3.844841047621237*^9}},ExpressionUUID->"c420d825-83f4-4104-98a9-\
3db7b41ef0d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MomentGeneratingFunction", "[", 
    RowBox[{
     RowBox[{"{", "g__List", "}"}], ",", "\[Omega]_", ",", "\[Theta]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"MomentGeneratingFunction", "[", 
     RowBox[{
      RowBox[{"{", "g", "}"}], ",", "\[Omega]", ",", "\[Theta]"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "g", "}"}], "]"}]}], ",", "\[Lambda]", ",", "\[Phi]", 
        ",", "ng", ",", "gl", ",", "i", ",", "j"}], "}"}], ",", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "==", "1"}], ",", "1", ",", 
        RowBox[{
         RowBox[{"\[Lambda]", "=", 
          RowBox[{
           FractionBox["n", "2"], 
           RowBox[{"(", 
            RowBox[{"\[Theta]", "+", "n", "-", "1"}], ")"}]}]}], ";", 
         RowBox[{"\[Phi]", "=", 
          FractionBox["\[Theta]", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"\[Theta]", "+", "n", "-", "1"}], ")"}]}]]}], ";", "\n", 
         "    ", 
         RowBox[{"gl", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", "g", "}"}], "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"{", "g", "}"}], "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
           "]"}]}], ";", "\n", "\t\t", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"\[Lambda]", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"\[Phi]", 
               RowBox[{"(", 
                RowBox[{"Plus", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"Sort", "[", "#", "]"}], "]"}], "&"}], "/@", 
                   RowBox[{"{", "g", "}"}]}], ")"}]}], ")"}]}]}], ")"}]}]], 
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ng", "=", 
                 RowBox[{
                  RowBox[{"{", "g", "}"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x___", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "y___", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "z___"}], "}"}], ":>", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "y", ",", "z"}], 
                    "}"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x___", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "y___", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "z___"}], "}"}], ":>", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "y", ",", "z"}], 
                    "}"}], "]"}]}]}], "}"}]}]}], ";", 
                RowBox[{"MomentGeneratingFunction", "[", 
                 RowBox[{"ng", ",", "\[Omega]", ",", "\[Theta]"}], "]"}]}], 
               ")"}], "&"}], "/@", "gl"}], ")"}]}]}]}]}], "]"}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"2ceca243-8c68-4816-a380-e4a3867b219a"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"MomentGeneratingFunction\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"MomentGeneratingFunction\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", \\\"g__List\\\", \\\"}\\\"}], \\\",\\\", \\\"\
\[Omega]_\\\", \\\",\\\", \\\"\[Theta]_\\\"}], \\\"]\\\"}]\\) is \
Protected.\"",2,630,13,19604041926407031907,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.5351089564935417`*^9, 3.5712365947670383`*^9, 3.571237693245579*^9, 
   3.5712377595787497`*^9, 3.764759180552259*^9, 3.765348752918364*^9, 
   3.808039327428071*^9, 3.810726986633164*^9, 3.8120928448601103`*^9, 
   3.8127930598021803`*^9, 3.8134560399407187`*^9, 3.813460624611405*^9, 
   3.814611682172505*^9, 3.815717765117161*^9, 3.817256941856999*^9, 
   3.817383709078704*^9, 3.81738501247344*^9, 3.8176534129159822`*^9, 
   3.818405359668743*^9, 3.819596119667947*^9, 3.823591575615662*^9, 
   3.826360857179348*^9, {3.844841037611381*^9, 
   3.8448410479357758`*^9}},ExpressionUUID->"dc3f9fc2-b5ce-4192-ad1e-\
0342a4717798"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["The probability of genealogies", "Subsection",ExpressionUUID->"59043d53-0f89-4b9b-84eb-925f7e72032d"],

Cell[CellGroupData[{

Cell["\<\
PossibleCoalescenceOrder[g] lists the possible orders in which coalescence \
events might occur; each is given by an ordered list of nodes.\
\>", "Subsubsection",ExpressionUUID->"7c021ae9-acb3-44fb-9fb2-f6aed6f8994b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PossibleCoalescenceOrder", "[", 
    RowBox[{"Node", "[", 
     RowBox[{"i_", ",", "_", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Node", "[", 
         RowBox[{"a_", ",", "_", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", 
        RowBox[{"Node", "[", 
         RowBox[{"b_", ",", "_", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", "i"}], "]"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"aa4762b5-6d68-43d2-b21d-502a86be2a02"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PossibleCoalescenceOrder", "[", 
    RowBox[{"Node", "[", 
     RowBox[{"i_", ",", "_", ",", 
      RowBox[{"{", 
       RowBox[{"Node", "[", 
        RowBox[{"a_", ",", "s_", ",", 
         RowBox[{"{", "nn__Node", "}"}]}], "]"}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{"#", ",", "i"}], "]"}], "&"}], "/@", 
    RowBox[{"PossibleCoalescenceOrder", "[", 
     RowBox[{"Node", "[", 
      RowBox[{"a", ",", "s", ",", 
       RowBox[{"{", "nn", "}"}]}], "]"}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"adc125ee-9287-418d-9503-149d2173e084"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PossibleCoalescenceOrder", "[", "g_Node", "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sl", "=", 
        RowBox[{"SiblingList", "[", "g", "]"}]}], ",", 
       RowBox[{"tl", "=", 
        RowBox[{"{", "}"}]}], ",", "lv", ",", "j"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"tl", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"tl", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{
               "sl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"PossibleCoalescenceOrder", "[", 
             RowBox[{"g", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Node", "[", 
                  RowBox[{"i_", ",", "s_", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Node", "[", 
                    RowBox[{
                    RowBox[{"sl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    "_", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"Node", "[", 
                    RowBox[{
                    RowBox[{"sl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    "_", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], ":>", 
                 RowBox[{"Node", "[", 
                  RowBox[{"i", ",", "s", ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Node", "[", 
                  RowBox[{"i_", ",", "s_", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Node", "[", 
                    RowBox[{
                    RowBox[{"sl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    "_", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"Node", "[", 
                    RowBox[{
                    RowBox[{"sl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    "_", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], ":>", 
                 RowBox[{"Node", "[", 
                  RowBox[{"i", ",", "s", ",", 
                   RowBox[{"{", "}"}]}], "]"}]}]}], "}"}]}], "]"}]}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "sl", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"lv", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Leaves", "[", "g", "]"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"lv", ",", 
          RowBox[{"TakeAway", "[", 
           RowBox[{"#", ",", "lv"}], "]"}]}], "]"}], "&"}], "/@", "tl"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ef15eb7f-6223-4b48-afbd-17d6bebf5867"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RandomCoalescenceOrder[g] gives a random ordering of the possible coalescence \
events\
\>", "Subsubsection",ExpressionUUID->"485d144f-4264-4d3e-be67-ea36d6ba99b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomCoalescenceOrder", "[", 
    RowBox[{"Node", "[", 
     RowBox[{"i_", ",", "_", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Node", "[", 
         RowBox[{"a_", ",", "_", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", 
        RowBox[{"Node", "[", 
         RowBox[{"b_", ",", "_", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", "i"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"69226cf0-abc8-4f13-9c56-4f6c58a7cd41"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomCoalescenceOrder", "[", 
    RowBox[{"Node", "[", 
     RowBox[{"i_", ",", "_", ",", 
      RowBox[{"{", 
       RowBox[{"Node", "[", 
        RowBox[{"a_", ",", "s_", ",", 
         RowBox[{"{", "nn__Node", "}"}]}], "]"}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"RandomCoalescenceOrder", "[", 
      RowBox[{"Node", "[", 
       RowBox[{"a", ",", "s", ",", 
        RowBox[{"{", "nn", "}"}]}], "]"}], "]"}], ",", "i"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"be47502f-4ed7-45d0-b2ef-7a5d90e9509b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomCoalescenceOrder", "[", "g_Node", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sl", "=", 
       RowBox[{"SiblingList", "[", "g", "]"}]}], ",", "lv", ",", "j", ",", 
      "tl"}], "}"}], ",", 
    RowBox[{
     RowBox[{"j", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "sl", "]"}]}], "}"}], "]"}]}], ";", 
     RowBox[{"tl", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"RandomCoalescenceOrder", "[", 
         RowBox[{"g", "/.", "\[VeryThinSpace]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Node", "[", 
              RowBox[{"i_", ",", "s_", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Node", "[", 
                  RowBox[{
                   RowBox[{"sl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   "_", ",", 
                   RowBox[{"{", "}"}]}], "]"}], ",", 
                 RowBox[{"Node", "[", 
                  RowBox[{
                   RowBox[{"sl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                   "_", ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Node", "[", 
              RowBox[{"i", ",", "s", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Node", "[", 
              RowBox[{"i_", ",", "s_", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Node", "[", 
                  RowBox[{
                   RowBox[{"sl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                   "_", ",", 
                   RowBox[{"{", "}"}]}], "]"}], ",", 
                 RowBox[{"Node", "[", 
                  RowBox[{
                   RowBox[{"sl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   "_", ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Node", "[", 
              RowBox[{"i", ",", "s", ",", 
               RowBox[{"{", "}"}]}], "]"}]}]}], "}"}]}], "]"}]}], "]"}]}], 
     ";", 
     RowBox[{"lv", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Leaves", "[", "g", "]"}], "]"}]}], ";", 
     RowBox[{"Join", "[", 
      RowBox[{"lv", ",", 
       RowBox[{"TakeAway", "[", 
        RowBox[{"tl", ",", "lv"}], "]"}]}], "]"}], ";"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571237492468317*^9, 3.5712375169390163`*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"2927f019-b313-4044-a08b-fc2e2861db75"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
NumberOfPossibleCoalescences[g,nodelist] gives the number of possible \
coalescences that could occur at each step. Only internal nodes are included. \
The order of coalescences is defined by nodelist\
\>", "Subsubsection",ExpressionUUID->"6ccb066b-b743-413c-a7e2-a32a11deb019"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfPossibleCoalescences", "[", 
    RowBox[{"g_Node", ",", "nl_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lv", "=", 
        RowBox[{"Leaves", "[", "g", "]"}]}], ",", 
       RowBox[{"ng", "=", "g"}], ",", 
       RowBox[{"tt", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", "       ", 
     RowBox[{
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"tt", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"SiblingList", "[", "ng", "]"}], "]"}]}], "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"ng", "=", 
            RowBox[{"ng", "/.", 
             RowBox[{
              RowBox[{"Node", "[", 
               RowBox[{"#", ",", "s_", ",", 
                RowBox[{"{", "___", "}"}]}], "]"}], ":>", 
              RowBox[{"Node", "[", 
               RowBox[{"#", ",", "s", ",", 
                RowBox[{"{", "}"}]}], "]"}]}]}]}]}], ")"}], "&"}], ",", 
        RowBox[{"TakeAway", "[", 
         RowBox[{"nl", ",", "lv"}], "]"}]}], "]"}], ";", "tt"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"41ffed46-6f46-418e-8bc2-890dc0132346"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
IncidenceMatrix[g,nodelist] gives the matrix describing an ordering of \
coalescences defined by nodelist.  The last member of nodelist is the root \
node.  The elements of the matrix show whether a branch is present during the \
time for which there are 1\[LessEqual]i\[LessEqual]n lineages. Rows \
correspond to branches, in the order specified by nodelist. \
\>", "Subsubsection",ExpressionUUID->"8803abf9-cfde-4234-a15c-b019c8b34bd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", "IncidenceMatrix", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d217b14c-da46-4549-b77d-33676b52b2d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IncidenceMatrix", "[", 
    RowBox[{"g_Node", ",", "nl_List"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"leaves", "=", 
        RowBox[{"Leaves", "[", "g", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"n", "=", 
        RowBox[{"NumberOfLineages", "[", "g", "]"}]}], ",", 
       RowBox[{"S", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"g", ",", " ", 
               RowBox[{"Node", "[", 
                RowBox[{"#", ",", "_", ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], "]"}], ",", "0", ",", "1"}], 
            "]"}], "&"}], "/@", "nl"}], "}"}]}], ",", "x", ",", "i"}], "}"}], 
     ",", "\n", "\t\t ", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PrependTo", "[", 
          RowBox[{"S", ",", 
           RowBox[{"First", "[", "S", "]"}]}], "]"}], ";", "\n", 
         "\t         ", 
         RowBox[{
          RowBox[{"S", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], 
         ";", 
         RowBox[{"x", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"nl", ",", "#"}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
            RowBox[{"Descendants", "[", 
             RowBox[{"g", ",", 
              RowBox[{
              "nl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             "]"}]}], ")"}]}], ";", "\n", "\t\t\t    ", 
         RowBox[{
          RowBox[{"S", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", 
            RowBox[{
            "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}], "=", "0"}], ";", 
         RowBox[{
          RowBox[{
           RowBox[{"S", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "\[RightDoubleBracket]"}], "=", "0"}], ";"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "+", "1"}], ",", 
          RowBox[{
           RowBox[{"2", "n"}], "-", "1"}]}], "}"}]}], "]"}], ";", "\n", 
      RowBox[{"Transpose", "[", "S", "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c91887bd-13cb-4682-b192-2c0509ddcda1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "IncidenceMatrix", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8e678287-80a7-4518-bac9-fe97d2a7d26c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MonteCarloProbability[g,nodelist,J,\[Theta],ns] makes a Monte Carlo estimate \
of the probability of the genealogy g and the mutational configuration J, \
assuming that the coalescences are in the order specified by nodelist. A list \
of ns values is returned. MonteCarloProbability[g,J,\[Theta],ns] makes no \
assumptions as to the order of events.\
\>", "Subsubsection",ExpressionUUID->"b765d46c-36bf-4443-b335-3a17c78e2581"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MonteCarloProbability", "[", 
    RowBox[{
     RowBox[{"Node", "[", 
      RowBox[{"i_", ",", "_", ",", 
       RowBox[{"{", "g_Node", "}"}]}], "]"}], ",", "nl_List", ",", "J_List", 
     ",", "\[Theta]_", ",", "\[Phi]_", ",", "ns_Integer"}], "]"}], " ", ":=", 
   "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ps", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"nl", ",", "i"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"MonteCarloProbability", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Delete", "[", 
        RowBox[{"nl", ",", "ps"}], "]"}], ",", 
       RowBox[{"Delete", "[", " ", 
        RowBox[{"J", ",", "ps"}], "]"}], ",", "\[Theta]", ",", "\[Phi]", ",", 
       "ns"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f2ea80a2-b548-449a-8579-bc1f89257c2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MonteCarloProbability", "[", 
    RowBox[{
    "g_Node", ",", "nl_List", ",", "J_List", ",", "\[Theta]_", ",", 
     "\[Theta]1_", ",", "ns_Integer"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"NumberOfLineages", "[", "g", "]"}]}], ",", 
       RowBox[{"S", "=", 
        RowBox[{"IncidenceMatrix", "[", 
         RowBox[{"g", ",", "nl"}], "]"}]}], ",", "i", ",", "j", ",", 
       "\[Phi]v", ",", "\[Phi]v1", ",", "\[Phi]", ",", "\[Phi]1", ",", 
       "\[Lambda]", ",", "Jt"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"\[Phi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         FractionBox["\[Theta]", 
          RowBox[{"i", 
           RowBox[{"(", 
            RowBox[{"\[Theta]", "+", "i", "-", "1"}], ")"}]}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"\[Phi]v", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", ".", "\[Phi]1"}], ")"}], "&"}], "/@", "S"}]}], ";", 
      "\n", "\t\t", 
      RowBox[{"\[Phi]1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         FractionBox["\[Theta]1", 
          RowBox[{"i", 
           RowBox[{"(", 
            RowBox[{"\[Theta]1", "+", "i", "-", "1"}], ")"}]}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"\[Phi]v1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", ".", "\[Phi]1"}], ")"}], "&"}], "/@", "S"}]}], ";", 
      "\n", "\t\t", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{
        UnderoverscriptBox["\[Product]", 
         RowBox[{"i", "=", "2"}], "n"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["i", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"\[Theta]", "+", "i", "-", "1"}], ")"}]}], ")"}]}]}], ";", 
      "\n", " ", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"Times", "@@", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Power", ",", 
            RowBox[{"{", 
             RowBox[{"\[Phi]v", ",", "J"}], "}"}]}], "]"}]}], 
         RowBox[{"\[Lambda]", 
          RowBox[{"(", 
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"Factorial", "/@", "J"}], ")"}]}], " ", ")"}]}]], ")"}], 
       "*", 
       RowBox[{"Table", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Jt", "=", 
           RowBox[{"Plus", "@@", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"RandomMultinomial", "[", 
                RowBox[{"#3", ",", 
                 FractionBox[
                  RowBox[{"#1", "\[Phi]1"}], "#2"]}], "]"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"S", ",", "\[Phi]v1", ",", "J"}], "}"}]}], "]"}]}]}], 
          ";", "\n", "\t\t\t\t", 
          RowBox[{"Times", "@@", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#1", "!"}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox["#2", "#3"], ")"}], "#1"]}], ")"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"Jt", ",", "\[Phi]", ",", "\[Phi]1"}], "}"}]}], 
            "]"}]}]}], ",", 
         RowBox[{"{", "ns", "}"}]}], "]"}]}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"511e5f3f-d1ee-49de-9534-0e6475c3201a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MonteCarloProbability", "[", 
    RowBox[{
    "g_Node", ",", "J_List", ",", "\[Theta]_", ",", "\[Theta]1_", ",", 
     "ns_Integer"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nl", "=", 
       RowBox[{"RandomCoalescenceOrder", "[", "g", "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"MonteCarloProbability", "[", 
       RowBox[{
       "g", ",", "nl", ",", "J", ",", "\[Theta]", ",", "\[Theta]1", ",", 
        "ns"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"NumberOfPossibleCoalescences", "[", 
           RowBox[{"g", ",", "nl"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ")"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d88afe89-9a81-4125-90e5-d68614853b1b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
NumberOfMutations[g,node] gives the number of mutations that occurred on the \
branch leading down to the specified node. The set of mutations is given in \
the second element of the information for each node.\
\>", "Subsubsection",ExpressionUUID->"fe7e8e37-99f9-4432-abc4-922d99a41a3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "NumberOfMutations", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"NodeFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "&"}], ")"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5d8e45dd-0cb8-4034-af47-726213733097"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfMutations", "[", 
    RowBox[{"g_Node", ",", "i_", ",", "opts___Rule"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"Ancestors", "[", 
         RowBox[{"g", ",", "i"}], "]"}]}], ",", "\t", 
       RowBox[{"nf", "=", 
        RowBox[{
         RowBox[{"NodeFunction", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "NumberOfMutations", "]"}]}]}]}], "}"}], ",",
      "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", "===", 
        RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t", "0", ",", "\n", "\t\t\t", 
       RowBox[{"Length", "[", "\n", "\t\t\t\t", 
        RowBox[{"Complement", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"nf", "[", 
           RowBox[{"i", ",", 
            RowBox[{"ExtractInformation", "[", 
             RowBox[{"g", ",", "i"}], "]"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"nf", "[", 
           RowBox[{
            RowBox[{"Last", "[", "a", "]"}], ",", 
            RowBox[{"ExtractInformation", "[", 
             RowBox[{"g", ",", 
              RowBox[{"Last", "[", "a", "]"}]}], "]"}]}], "]"}]}], "]"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"542d256f-7c3d-435f-a14b-0cbee5739ef6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Mutations[g] gives the set of mutations that occurred on g.  Mutations[g,i] \
gives the mutations that arose on the branch leading down to node i.  By \
default, these are held in the second element of the information list.  \
NodeFunction\[Rule]f uses f[i,info] to extract the mutation list.\
\>", "Subsubsection",
 CellChangeTimes->{
  3.812099303285419*^9},ExpressionUUID->"d8ae1288-fd00-4df8-879b-\
7d4ec9e2f2ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Mutations", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"NodeFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "&"}], ")"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"3a2c2fd3-e6a6-4968-82af-9e2fbc553508"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mutations", "[", 
   RowBox[{"g_Node", ",", "opts___Rule"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nf", "=", 
      RowBox[{
       RowBox[{"NodeFunction", "/.", 
        RowBox[{"{", "opts", "}"}]}], "/.", 
       RowBox[{"Options", "[", "Mutations", "]"}]}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"Union", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"CollapseGenealogy", "[", 
        RowBox[{"g", ",", 
         RowBox[{"NodeFunction", "\[Rule]", "nf"}]}], "]"}], 
       "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"92825d7d-38f0-47b0-beb6-1c1e5c67db79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mutations", "[", 
   RowBox[{"g_Node", ",", "i_", ",", "opts___Rule"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nf", "=", 
       RowBox[{
        RowBox[{"NodeFunction", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "Mutations", "]"}]}]}], ",", 
      RowBox[{"an", "=", 
       RowBox[{"Ancestors", "[", 
        RowBox[{"g", ",", "i"}], "]"}]}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"Complement", "[", 
     RowBox[{
      RowBox[{"nf", "[", 
       RowBox[{"i", ",", 
        RowBox[{"ExtractInformation", "[", 
         RowBox[{"g", ",", "i"}], "]"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"an", "===", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"nf", "[", 
         RowBox[{
          RowBox[{"Last", "[", "an", "]"}], ",", 
          RowBox[{"ExtractInformation", "[", 
           RowBox[{"g", ",", 
            RowBox[{"Last", "[", "an", " ", "]"}]}], "]"}]}], "]"}]}], 
       "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"040799e7-88af-4c59-9f9b-ffe81d860ac1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MutationOrigin[g,k] gives the first node at which mutation k appears.\
\>", "Subsubsection",ExpressionUUID->"2ec74ac9-687b-46eb-a2b7-9917e369d078"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MutationOrigin", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"NodeFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"#2", ",", "2"}], "]"}], "&"}], ")"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"4b88d991-b0c8-4b4c-80c7-4a659b21a31a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MutationOrigin", "[", 
    RowBox[{"g_Node", ",", "k_", ",", "opts___Rule"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ll", ",", 
       RowBox[{"nf", "=", 
        RowBox[{
         RowBox[{"NodeFunction", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "MutationOrigin", "]"}]}]}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"ll", "=", 
       RowBox[{"CollapseGenealogy", "[", 
        RowBox[{"g", ",", 
         RowBox[{"NodeFunction", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"nf", "[", 
                  RowBox[{"#1", ",", "#2"}], "]"}], "\[LeftDoubleBracket]", 
                 "2", "\[RightDoubleBracket]"}], ",", "k"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"nf", "[", 
                  RowBox[{"#1", ",", "#2"}], "]"}], "\[LeftDoubleBracket]", 
                 "1", "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "\[Infinity]"}], ",", "#1"}], "}"}]}], "]"}], 
            "&"}], ")"}]}], ",", 
         RowBox[{"Nested", "\[Rule]", "False"}]}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"ll", "=", 
       RowBox[{"First", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{"ll", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ">", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "&"}]}], "]"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ll", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "===", 
         RowBox[{"-", "\[Infinity]"}]}], ",", "$Failed", ",", 
        RowBox[{
        "ll", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"56191370-5a5c-4a79-824d-374e5cf3bcd1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MutationInterval[g,k,t] gives the time .interval in which mutation k arose.  \
\>", "Subsubsection",ExpressionUUID->"76fc9a52-a3b3-4a57-a7bf-daeed3a6b832"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MutationInterval", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"NodeFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"#2", ",", "2"}], "]"}], "&"}], ")"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"96381e02-7573-46c9-a333-733a6c76368e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MutationInterval", "[", 
    RowBox[{"g_Node", ",", "k_", ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nn", "=", 
        RowBox[{"MutationOrigin", "[", 
         RowBox[{"g", ",", "k", ",", "opts"}], "]"}]}], ",", "an", ",", "t0", 
       ",", "t1", ",", 
       RowBox[{"nf", "=", 
        RowBox[{
         RowBox[{"NodeFunction", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "MutationInterval", "]"}]}]}]}], "}"}], ",", 
     "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nn", "===", "$Failed"}], ",", "$Failed", ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"t0", "=", 
         RowBox[{
          RowBox[{"nf", "[", 
           RowBox[{"nn", ",", 
            RowBox[{"ExtractInformation", "[", 
             RowBox[{"g", ",", "nn"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
           "1", "\[RightDoubleBracket]"}]}], ";", "\n", "\t\t\t", 
        RowBox[{"an", "=", 
         RowBox[{"Ancestors", "[", 
          RowBox[{"g", ",", "nn"}], "]"}]}], ";", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"an", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t0", ",", "\[Infinity]"}], "}"}], ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"t1", "=", 
            RowBox[{
             RowBox[{"nf", "[", 
              RowBox[{
               RowBox[{"Last", "[", "an", "]"}], ",", 
               RowBox[{"ExtractInformation", "[", 
                RowBox[{"g", ",", 
                 RowBox[{"Last", "[", "an", "]"}]}], "]"}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"t0", ",", "t1"}], "}"}]}]}], "]"}]}]}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ceb1486c-466e-45e9-90a6-f2f6014410ad"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ExactProbability[g,\[Theta]] gives the probability of this genealogy, given a \
scaled mutation rate \[Theta]=4N\[VeryThinSpace]\[Mu]. By default, the number \
of mutations is deduced from a list of unique mutations held in the second \
element of the information list.  NodeFunction\[Rule]f uses f[i,info] to find \
the number of mutations. Uses MomentGeneratingFunction[], and so is \
intractable for large numbers of mutations and for large genealogies.  \
ExactProbability[S,\[Theta]] uses the generating function over all topologies \
to find the net probability of the configuration of mutations represented by \
the matrix S.\
\>", "Subsubsection",ExpressionUUID->"2bcb8a99-c7da-4ee3-b31e-77ed72395310"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ExactProbability", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"NodeFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "&"}], ")"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"34181a52-18cb-461a-8780-3ae0bc9818e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExactProbability", "[", 
    RowBox[{"g_Node", ",", "\[Theta]_", ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "mgf", ",", "jl", ",", "\n", "\t\t\t", 
       RowBox[{"nl", "=", 
        RowBox[{"Nodes", "[", "g", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"nf", "=", 
        RowBox[{
         RowBox[{"NodeFunction", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "ExactProbability", "]"}]}]}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"mgf", "=", 
       RowBox[{"MomentGeneratingFunction", "[", 
        RowBox[{"g", ",", "\[Omega]", ",", "\[Theta]"}], "]"}]}], ";", "\n", 
      "\t  ", 
      RowBox[{"jl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NumberOfMutations", "[", 
          RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "nl"}]}], ";", "\n", 
      "\t  ", 
      RowBox[{"jl", "=", 
       RowBox[{"Reverse", "/@", 
        RowBox[{"Sort", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"jl", ",", 
            RowBox[{"\[Omega]", "/@", "nl"}]}], "}"}], "]"}], "]"}]}]}], ";", 
      "\n", "\t\t", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mgf", "=", 
           RowBox[{
            FractionBox[
             RowBox[{"D", "[", 
              RowBox[{"mgf", ",", "#"}], "]"}], 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "!"}]], "/.", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[Rule]", "0"}]}]}], ")"}], "&"}], ",", "jl"}], "]"}], ";", 
      RowBox[{"mgf", "//", "Factor"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c332d824-13b9-467a-ab89-d0bd02a95f87"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExactProbability", "[", 
    RowBox[{"S_List", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "\[Nu]", ",", "mgf", ",", "jl", ",", "rl", ",", "ll", 
       ",", 
       RowBox[{"nl", "=", 
        RowBox[{"Length", "[", "S", "]"}]}], ",", 
       RowBox[{"nm", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", 
       RowBox[{"ff", "=", 
        RowBox[{"Reverse", "[", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"Tally", "[", 
            RowBox[{"Transpose", "[", "S", "]"}], "]"}], "]"}], ",", "2"}], 
         "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"ll", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", "nl", "]"}]}]}], ";", 
      RowBox[{"mgf", "=", 
       RowBox[{"MomentGeneratingFunction", "[", 
        RowBox[{"ll", ",", "\[Omega]", ",", "\[Theta]"}], "]"}]}], ";", 
      RowBox[{"Factor", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"0", "\[Equal]", 
          RowBox[{"Plus", "@@", 
           RowBox[{"Plus", "@@", "S"}]}]}], ",", 
         RowBox[{"mgf", "/.", "\[VeryThinSpace]", 
          RowBox[{
           RowBox[{"\[Omega]", "[", "_", "]"}], "\[RuleDelayed]", "0"}]}], 
         ",", 
         RowBox[{
          RowBox[{"jl", "=", 
           RowBox[{
            RowBox[{"ff", "/.", "\[VeryThinSpace]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i_Integer", ",", "s_List"}], "}"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"\[Nu]", "@@", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"ll", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"s", ",", "1"}], "]"}]}]}]}], "}"}]}]}], "/.", 
            "\[VeryThinSpace]", 
            RowBox[{
             RowBox[{"\[Nu]", "[", "a__List", "]"}], "\[RuleDelayed]", 
             RowBox[{"\[Nu]", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", "a", "}"}], "]"}], "]"}]}]}]}], ";", 
          RowBox[{"jl", "=", 
           RowBox[{"Reverse", "/@", 
            RowBox[{"Sort", "[", "jl", "]"}]}]}], ";", 
          RowBox[{"rl", "=", 
           RowBox[{"jl", "/.", "\[VeryThinSpace]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Nu]", "[", "a_", "]"}], ",", "_"}], "}"}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "a", "]"}], "\[Rule]", 
               RowBox[{"\[Nu]", "[", "a", "]"}]}]}], "}"}]}]}], ";", 
          RowBox[{"mgf", "=", 
           RowBox[{
            RowBox[{"mgf", "/.", "\[VeryThinSpace]", "rl"}], "/.", 
            "\[VeryThinSpace]", 
            RowBox[{
             RowBox[{"\[Omega]", "[", "_", "]"}], "\[RuleDelayed]", "0"}]}]}],
           ";", 
          RowBox[{"Scan", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"mgf", "=", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  SubscriptBox["\[PartialD]", "#1"], "mgf"}], 
                 RowBox[{
                  RowBox[{
                  "#1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "!"}]], "/.", 
                "\[VeryThinSpace]", 
                RowBox[{
                 RowBox[{
                 "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "\[Rule]", "0"}]}]}], ")"}], "&"}], ",", "jl"}], "]"}], ";",
           "mgf"}]}], "]"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"2907b879-6e09-44b0-97fe-5a25e8987f51"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
GenealogyToMatrix[g] gives a matrix whose rows specify which mutations are \
found in which leaf of the genealogy.  By default, the list of mutations is \
taken from the second element of the information list.  NodeFunction\[Rule]f \
uses f[i,info] to specify the mutations in each node.\
\>", "Subsubsection",ExpressionUUID->"53e824c6-a197-4c20-a69b-679b64951a09"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GenealogyToMatrix", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"NodeFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "&"}], ")"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a493837d-b872-4755-83ff-051bb64b6223"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenealogyToMatrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{
       RowBox[{"Node", "[", 
        RowBox[{"_", ",", "_List", ",", "_List"}], "]"}], "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Node", "[", 
          RowBox[{"_", ",", "_List", ",", "_List"}], "]"}], "..."}], 
        "}"}]}]}], ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"ListToMatrix", "[", 
    RowBox[{
     RowBox[{"CollapseGenealogy", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Nested", "\[Rule]", "False"}], ",", 
       RowBox[{"Node", "\[Rule]", "False"}], ",", 
       RowBox[{"NodeFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NodeFunction", "/.", 
           RowBox[{"{", "opts", "}"}]}], "/.", 
          RowBox[{"Options", "[", "GenealogyToMatrix", "]"}]}], ")"}]}]}], 
      "]"}], ",", "opts"}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e308167e-3073-4d11-aafc-8fbdfb639468"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"MatrixToGenealogy", "[", 
     RowBox[{"S", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["leaf", "1"], ",", " ", 
        SubscriptBox["leaf", "2"], ",", "\[Ellipsis]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], ",", "\[Ellipsis]"}], "}"}]}], "]"}], "  ",
     "constructs", " ", "a", " ", "genealogy", " ", "from", " ", "the", " ", 
    "matrix", " ", 
    RowBox[{"S", ".", "  ", "The"}], " ", "leaves", " ", "are", " ", 
    "labelled", " ", "by", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["leaf", "1"], ",", " ", "\[Ellipsis]"}], "}"}], " ", "and",
     " ", "the", " ", "mutations", " ", "by", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Mu]", "1"], ",", "\[Ellipsis]"}], "}"}]}], ";", " ", 
   RowBox[{
   "internal", " ", "nodes", " ", "are", " ", "labelled", " ", "by", " ", 
    "unique", " ", "integers"}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"0e3f0a62-dfc7-4407-8667-430784c7c036"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MatrixToGenealogy", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"Unrooted", "\[Rule]", "False"}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f3dc6311-3b59-4129-a1cf-cc317d237dbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixToGenealogy", "[", 
    RowBox[{"S_List", ",", "ll_List", ",", "ml_List", ",", "opts___Rule"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ValidMatrixQ", "[", 
      RowBox[{"S", ",", "opts"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Unrooted", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "MatrixToGenealogy", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MatrixToUnrootedGenealogy", "[", 
        RowBox[{"S", ",", "ll", ",", "ml"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MatrixToRootedGenealogy", "[", 
        RowBox[{"S", ",", "ll", ",", "ml"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"MatrixToGenealogy", "::", "invalidMatrix"}], ",", "S"}], 
       "]"}], ";", "$Failed"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d6227859-d726-4dab-9243-462557fb9f32"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixToRootedGenealogy", "[", 
    RowBox[{"S_List", ",", "ll_List", ",", "ml_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nl", "=", 
        RowBox[{"Length", "[", "S", "]"}]}], ",", "j", ",", "g", ",", "rtn", 
       ",", "sharedMutations", ",", "nodeCount", ",", 
       RowBox[{"lS", "=", 
        RowBox[{"MatrixToList", "[", 
         RowBox[{"S", ",", 
          RowBox[{"MutationLabels", "\[Rule]", "ml"}]}], "]"}]}]}], "}"}], 
     ",", "\n", "\t", 
     RowBox[{
      RowBox[{"sharedMutations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"ml", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "S", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", "1", ")"}], ".."}], "}"}]}], "]"}]}]}], ";", "\n", 
      "\t", 
      RowBox[{"nodeCount", "=", "2"}], ";", "\n", "\t", 
      RowBox[{"g", "=", 
       RowBox[{"Node", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "sharedMutations"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Node", "[", 
           RowBox[{
            RowBox[{
            "ll", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
              "lS", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "}"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rtn", "=", 
          RowBox[{"FindNode", "[", 
           RowBox[{"g", ",", 
            RowBox[{
            "lS", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",",
             "nodeCount"}], "]"}]}], ";", "\n", "\t\t\t  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"rtn", "===", "$Failed"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"g", "=", "$Failed"}], ";", 
            RowBox[{"Break", "[", "]"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "rtn", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "===", 
                 RowBox[{
                 "rtn", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
              RowBox[{"nodeCount", "+=", "1"}]}], "]"}], ";", "\n", 
            "\t\t\t\t ", 
            RowBox[{"g", "=", 
             RowBox[{"AddGenealogy", "[", 
              RowBox[{"g", ",", 
               RowBox[{"Node", "[", 
                RowBox[{
                 RowBox[{
                 "ll", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
                  ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                   "lS", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", 
               RowBox[{
               "rtn", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "rtn", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                 "rtn", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}]}]}], "]"}]}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", "nl"}], "}"}]}], "]"}], ";", "\n", 
      "\t\t", "g"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"4b31a56c-ff89-4b67-a857-dda9a76f938b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixToGenealogy", "::", "invalidMatrix"}], "=", 
   "\"\<The matrix `1` is not consistent with any genealogy\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0a930faa-a074-404e-8110-326cba15951f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixToGenealogy", "::", "multipleSplit"}], "=", 
   "\"\<Mutation `1` appears to split the genealogy at several nodes.  The \
list of possible nodes, and the current genealogy are `2`, `3`\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"270c9003-e66e-4510-81e5-f6690fe99fa8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixToUnrootedGenealogy", "[", 
    RowBox[{"S_List", ",", "ll_List", ",", "ml_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nl", ",", "mlist", ",", "j", ",", 
       RowBox[{"nleaves", "=", 
        RowBox[{"Length", "[", "S", "]"}]}], ",", 
       RowBox[{"nmutns", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", "rs", ",", "rs2", ",", "vms", ",", 
       RowBox[{"nn", "=", "1"}], ",", "ms1", ",", "ms2", ",", "mm"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nl", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Node", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"{", "}"}]}], "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "&"}], "/@", "ll"}], ",", 
         RowBox[{"Node", "[", 
          RowBox[{"nn", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"{", "}"}]}], "}"}], ",", "ll"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mlist", "=", 
       RowBox[{"MatrixToList", "[", 
        RowBox[{"S", ",", 
         RowBox[{"MutationLabels", "\[Rule]", "ml"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"llist", "=", 
       RowBox[{"MatrixToList", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "S", "]"}], ",", 
         RowBox[{"MutationLabels", "\[Rule]", "ll"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vms", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ml", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}],
          "&"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Range", "[", "nmutns", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
             "llist", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
             "]"}], ">", "1"}], "&"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nl", "=", 
       RowBox[{"AddMutation", "[", 
        RowBox[{"1", ",", "vms", ",", 
         RowBox[{"AddMutation", "[", 
          RowBox[{"ll", ",", "mlist", ",", "nl"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"1", "<", 
           RowBox[{"Length", "[", 
            RowBox[{
            "llist", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            "]"}], "<", 
           RowBox[{"nleaves", "-", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Doing mutation\>\"", ",", "j"}], "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nds", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{"nl", ",", 
              RowBox[{"Node", "[", 
               RowBox[{"_", ",", 
                RowBox[{"{", 
                 RowBox[{"_", ",", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", 
                    RowBox[{
                    "ml", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", "___"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"_", ",", "_", ",", "__"}], "}"}]}], "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<nds=\>\"", ",", "nds"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"rs", "=", 
            RowBox[{"nds", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Node", "[", 
                RowBox[{"nd_", ",", "_", ",", "rs_"}], "]"}], 
               "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rs2", "=", 
                  RowBox[{"Select", "[", 
                   RowBox[{"rs", ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ExtractInformation", "[", 
                    RowBox[{"nl", ",", "#"}], "]"}], "\[LeftDoubleBracket]", 
                    "2", "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "ml", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "]"}], "&"}]}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"nd", ",", "rs2", ",", 
                   RowBox[{"Complement", "[", 
                    RowBox[{"rs", ",", "rs2"}], "]"}]}], "}"}]}], ")"}]}], 
              "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<rs=\>\"", ",", "rs"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"rs", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"rs", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1", "<", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "&&", 
                 RowBox[{"1", "<", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ")"}], "&"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<rs=\>\"", ",", "rs"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "rs", "]"}], ">", "1"}], ",", 
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"MatrixToGenealogy", "::", "multipleSplit"}], ",", 
               RowBox[{
               "ml", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               ",", "rs", ",", "nl"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "rs", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rs", "=", 
                RowBox[{"First", "[", "rs", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<Split at \>\"", ",", "rs"}], "]"}], ";"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"nn", "+=", "1"}], ";", 
               RowBox[{"mm", "=", 
                RowBox[{
                 RowBox[{"ExtractInformation", "[", 
                  RowBox[{"nl", ",", 
                   RowBox[{
                   "rs", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                 "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"nl", "=", 
                RowBox[{"nl", "/.", 
                 RowBox[{
                  RowBox[{"Node", "[", 
                   RowBox[{
                    RowBox[{
                    "rs", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_", ",", "_"}], "]"}], 
                  "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"ms1", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ExtractInformation", "[", 
                    RowBox[{"nl", ",", "#"}], "]"}], "\[LeftDoubleBracket]", 
                    "2", "\[RightDoubleBracket]"}], "&"}], "/@", 
                    RowBox[{
                    "rs", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Node", "[", 
                    RowBox[{
                    RowBox[{
                    "rs", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"ms1", ",", "mm"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    "rs", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "nn"}], "]"}]}], "]"}]}], 
                   ")"}]}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"nl", ",", 
                 RowBox[{
                  RowBox[{"ms2", "=", 
                   RowBox[{"Union", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ExtractInformation", "[", 
                    RowBox[{"nl", ",", "#"}], "]"}], "\[LeftDoubleBracket]", 
                    "2", "\[RightDoubleBracket]"}], "&"}], "/@", 
                    RowBox[{
                    "rs", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Node", "[", 
                   RowBox[{"nn", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"ms2", ",", "mm"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    "rs", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "rs", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"nl", "=", 
                    RowBox[{"nl", "/.", 
                    RowBox[{
                    RowBox[{"Node", "[", 
                    RowBox[{"#", ",", "x_", ",", "y_"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"Node", "[", 
                    RowBox[{"#", ",", "x", ",", 
                    RowBox[{"y", "/.", 
                    RowBox[{
                    RowBox[{
                    "rs", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RuleDelayed]", "nn"}]}]}], 
                    "]"}]}]}]}], ")"}], "&"}], "/@", 
                 RowBox[{
                 "rs", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], ")"}], ";"}], ")"}]}], 
            "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "ml", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "nl"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b42fa9d3-aa1e-4b69-8cb2-611d7668244f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"FindNode", "[", 
     RowBox[{"g", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}], ",", "newNode"}],
      "]"}], " ", "finds", " ", "from", " ", "where", " ", "in", " ", "the", 
    " ", "genealogy", " ", "g", " ", "a", " ", "leaf", " ", "carrying", " ", 
    "mutations", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}], " ", 
    RowBox[{"descends", ".", "  ", "If"}], " ", "no", " ", "node", " ", "or", 
    " ", "branch", " ", "matches"}], ",", " ", 
   RowBox[{"returns", " ", 
    RowBox[{"$Failed", ".", " ", "If"}], " ", "the", " ", "leaf", " ", 
    "joins", " ", "the", " ", "branch", " ", "above", " ", "node", " ", "i"}],
    ",", " ", 
   RowBox[{"returns", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "newNode", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}]}], "}"}]}], ",", 
   " ", 
   RowBox[{
   "where", " ", "newNode", " ", "is", " ", "a", " ", "new", " ", "node", " ",
     "label"}], ",", " ", 
   RowBox[{"distinct", " ", "from", " ", "any", " ", "other", " ", "in", " ", 
    RowBox[{"g", ".", " ", "The"}], " ", "last", " ", "element", " ", "lists",
     " ", "the", " ", "mutations", " ", "carried", " ", "at", " ", "the", " ",
     "new", " ", 
    RowBox[{"node", ".", "  ", "If"}], " ", "the", " ", "leaf", " ", "joins", 
    " ", "at", " ", "node", " ", "i"}], ",", " ", 
   RowBox[{"returns", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "i", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}]}], "}"}]}], ",", 
   " ", 
   RowBox[{
   "where", " ", "the", " ", "last", " ", "element", " ", "lists", " ", "the",
     " ", "mutations", " ", "carried", " ", "at", " ", "node", " ", 
    RowBox[{"i", ".", "    ", "The"}], " ", "new", " ", "leaf", " ", "MUST", 
    " ", "contain", " ", "all", " ", "the", " ", "mutations", " ", "in", " ", 
    "the", " ", "root", " ", "node", " ", "of", " ", 
    RowBox[{"g", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"4b2de436-01d4-489c-b567-6d6c11be8d3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindNode", "[", 
    RowBox[{"g_Node", ",", "leafMutations_List", ",", "newNode_"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nd", "=", 
        RowBox[{"g", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        ",", 
       RowBox[{"oldNd", "=", 
        RowBox[{"g", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        ",", "desc", ",", "nodeMutations", ",", "descendantMutations", ",", 
       "sharedMutations", ",", "lsm", ",", "ps", ",", 
       RowBox[{"rtn", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"rtn", "===", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t  ", 
        RowBox[{
         RowBox[{"desc", "=", 
          RowBox[{"Descendants", "[", 
           RowBox[{"g", ",", "nd"}], "]"}]}], ";", "\n", "       ", 
         RowBox[{"nodeMutations", "=", 
          RowBox[{
           RowBox[{"ExtractInformation", "[", 
            RowBox[{"g", ",", "nd"}], "]"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], ";", "\n", "       ", 
         RowBox[{"descendantMutations", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Complement", "[", 
             RowBox[{"#", ",", "nodeMutations"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ExtractInformation", "[", 
                RowBox[{"g", ",", "#"}], "]"}], "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "&"}], "/@", "desc"}], ")"}]}]}], 
         ";", "\n", "       ", 
         RowBox[{"sharedMutations", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"#", ",", "leafMutations"}], "]"}], "&"}], "/@", 
           "descendantMutations"}]}], ";", "\n", "      ", 
         RowBox[{"lsm", "=", 
          RowBox[{"Length", "/@", "sharedMutations"}]}], ";", "\n", "      ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Complement", "[", 
             RowBox[{"nodeMutations", ",", "leafMutations"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ",", "\n", "\t     ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", "lsm", "]"}], "==", "0"}], ",", "\n", 
             "\t        ", 
             RowBox[{"rtn", "=", 
              RowBox[{"{", 
               RowBox[{"nd", ",", "nd", ",", "nodeMutations"}], "}"}]}], ",", 
             "\n", "\t        ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Max", "[", "lsm", "]"}], "!=", 
                RowBox[{"Plus", "@@", "lsm"}]}], ",", "\n", "\t\t          ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", "lsm", "]"}], "==", 
                  RowBox[{"-", "\[Infinity]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"rtn", "=", 
                  RowBox[{"{", 
                   RowBox[{"nd", ",", "newNode", ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"leafMutations", ",", "nodeMutations"}], "]"}]}], 
                   "}"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<New leaf\>\"", ",", "leafMutations", ",", 
                    "\"\<contains mutations from several branches:\>\"", ",", 
                    "lsm"}], "]"}], ";", "\n", "\t\t         ", 
                  RowBox[{"rtn", "=", "$Failed"}]}]}], "]"}], ",", "\n", 
               "\t\t         ", 
               RowBox[{
                RowBox[{"ps", "=", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"lsm", ",", 
                    RowBox[{"Max", "[", "lsm", "]"}]}], "]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                "\n", "\t\t        ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{
                    "descendantMutations", "\[LeftDoubleBracket]", "ps", 
                    "\[RightDoubleBracket]"}], ",", "leafMutations"}], "]"}], 
                   "===", 
                   RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t          ", 
                  RowBox[{"nd", "=", 
                   RowBox[{
                   "desc", "\[LeftDoubleBracket]", "ps", 
                    "\[RightDoubleBracket]"}]}], ",", "\n", "\t\t\t         ", 
                  RowBox[{"rtn", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "desc", "\[LeftDoubleBracket]", "ps", 
                    "\[RightDoubleBracket]"}], ",", "newNode", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{"nodeMutations", ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"leafMutations", ",", 
                    RowBox[{
                    "descendantMutations", "\[LeftDoubleBracket]", "ps", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], "]"}]}], "]"}], ",", "\n", "\t", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<New leaf\>\"", ",", "leafMutations", ",", 
              "\"\<does not contain all mutations in node \>\"", ",", "nd"}], 
             "]"}], ";", "\n", "\t", 
            RowBox[{"rtn", "=", "$Failed"}]}]}], "]"}]}]}], "]"}], ";", "\n", 
      "\t", "rtn"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b10f2cde-8297-4305-b67e-845779af7f8f"],

Cell["\<\
Choose a node at the top
If new leaf does not contain all mutations at the node and none of the new \
descendant mutations,then
\tif that node is a leaf, make a new node just above; otherwise join the node.
else if new leaf contains some new mutations from several descendant \
branches, FAIL
 \telse if contains ALL mutations from ONE branch, move down & repeat
 \t\telse attach to that branch\
\>", "Text",ExpressionUUID->"0476dfbe-b7d4-48ef-a93a-4c4dd2f25a3f"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"MatrixToList", "[", "S", "]"}], " ", "converts", " ", "a", " ", 
    "matrix", " ", "representation", " ", "to", " ", "a", " ", "list", " ", 
    "of", " ", "the", " ", "mutations", " ", "held", " ", "by", " ", "each", 
    " ", 
    RowBox[{"leaf", ".", "  ", "By"}], " ", "default"}], ",", " ", 
   RowBox[{"mutations", " ", "are", " ", "numbered", " ", "1"}], ",", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"\[Ellipsis]", ".", "  ", "MutationLabels"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}], " ", "uses", " ", 
     "the", " ", "specified", " ", 
     RowBox[{"labels", "."}]}]}]}], TextForm]], "Subsubsection",ExpressionUUID\
->"6bdbd8ed-7c8c-4ba9-9517-6a39c6c78f24"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MatrixToList", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"MutationLabels", "\[Rule]", "Automatic"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b8101019-830d-4360-b4ac-a725b01e08e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixToList", "[", 
    RowBox[{"S_List", ",", "opts___Rule"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"nl", "=", 
        RowBox[{"Length", "[", "S", "]"}]}], ",", 
       RowBox[{"nm", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", "ml"}], "}"}], ",", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ml", "=", 
       RowBox[{
        RowBox[{"MutationLabels", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "MatrixToList", "]"}]}]}], ";", "\n", 
      "\t\t  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ml", "===", "Automatic"}], ",", 
        RowBox[{"ml", "=", 
         RowBox[{"Range", "[", "nm", "]"}]}]}], "]"}], ";", "\n", "\t\t  ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"ml", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
           "S", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
           "1"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nl"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"45260aab-6c67-444b-b983-b3d58f9456a9"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"ListToMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", "4", "}"}], ",", "\[Ellipsis]"}], "}"}], "]"}], " ", 
    "converts", " ", "a", " ", "list", " ", "of", " ", "mutations", " ", 
    "present", " ", "at", " ", "each", " ", "node", " ", "into", " ", "a", 
    " ", "matrix", " ", 
    RowBox[{"representation", ".", "  ", "MutationLabels"}]}], "\[Rule]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "1"], ",", "\[Ellipsis]"}], "}"}], " ", "gives", " ", 
    "the", " ", "columns", " ", "in", " ", "the", " ", "specified", " ", 
    RowBox[{"order", "."}]}]}], TextForm]], "Subsubsection",ExpressionUUID->\
"7eee9ce1-d6cf-48b5-beee-3a988d9cdcc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ListToMatrix", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"MutationLabels", "\[Rule]", "Automatic"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"74a8a056-53d9-4e30-859a-f650d088ac81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ListToMatrix", "[", 
    RowBox[{"z_List", ",", "opts___Rule"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"nl", "=", 
        RowBox[{"Length", "[", "z", "]"}]}], ",", 
       RowBox[{"zl", "=", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", "z", "]"}], "]"}]}]}], "}"}], ",", "\n", 
     "\t\t\t", 
     RowBox[{
      RowBox[{"ml", "=", 
       RowBox[{
        RowBox[{"MutationLabels", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "MatrixToList", "]"}]}]}], ";", "\n", 
      "\t\t  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ml", "===", "Automatic"}], ",", 
        RowBox[{"ml", "=", "zl"}]}], "]"}], ";", "\n", "\t\t  ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "z", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", "#"}], "]"}], ",", "1", ",", "0"}], "]"}], "&"}], "/@", 
         "ml"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nl"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"712cb107-265b-4bce-8421-d31fbc129fcc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
GriffithsTavare[S,\[Theta]] uses the Griffiths-Tavare algorithm to find the \
probability of a configuration of mutations defined by the matrix S.\
\>", "Subsubsection",ExpressionUUID->"5eb1ca23-be45-461a-8780-46975fe0b361"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GriffithsTavare", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"GriffithsTavareFailed", "[", 
    RowBox[{"{", "}"}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"4b17fdfe-78e8-484d-bd02-035de5272b75"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GriffithsTavare", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g1_List", ",", "g2_List"}], "}"}], ",", "\[Theta]_"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{
    RowBox[{"GriffithsTavare", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g1", ",", "g2"}], "}"}], ",", "\[Theta]"}], "]"}], "=", "\n", 
    "\t\t", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a1", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{"g1", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g2"}], ")"}]}], ")"}]}]}], ",", 
        RowBox[{"a2", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{"g2", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g1"}], ")"}]}], ")"}]}]}]}], "}"}], ",", "\n",
       "\t\t", 
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"a1", "+", "a2"}], ",", "a1"}], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Theta]", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Theta]"}], ")"}]}]], ")"}], 
        RowBox[{"a1", "+", "a2"}]], 
       FractionBox["1", 
        RowBox[{"1", "+", "\[Theta]"}]]}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"89eb1956-4f6c-4fdf-bd57-eca0ea94c86f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GriffithsTavare", "[", 
    RowBox[{"S_List", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"OrderedQ", "[", "S", "]"}], "&&", 
      RowBox[{"OrderedQ", "[", 
       RowBox[{"Transpose", "[", "S", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"GriffithsTavare", "[", 
       RowBox[{"S", ",", "\[Theta]"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ",", "ps", ",", "dt", ",", 
          RowBox[{"ff", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Reverse", "[", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"Tally", "[", "S", "]"}], "]"}], ",", "2"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "_"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"n", "=", 
           RowBox[{"Length", "[", "S", "]"}]}], ",", 
          RowBox[{"nm", "=", 
           RowBox[{"Length", "[", 
            RowBox[{
            "S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], ",", "mutationTerms", ",", "coalescenceTerms"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"ps", "=", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Plus", "@@", "S"}], ",", "1"}], "]"}]}], ";", 
         RowBox[{"mutationTerms", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "ps", "]"}], "\[Equal]", "0"}], ",", "0", 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"nm", "\[Equal]", "1"}], ",", 
              RowBox[{"GriffithsTavare", "[", 
               RowBox[{
                RowBox[{"S", "/.", "\[VeryThinSpace]", 
                 RowBox[{"{", 
                  RowBox[{"1", "\[Rule]", "0"}], "}"}]}], ",", "\[Theta]"}], 
               "]"}], ",", 
              RowBox[{
               RowBox[{"dt", "=", 
                RowBox[{"Union", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "S", "]"}], ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], "]"}], "&"}], ")"}], "/@",
                   "ps"}], "]"}]}], ";", 
               RowBox[{"Plus", "@@", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"GriffithsTavare", "[", 
                    RowBox[{"#1", ",", "\[Theta]"}], "]"}], "&"}], ")"}], "/@",
                  "dt"}]}]}]}], "]"}]}], "]"}]}], ";", 
         RowBox[{"coalescenceTerms", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ff", "===", 
             RowBox[{"{", "}"}]}], ",", "0", ",", 
            RowBox[{
             RowBox[{"ff", "=", 
              RowBox[{"Transpose", "[", "ff", "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"First", "[", "ff", "]"}], "]"}], "\[LessEqual]", 
                "1"}], ",", "0", ",", 
               RowBox[{"Plus", "@@", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"#1", " ", 
                    RowBox[{"(", 
                    RowBox[{"#1", "-", "1"}], ")"}]}], ")"}], " ", 
                    RowBox[{"GriffithsTavare", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"S", ",", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"S", ",", "#2"}], "]"}], "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", "\[Theta]"}], "]"}]}], "&"}], ",", "ff"}], 
                 "]"}]}]}], "]"}]}]}], "]"}]}], ";", 
         RowBox[{"\[Lambda]", "=", 
          RowBox[{
           FractionBox["1", "2"], " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{"\[Theta]", "+", "n", "-", "1"}], ")"}]}]}], ";", 
         RowBox[{"Factor", "[", 
          FractionBox[
           RowBox[{
            FractionBox[
             RowBox[{"\[Theta]", " ", "mutationTerms"}], "2"], "+", 
            "coalescenceTerms"}], "\[Lambda]"], "]"}]}]}], "]"}]}], ",", 
     RowBox[{"GriffithsTavare", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Sort", "[", "S", "]"}], "]"}], "]"}], "]"}], ",", 
       "\[Theta]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0ec163c5-9dfc-442f-a8b8-13134f6f97da"],

Cell["\<\
The time taken increases dramatically with the # of genes: for 6 genes, 1.8s, \
for 7 genes too long to wait.  (Though, these timings are somewhat random). \
Presumably Wu (2010) algorithm would be faster. \
\>", "Text",
 CellChangeTimes->{{3.812099825794682*^9, 3.81209989019659*^9}, {
   3.812099923891698*^9, 3.812099934697823*^9}, {3.81210022465495*^9, 
   3.8121002413848763`*^9}, 3.812100326489169*^9, {3.8121006967948217`*^9, 
   3.8121007032474833`*^9}},ExpressionUUID->"13d5ff84-9f31-4381-9e10-\
935cb9644415"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rg", "=", 
   RowBox[{"RandomGenealogy", "[", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "#"], "&"}], ",", "7"}], "]"}], ",", 
     RowBox[{"MutationRate", "\[Rule]", "50"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{"GenealogyToMatrix", "[", "rg", "]"}]}], ";"}], "\n", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"eq", "=", 
    RowBox[{"GriffithsTavare", "[", 
     RowBox[{"mm", ",", "\[Theta]"}], "]"}]}], ";"}], "]"}]}], "Input",
 CellChangeTimes->{{3.812099437056746*^9, 3.812099496190853*^9}, {
   3.8120995837208242`*^9, 3.812099646127344*^9}, 3.8120998480504017`*^9, 
   3.8121002179643183`*^9},ExpressionUUID->"e0c2ec08-7270-42fe-b70b-\
62b1daf2c589"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.808461364295457*^9, {3.808461406382812*^9, 3.808461416144149*^9}, {
   3.812099581537291*^9, 3.812099590475464*^9}, 3.8120998453546267`*^9, 
   3.812100214412093*^9, 3.8121006872039757`*^9, 
   3.844841154641838*^9},ExpressionUUID->"5dca6033-56e8-4fc4-81ff-\
b98149928ee9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"eq", "//", "N"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", "30"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.808461460050395*^9, 3.8084614879084053`*^9}, {
   3.808461519147292*^9, 3.808461560105198*^9}, {3.812099641777074*^9, 
   3.812099642249106*^9}, 
   3.812099875748086*^9},ExpressionUUID->"d46ad067-fd30-4320-9e8b-\
91f439d109e8"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVl3c4F44Tx5EZSkYhZK8QkaTP+Zy9R2VTikK2bMkqQjJLy86ICtlblL35
fFr6JiUVFdlk/Pz+un9e9767557nnvcJ2HuevkRFQUFxhpKC4v9RMHHzcSZf
q8rMgTTpk3tuCtbQSxxyd84iXjyue+k/G3fF1sCSPHHnUuLj0RrtAsLw8Q5Z
byda5xbipvPhE0mN4ie64kd0lpwGiRGUXqwXie7K3crX6345jRNbK4dGDo4m
nuxJHvP+4TRLTMnfpyfKEU6IuZ/WnSo3R6yzMxv/zRhDkHImWsuXzhFjb/mN
FTxNJlyhS756pfgvcS2q4haLQi6B4+0JJlbxeeIB5lP10clFhNqCL+kv8ueJ
RKUmVULtC4KN/y3pU0ILxJLY6+2nVWsJW5oKzXPZC8Q9xkUfZ51eEnI4/jNK
4lsk/pAy6GycbydofIsaP5K+SLyW3LJffk8/4UeljNcg1xKx777Piee7Rwm3
bryl8Ly3RLwocDjzXN07goxpePIejmXicEcJ9+7hccKIkIRgScoyMZUtfVeY
wSTBb2G43JBlhWidcFTe7cVPAuerYPXft1eItUZuVu8F5wgNKUKkeMZVopue
BN843yLhnH3fRanYVeJyX7Wv4vQqgfKo31Iv7RrRuJArojF/i5BHyRftemON
+GbfjbKVeirQHu7Yz0i1TmSVdcXEVlqYzvYsLA5bJ5bO1c32hjBCghenkt7m
OvGrkbu3byQLyGFr18/gf8TG+JuHhOvZgLTXxSp29R/RzFP0Z6vPAQgcZ50W
998g8vvLP2tqPggHSxuCuxY2iOsLSszvzPihOfQio7P3JrFfqi/riKgQXDBi
Tqeb3STSqVkNf7YSBWq+aqlCty0iMwXXxva6BBT+PtekNb1FtLcoK1FmlwG9
JjqjKadtYgKLXrSrpRzIbdsv7Z/bJi4Qg0tDJBQgnt9uQIhAgUP+LFMl5sch
vJVJkBBOgSPhW0uWP5TB177ez/Q1Bc73i3bLf1cB513O3W70lJg/FZB0uEQV
bPM4eKMMKDGr4dzXh+IaYKL5yisjiRKZWndn9H3XAo0pr9dVJErsYaK/MjCn
C0o3+TgHOKnQo1/ZjaRjCFLifa5TtlR40dee8VGwCfB3B7VsZVOhWD1lU9W1
08DmIsZ24BsVFufoL98oMwVaRrLjEYldSD+hbfeZwwLWn0bWa7vvwo/f5ieK
y6zgy+//LgQu7UIr+UUnrRQ7eJNwqyrpBDVqGLQ+jvS8AD1HTjAUXaPGyDDn
jChFB2gemrJtbaXGVB6K7aeHLkG5952y9zQ0uOVGXekn5QQFrGrU87o0eK0k
vO3CucvwsGLWYncCDfoafbb6Xe0KEUt628r7aXGDxjlh0ssLfNNWT5+xpsXh
Q/VsEWPe4Hy8oMA1kxYfGMlbmdn6gEkQpVG6KB0KDD428HjsDxrcpTmVLnSo
IuR1co9rICg12C71ldDhYGhA3iP9YODfrEnfVKRHQ5qPQtTWocCeeWmO4yo9
9gSve8RphAM9kU1DpoUe/eD8WPPlCJgN95g5p82AMf5suaqfrsMXAR5iwC0G
LEl6MM0qEwVv2rpTEgcZ0GmS8cvd+GhophZRfmmxG/POHTmd7B8L5fkjt989
2o0btsr03lS3oEArfGJufDcO6R5/OZQRDwkxYzECzowoKlHW84EyCc4ypbyN
DGRCBmLk+OfOVDB5Tjz8qJEJn//H7l/Zfwc0jH6HVlAwI6X/p5b6sbsglaQj
OhnDjMIVipd9WO7DBtu2r+aDPdh7WIK+8mM6zFU+6zr73x4MWn8vpSecCZNm
1jz+AnuRMf7fJr1vFvTeq3pVULQXSW3uor84cqCfWZGB+iwLDjQxSOZsPoYR
fdb7AyEsWEHPy6BamQfvYv+IPkhnQcXg7r4THvkwSVOoIfORBXft2x5g+VUA
G5sHwi1t9iE/3T7y0T3FIPlnbfmZFSuW9bvavPEqA1mpN1EBQazIratgSJws
A0WXcna1B6xIl+dUPWv5AtSmXI6+fceKh0Op7Oi0ysHq05g7pSUbRnvIe8nI
VELMQNOkmTk7hrVkVP+VqYUEpoc+/P7sWFbzkHWmvBbu6PlTzdxlR+N4ubjH
x+sgq0OGP5zMjpOON/hk1OuhujnLptiUA/cPtKiWXWiEbyURI1un96M07YN2
c+uXoJao+bLQmBOLUkO8KhteQ7heZdGIBycaDjSLrW6/hmYaodTN25w45nep
mkujHZRDKBzP9HGi9Ux8+s/edpC/3MC4rcOFSUffGzq+7wBhdTkLczVu/NXO
bmX0swvst7Iw4gI3TkfmJDFLdkN23R7JZ+HcWPe04ss1l27gkf21QdnCjZfU
ryU5T3cDB29h7vOTBzFVhkFJfKoHaFd4/lAf48ErujVSib19oFF+6+0RUx7s
elIZ7kjbD5Hu6y+tfXjw3CeGfUPYD1tf36aWveDBmoRYCtPKflgZSjlhK8OL
PzgwcfXuAPwopo+qEOPDubg3C2cEhkDUMcDjkxYfdn7tKaU5OQQXBaYsGBz5
MKjXIjDAdAg+33slaZfHh9upZ8oeRA/B+xuhQ7sFDmGO8gP7we9DcOnIOrMc
Mz9eqm6jac8YBoOxm/mcfPwoD4HZIlXDoHCTAyiO8GNyxN9wxb5hoB6XdRs0
4cfHqb15zmvDkJvg1ON+hx+7ejcymExGIE556YJZPj9GPlu4+PviCHhPRa4R
qvmxg/kgT2jQCKBKpjjTO368oKF4uzRnBMZ/k6KLDwrgvpV7I6Z/RqDjgT1f
ipQA0iS2nKqhGIUSzbmqIBBAF5Ynd3tYRyE0g/Gbjp0AFt64LUitOAo8hmrq
33MFkE3tCHd34ChYPSvdFpIUxPEjJumjs6OAlnCP8aQgZucpDJzbHAVx6l6Z
BX1B7B2m5MzaTYJVm6mzbe6CyCjw0BmFSZDGyNt4/oUgsu57/YzFlAShNcVn
dNoEMdWTmWBsR4JLDkozR0YFkSAhT63lQgKFhjPc24uC6KJ8feFsGAlGXeIC
M5SEsNa4IU29gAT1+zlZonSFsHPwnbhJKQly2/IL3ayF0G1A9QZnLQmucLe+
ORkihDkhg4Gfukhg3WHkIXRbCGljKmn+GyKB6pWPNIyZQqhJ1FF/8I4ELD0r
Ch9ahPCfudwrg+87/ftF9bUOCWHhZxFKzT8kGBdgu1g0IYSH9H9NbSySoCRI
JjVwlzA60tIUP6ckQ5pIo+R5dmG8YS4UW0hHhtBh3TZtEWHsqE9hc2Amg6HE
pb/7tYUxjvepggAnGdZv+TX8Zy6Mdb64e5iHDE/+REXlOQrjGJ+ChYEAGagr
C7iORgtj7nQ0TaEEGcr313xdvSuMWdS1KjelyWAX1Pm8JV8YZfo/ZirIkaFe
5YeqYbswmkQtRq0eJ4NzziojO1kYY0Q1pvaeJAMHNcObD5M79e/I8y8DGdoc
ubJzFoXRvaY6+ymSwatbwsWZWgSNpoZJsupk6E3Q21oSEsGYm3uZnmmTQdTU
NeW6ugj2HfKVcdUnQ+rlP1/qWkVQ/vXXxdNnyEAR5i0/RxTFrq75+zEmZLDR
SOm8ZieKv14e1lY3IkM1Q4UNY5gozgQMBTrs5O8bHJ29nymKKxH53r929N3u
LF4XbRZF50p1z4md+twr1Ea/+0VRNMHCO1+VDJ1WHJyV/4nivEHTE00iGQQP
KT5T3RTFeF5dIx5lMgxFaPnTM4shrVtF9Jmd+UMnzXGQRwyzIxdinBXI8L4o
gGRLEMNv06bB0jJkiGaKyRQyEENJk9kjnyTJoOB533naRgx3VxkSPMTIkKRQ
txFwVQwNZTs/S/OTQatlXTi1Xgylz1fPHmMhw6IA46xVjxhK8a0vzTCSIefG
wTr+D2KoTa9kemNn/xu6BMOStR296cWEs1skKCdd8+tWEsc0PSXuxmkSPIm6
aP9FVxxvkL6+5ftGgkxFfeN/1uL4UbBPzH6cBHH3OSWkr4kj2WNNLX6UBA62
FR+TWsUxe1fBg+B6ErBP/lC31JNAyZc8RXzXSbD77qCst40E+qoVTjRdJQGF
VjVvnJsEmv89YKfhS4JfhddXGhIkUHx6u4b+EgnaXfmeHhqVQKaq3xlBmiTw
XzjD+t1GEvXz/c2NqUjglqe8ve0miZ+5I6YT10bB3kzgF2eoJEYJCGc1zY2C
Uc2fdr1sSdQcmn418WkUxK7GBpVMSiJPZ5Sqef0ovKNq+eznfhjJNM9Sj3uM
wklWyVLqMCl8Z6ai/6d3BAYorbv7E6XQlpjlm946Auf/xn5Ny5ZCTVkHe9Wa
Ebgx9POARJsUHjhl4OeVu8MnFIUb0kijcQ1T4+XAHZ5R4nTaLWns+xH0ZlVw
h6cWXxK7L4MuIpkffvoMg9O/lIx8S1nUS3z/2njPEHh2fJcvNTyKVKrEhGr6
XoizphXZdFPAa1MOxT94O0BFlmn5p68CCstmF24ydcBfGtbONyEKKHAn8Bnv
RjtYvuC9XBavgDluIyOhH9pBhP7Yc4dnCshSUlvRfq8dXlY5HOuZUUCDA34u
juztsMzSqnnP5RhqHcwYnOd4DQ6dVx3lnBUxWcvhz/iJNrhIEDVa9lREqX14
YfVwGzi+GDrWEKCI7PV+dAf52sD5kQiN5k1FLJUq/RRK1QYenoOPLQsU8dM1
Gf2Xva0QfEBoImxSEZV2qSeKnm+FFKcem4Hzx3F/229r+6SX0ErHdcrVSgm/
K/K9YD/YDFOPZfTeX1DCHO2GJGGqZmBCDXVtFyW8la+SpfuzCSwDPY8JXVXC
Y+Js+0ZrmmD2RzvXWLoSnqAWbZkwawLenitf9D4roZyK7vTE3UYIiu/zkXQ6
gaTekQoGkQaQ2xee9tNXGbsd57VHQmqhnv6teGeIMt6LsVxnd6kFNQqZhrwb
ysjZWEDlZFELprNj43Z3lNFeneG70tFa8O8/LvGmQhm3L243pfyogcbY2Ya2
eWW8emzmCbtlDehQ2U088jqJAXc/nadSq4bzCyBl5EbAqrfyTQeJlcDMSjFE
8iWg6rF7H+7s+KN62TYfm2sENLt39jUPXyWwe2g1OCcQMABfd1luVkDXDyO9
62UE7I3IEg9vrADZT3bOtYsELLBQ2wyHCqDojsgTvAZIL58UNq9bDjmZ7Twr
t1Vw9Njfit+xZZBuK/XWLE0Fc54bMS2HlMF97tTkykwV/LcQ2saw4+8S0s7T
XilVwUCnQ4fOmJdBcMK/2V9DOzxLdrCbUBmcDpV79YWNiM3WFC0XwkqB+lzG
5YEHRNwbsHzJn6IEKhKUx0ZOI2LH9IvbKk/B/tEemnpzRB71ZgWew0+B9ckX
mRxrRJrzk571B56CV2tcpKc9osmB3e9F/haD1OIHCaYriAqqVlvVecWQZ3U1
UDMZkbvLabl6x4/eEW7kqB1EjOO2nBr5/QR868Ekw0AVpTdt1zrJBVBl3Un1
3kQVNQ0OLcW8LoDldZMqdjNVDBRzJltWFEDQyYvc8WdVcexXN6NIcgGENsZN
BnuoYr+caZ+7YQHcbH4baJmkitNkh6eVXfnwsM07h42kiksRf5fqu/OgpSd/
PtZGDacTZlOn53OhnHPI+5qdGm5N3Bmb+ZYLeY7rc14OasiWPe+08i4X4qiM
Zy1c1ZBFWfywdEsumCqvzohcVUPJNl8H1vhcmC7S+9b6UA1/sF9bahDLBfbY
2bdr79UwVATpTRxz4LL2iabLlupI5uQK89zMgj/iXO0vbNWRK5dGQncqC67s
XutbO6+OLZf3EBQHsyCkv/Zj7GV15BWRNdPLyYKkM0obRcHqeLy87qylVhZU
2x0/OZ2ujtcnek5tpGYCVeCxOpcJdTxHzfdohpAB6U/kqlxdNHCpWZL/Y+tD
6Hrv0JXloYHGD5l/O5Q+hMXdaWOjVzRQeXwieT39Iei7r1MSrmpgSvCatGng
Q1iXe2XEFK+BY44LhJojD8GqwfTHs+caKHTBQkcu5wHsHwg4+GdOA7PNjBTS
E+5D8kJThFeAJi6uGuk8T0oDj5GkC7ZXNZF78YXu7cg0MHjhoKoTpokmrgXZ
Ab5pQOvJQMl/UxPHuY5Lu1qmQci0afhgmiaKC+iS+vjTwHFiJlSmWhNL07yZ
fSruAmGQK+TXoibefWesw/r5DkwV+/k7X9FC5SyFDzOmqWDOu/Xpib8Wim9z
s4vopEJ7YrT2z2AtvFU9L+98MhXyfO9xulzXwqLkDiomwVSwV6mrd72jhTSn
qX91zabAp+GNLY9qLWxe+hnGcjsFyKvXb/qta2Fu9OXp9IFkeK2Vcj8yUhvF
2o7ULbkmwTfHhv7gaG1czsWNg/ZJQHtzksonThv9BIhyupZJoNOp6O6Qoo2v
JbqsazWSoE97TFUjVxufEH32/eRNglEd4RmaNm2UkS1P4nucCF/0qiGWUgeT
ejJsU68mAKXxhy+J4Tp49ildVM2peKBQrabMDtLFO9pe1XF3YiDmwIrhyE29
nX8t3Z9RMgq8rB3aVq7rI+P6bOh4YCRMRChcJN41QALdUe7m7TBgT33wITbH
EOP2XiWVfr0KBSySQZ2PjDDZkstqb3ogtF45pCn21BipH89N3k3wg0z+bB4w
NUGhaDYh5oM+0BSyTuE8ZIIXxA/1pFF7g4A+3YaQxSkMXxp9WcTtAZWDErfe
k06hnq6No/C0C8R3bMnynz29c98DCzKmnCDV56fL+Y+nceFEnnqY9yUI4eDb
K2h1BpeoTGKPnnaAIgmaHt/PZ1DoundKm/4FoF2k5Go9Z4rF5k68ZDU7KJR9
EZr53RRf0J9domKzBQn7YqNNdzM0p22W+WhiBWO6deVmM2a4NnGo8wmdBYw8
DpYm+phjFX3ilbURU1itOEUQnDfH5WKHRsXN07Bde6Uq2sMC8/YVqM3anQJ9
WS3NkCULnL1tef9kujF0nj1y2dXHEn2EPqQF/TMA4ZiV9c0blvhZ+tMzqscG
EF7eEp+UZomkEw9n+vUNQJnOpKyqzhIPq2/Wc+Towz05TjWdXkscYy1fvmmo
D4s2n0c/fLRE5kypMrF/enAq+skl9z+WuK3bsTZbpAclZV4r29uWGBeusTlm
pQf/AxaJq40=
       "]]},
     Annotation[#, "Charting`Private`Tag$831441#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 100}, {0., 7.758166090668037*^-11}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8084614235915947`*^9, {3.808461485390112*^9, 3.808461560686661*^9}, 
   3.8120995993496847`*^9},ExpressionUUID->"3bb9f179-8b0f-49f1-aff6-\
761c362f9f44"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MonteCarloGriffithsTavare[S,\[Theta]] uses the Monte-Carlo Griffiths-Tavare \
algorithm to find the probability of a configuration of mutations defined by \
the matrix S.\
\>", "Subsubsection",ExpressionUUID->"23bfa60f-9fcd-4415-ac7d-138a47a5c30d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MonteCarloGriffithsTavare", "[", 
    RowBox[{"S_List", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pr", "=", "1"}], ",", 
       RowBox[{"nS", "=", "S"}], ",", "n", ",", "ps", ",", "J", ",", "K", ",", 
       RowBox[{"nm", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"nS", "===", 
          RowBox[{"{", 
           RowBox[{"{", "0", "}"}], "}"}]}]}], ",", 
        RowBox[{
         RowBox[{"st", "=", 
          RowBox[{"Transpose", "[", "nS", "]"}]}], ";", 
         RowBox[{"ust", "=", 
          RowBox[{"Union", "[", "st", "]"}]}], ";", 
         RowBox[{"ps", "=", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Plus", "@@", 
             RowBox[{"Transpose", "[", "ust", "]"}]}], ",", "1"}], "]"}]}], 
         ";", 
         RowBox[{"J", "=", 
          RowBox[{"Length", "[", "ps", "]"}]}], ";", 
         RowBox[{"ff", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Reverse", "[", 
             RowBox[{
              RowBox[{"Sort", "[", 
               RowBox[{"Tally", "[", "nS", "]"}], "]"}], ",", "2"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "_"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"K", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ff", "===", 
             RowBox[{"{", "}"}]}], ",", "0", ",", 
            RowBox[{
             RowBox[{"fft", "=", 
              RowBox[{"Transpose", "[", "ff", "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"First", "[", "fft", "]"}], "]"}], "\[LessEqual]", 
                "1"}], ",", "0", ",", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{
                 RowBox[{
                 "fft", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ".", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "fft", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}]}], 
              "]"}]}]}], "]"}]}], ";", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "nS", "]"}]}], ";", 
         RowBox[{"nS", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RandomReal", "[", "]"}], "<", 
             FractionBox[
              RowBox[{"J", " ", "\[Phi]"}], 
              RowBox[{
               RowBox[{"J", " ", "\[Phi]"}], "+", 
               RowBox[{"2", " ", "K"}]}]]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{
                "nS", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "]"}], "\[Equal]", "1"}], ",", 
              RowBox[{"nS", "/.", "\[VeryThinSpace]", 
               RowBox[{"{", 
                RowBox[{"1", "\[Rule]", "0"}], "}"}]}], ",", 
              RowBox[{
               RowBox[{"rj", "=", 
                RowBox[{"ps", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"RandomInteger", "[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "J"}], "}"}], "]"}], ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Delete", "[", 
                 RowBox[{"st", ",", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"st", ",", 
                    RowBox[{
                    "ust", "\[LeftDoubleBracket]", "rj", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                   "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                 "]"}], "]"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"rk", "=", 
              RowBox[{"RandomList", "[", 
               RowBox[{"1", ",", 
                FractionBox[
                 RowBox[{
                  RowBox[{
                  "fft", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "fft", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}], 
                 RowBox[{"2", " ", "K"}]]}], "]"}]}], ";", 
             RowBox[{"Delete", "[", 
              RowBox[{"nS", ",", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"nS", ",", 
                  RowBox[{"fft", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                 "]"}], "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
              "]"}]}]}], "]"}]}], ";", 
         RowBox[{"pr", "*=", 
          FractionBox[
           RowBox[{
            RowBox[{"J", " ", "\[Phi]"}], "+", 
            RowBox[{"2", " ", "K"}]}], 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{"\[Theta]", "+", "n", "-", "1"}], ")"}]}]]}]}]}], "]"}], 
      ";", 
      RowBox[{"pr", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Theta]", "\[Phi]"], ")"}], "nm"]}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9e2da1b8-349f-43ce-92dc-da1644c141ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MonteCarloGriffithsTavare", "[", 
    RowBox[{"S_List", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"MonteCarloGriffithsTavare", "[", 
    RowBox[{"S", ",", "\[Theta]", ",", "\[Theta]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"1b679468-2f93-4110-8386-aedc6f5f6767"]
}, Closed]],

Cell[CellGroupData[{

Cell["ValidMatrixQ", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"b68c8215-25b6-4619-8391-2fce65e0d34b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ValidMatrixQ", "::", "notTensor"}], "=", 
   "\"\<ValidMatrixQ[`1`] should have as an argument a tensor of rank 2, \
containing 0 or 1\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f8a3baef-20bc-4a10-a0ad-b86987430ee6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ValidMatrixQ", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"Unrooted", "\[Rule]", " ", "False"}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"84a3fea9-7535-432f-9ff6-62599209cfa6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ValidMatrixQ", "[", 
    RowBox[{
     RowBox[{"S", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0", "|", "1"}], ")"}], "..."}], "}"}], "..."}], "}"}]}], 
     ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tS", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatrixQ", "[", "S", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "S", "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "<", "2"}], ",", 
         "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tS", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Transpose", "[", "S", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Unrooted", "/.", 
              RowBox[{"{", "opts", "}"}]}], "/.", 
             RowBox[{"Options", "[", "ValidMatrixQ", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ValidMatrixQ", "[", 
                 RowBox[{"0", ",", "0"}], "]"}], "[", "tS", "]"}], 
               RowBox[{
                RowBox[{"ValidMatrixQ", "[", 
                 RowBox[{"1", ",", "0"}], "]"}], "[", "tS", "]"}], 
               RowBox[{
                RowBox[{"ValidMatrixQ", "[", 
                 RowBox[{"0", ",", "1"}], "]"}], "[", "tS", "]"}], 
               RowBox[{
                RowBox[{"ValidMatrixQ", "[", 
                 RowBox[{"1", ",", "1"}], "]"}], "[", "tS", "]"}]}], "]"}], 
             "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ValidMatrixQ", "[", 
                 RowBox[{"1", ",", "0"}], "]"}], "[", "tS", "]"}], 
               RowBox[{
                RowBox[{"ValidMatrixQ", "[", 
                 RowBox[{"0", ",", "1"}], "]"}], "[", "tS", "]"}], 
               RowBox[{
                RowBox[{"ValidMatrixQ", "[", 
                 RowBox[{"1", ",", "1"}], "]"}], "[", "tS", "]"}]}], "]"}], 
             "\[Equal]", "0"}]}], "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"ValidMatrixQ", "::", "notTensor"}], ",", "S"}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"119d8e71-d0a9-4520-8596-1331878256b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ValidMatrixQ", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"tS", ",", "_Integer", ",", "2"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "tS", ",", "tS", ",", "1"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}]}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ValidMatrixQ", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"tS", ",", "_Integer", ",", "2"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"1", "-", "tS"}], ",", "tS", ",", "1"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}]}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ValidMatrixQ", "[", 
    RowBox[{"1", ",", "0"}], "]"}], "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"tS", ",", "_Integer", ",", "2"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "tS", ",", 
             RowBox[{"1", "-", "tS"}], ",", "1"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}]}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ValidMatrixQ", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"tS", ",", "_Integer", ",", "2"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"1", "-", "tS"}], ",", 
             RowBox[{"1", "-", "tS"}], ",", "1"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}]}], ")"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"111b32e6-6aa9-433c-a2f6-ee5f48e89d5e"]
}, Closed]],

Cell[CellGroupData[{

Cell["SwapStates", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"166a9ee4-0935-4774-a0e5-009ec02420ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SwapStates", "[", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0", "|", "1"}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"S", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0", "|", "1"}], ")"}], "..."}], "}"}], "..."}], "}"}]}]}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"s", "+", 
       RowBox[{"#", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", "s"}]}], ")"}]}]}], ")"}], "&"}], "/@", "S"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9d8ff394-8a2f-4508-8255-0241deabfb7d"]
}, Closed]],

Cell[CellGroupData[{

Cell["MissingCombination", "Subsubsection",ExpressionUUID->"cd0bd05a-d338-4dfe-8950-9e2969f5c033"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MissingCombination", "::", "invalidMatrix"}], "=", 
   "\"\<The matrix is not consistent with any genealogy: `1`\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0fb991be-8b66-4037-9a8e-1ceddd91877d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MissingCombination", "[", 
    RowBox[{"S", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0", "|", "1"}], ")"}], "..."}], "}"}], "..."}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"MissingCombination", "[", "S", "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ut", ",", 
        RowBox[{"tS", "=", 
         RowBox[{"Transpose", "[", "S", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Outer", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ut", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", "##", "}"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"Length", "[", "ut", "]"}], ",", "\[IndentingNewLine]", 
             "4", ",", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{"MissingCombination", "::", "invalidMatrix"}], ",", 
                "S"}], "]"}], ";", "$Failed"}], ",", "\[IndentingNewLine]", 
             "3", ",", 
             RowBox[{
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "ut"}], 
               "]"}], "//", "First"}], ",", "\[IndentingNewLine]", "_", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ")"}], "&"}], ",", "tS", ",", 
        "tS", ",", "1"}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"de9593b2-b9af-4ffd-b45f-a144ace419d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["PossibleRootings", "Subsubsection",ExpressionUUID->"9e646978-0561-4f41-8a84-5cf9086cabfd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PossibleRootings", "[", 
    RowBox[{
     RowBox[{"x_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ListQ", "[", "#", "]"}], "&&", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"#", ",", " ", "Null"}], "]"}]}], ")"}], "&"}], ")"}]}], 
     ",", 
     RowBox[{"S", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0", "|", "1", "|", "Null"}], ")"}], "..."}], "}"}], 
        "..."}], "}"}]}]}], "]"}], ":=", "x"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PossibleRootings", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a___List", ",", 
       RowBox[{"{", 
        RowBox[{"c___", ",", "Null", ",", "d___"}], "}"}], ",", "b___List"}], 
      "}"}], ",", 
     RowBox[{"S", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0", "|", "1", "|", "Null"}], ")"}], "..."}], "}"}], 
        "..."}], "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "\[Alpha]", ",", "\[Beta]", ",", 
       RowBox[{"nl", "=", 
        RowBox[{"Length", "[", "S", "]"}]}], ",", 
       RowBox[{"nm", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"tS", "=", 
        RowBox[{"Transpose", "[", "S", "]"}]}], ",", "miss", ",", "ut", ",", 
       RowBox[{"j", "=", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "c", "}"}], "]"}], "+", "1"}]}], ",", 
       RowBox[{"cd", "=", 
        RowBox[{"{", 
         RowBox[{"c", ",", "Null", ",", "d"}], "}"}]}], ",", "t0", ",", "t1", 
       ",", 
       RowBox[{"t0Q", "=", "True"}], ",", 
       RowBox[{"t1Q", "=", "True"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"miss", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"MissingCombination", "[", "S", "]"}], "]"}], 
        "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Alpha]", "\[Equal]", "j"}], ",", "\[IndentingNewLine]", 
           "0", ",", "\[IndentingNewLine]", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{
             "cd", "\[LeftDoubleBracket]", "\[Alpha]", 
              "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", "Null", 
             ",", 
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{
               "miss", "\[LeftDoubleBracket]", "\[Alpha]", 
                "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", "0", ",", 
               "\[IndentingNewLine]", "_", ",", "Null"}], "]"}], ",", 
             "\[IndentingNewLine]", "0", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "miss", "\[LeftDoubleBracket]", "\[Alpha]", 
                  "\[RightDoubleBracket]"}], "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                RowBox[{"t0Q", "=", "False"}]}], "]"}], ";", "0"}], ",", 
             "\[IndentingNewLine]", "1", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "miss", "\[LeftDoubleBracket]", "\[Alpha]", 
                  "\[RightDoubleBracket]"}], "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], ",", 
                RowBox[{"t0Q", "=", "False"}]}], "]"}], ";", "1"}]}], "]"}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "nm"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Alpha]", "\[Equal]", "j"}], ",", "\[IndentingNewLine]", 
           "1", ",", "\[IndentingNewLine]", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{
             "cd", "\[LeftDoubleBracket]", "\[Alpha]", 
              "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", "Null", 
             ",", 
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{
               "miss", "\[LeftDoubleBracket]", "\[Alpha]", 
                "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", "1", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", "0", ",", 
               "\[IndentingNewLine]", "_", ",", "Null"}], "]"}], ",", 
             "\[IndentingNewLine]", "0", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "miss", "\[LeftDoubleBracket]", "\[Alpha]", 
                  "\[RightDoubleBracket]"}], "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], ",", 
                RowBox[{"t1Q", "=", "False"}]}], "]"}], ";", "0"}], ",", 
             "\[IndentingNewLine]", "1", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "miss", "\[LeftDoubleBracket]", "\[Alpha]", 
                  "\[RightDoubleBracket]"}], "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}], ",", 
                RowBox[{"t1Q", "=", "False"}]}], "]"}], ";", "1"}]}], "]"}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "nm"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"t0Q", ",", 
        RowBox[{"If", "[", 
         RowBox[{"t1Q", ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "t0", ",", "t1", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "t0", ",", "b"}], "}"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"t1Q", ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "t1", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"2682b300-6b9f-4d1e-b2e1-32d05945d990"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PossibleRootings", "[", 
    RowBox[{"S", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0", "|", "1", "|", "Null"}], ")"}], "..."}], "}"}], 
       "..."}], "}"}]}], "]"}], ":=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PossibleRootings", "[", 
       RowBox[{"#", ",", "S"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{"Null", "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", 
          RowBox[{"S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}], "}"}]}], "]"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f60623ef-b804-425b-a02c-fa3c2dd6baad"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddMutation", "Subsubsection",ExpressionUUID->"3f91b55d-8ed7-4eed-8994-ed6c1bbdaf29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddMutation", "::", "invalidLists"}], "=", 
   "\"\<The lists of nodes `1` and of mutations `2` are not \
compatible.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a3212995-1950-41e4-8140-793ddc942ec4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddMutation", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"m_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
     RowBox[{"g", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Node", "[", 
         RowBox[{"_", ",", "_List", ",", 
          RowBox[{"{", "___Node", "}"}]}], "]"}], "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Node", "[", 
           RowBox[{"_", ",", "_List", ",", "_List"}], "]"}], "..."}], "}"}]}],
        ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"g", "/.", 
    RowBox[{
     RowBox[{"Node", "[", 
      RowBox[{"n", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_List", ",", "z___"}], "}"}], ",", "d_List"}], 
      "]"}], "\[RuleDelayed]", 
     RowBox[{"Node", "[", 
      RowBox[{"n", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"y", ",", "m"}], "]"}], ",", "z"}], "}"}], ",", "d"}], 
      "]"}]}]}]}], ";", 
  RowBox[{
   RowBox[{"AddMutation", "[", 
    RowBox[{"n_", ",", "m_List", ",", 
     RowBox[{"g", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Node", "[", 
         RowBox[{"_", ",", "_List", ",", 
          RowBox[{"{", "___Node", "}"}]}], "]"}], "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Node", "[", 
           RowBox[{"_", ",", "_List", ",", "_List"}], "]"}], "..."}], "}"}]}],
        ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"g", "/.", 
    RowBox[{
     RowBox[{"Node", "[", 
      RowBox[{"n", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_List", ",", "z___"}], "}"}], ",", "d_List"}], 
      "]"}], "\[RuleDelayed]", 
     RowBox[{"Node", "[", 
      RowBox[{"n", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Join", "[", 
          RowBox[{"y", ",", "m"}], "]"}], ",", "z"}], "}"}], ",", "d"}], 
      "]"}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7653620919327106`*^9, {3.76536231446682*^9, 
   3.765362318241866*^9}},ExpressionUUID->"0d301402-bfa2-4c83-b295-\
bf3cfaa9fbfa"],

Cell["\<\
This is commented out, because I need to be able to represent nodes as lists \
- which the old version would not allow.\
\>", "Text",
 CellChangeTimes->{{3.7653622760921*^9, 
  3.7653623062817907`*^9}},ExpressionUUID->"641adc8b-3619-4fa8-8b7a-\
8aeffccb4281"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"AddMutation", "[", 
     RowBox[{"n_List", ",", "m_List", ",", 
      RowBox[{"g", ":", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Node", "[", 
          RowBox[{"_", ",", "_List", ",", 
           RowBox[{"{", "___Node", "}"}]}], "]"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Node", "[", 
            RowBox[{"_", ",", "_List", ",", "_List"}], "]"}], "..."}], 
          "}"}]}], ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "n", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", "m", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AddMutation", "[", 
          RowBox[{
           RowBox[{
           "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           "#1"}], "]"}], "&"}], ",", "g", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"n", ",", "m"}], "}"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"AddMutation", "::", "invalidLists"}], ",", "n", ",", "m"}], 
       "]"}]}], "]"}]}], ";"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.765362270752281*^9},ExpressionUUID->"be5c4990-a214-4e13-827d-\
51744fc88877"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CondenseMatrix", "Subsubsection",ExpressionUUID->"e51fecb8-4278-4f58-8b68-faa74910b137"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CondenseMatrix", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"Unrooted", "\[Rule]", "False"}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c6832a87-0400-4fe6-9095-94152856ae38"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CondenseMatrix", "::", "notMatrix"}], "=", 
   "\"\<`1` is not a matrix\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"52f81475-1d95-4fad-a8e5-28c7c5f2a2e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CondenseMatrix", "[", 
    RowBox[{
     RowBox[{"S", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0", "|", "1"}], ")"}], "..."}], "}"}], "..."}], "}"}]}], 
     ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MatrixQ", "[", "S", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tSR", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Unrooted", "/.", 
           RowBox[{"{", "opts", "}"}]}], "/.", 
          RowBox[{"Options", "[", "CondenseMatrix", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tSR", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Transpose", "[", "S", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", " ", "..."}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"1", " ", "..."}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"0", " ", "..."}], " ", ",", "1", ",", 
                RowBox[{"0", " ", "..."}]}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", " ", "..."}], " ", ",", "0", ",", 
                RowBox[{"1", " ", "..."}]}], "}"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Union", "[", 
            RowBox[{"tSR", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", ":", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"0", "|", "1"}], ")"}], "..."}], "}"}]}], 
               "\[RuleDelayed]", 
               RowBox[{"First", "[", 
                RowBox[{"Sort", "[", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", 
                   RowBox[{"1", "-", "x"}]}], "}"}], "]"}], "]"}]}], "}"}]}], 
            "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Transpose", "[", "S", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", " ", "..."}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"1", " ", "..."}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", " ", "..."}], " ", ",", "1", ",", 
               RowBox[{"0", " ", "..."}]}], "}"}]}]}], "]"}], "]"}]}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"CondenseMatrix", "::", "notMatrix"}], ",", "S"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"09746210-a8d9-4798-ad0c-60ccc1862098"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Recombination", "Subsection",ExpressionUUID->"3990334a-b03e-4d36-9685-7b6399ce383b"],

Cell[CellGroupData[{

Cell["AncestralGraphPattern", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"73070880-69ca-433d-a73d-24ab6bcc9db6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AncestralGraphPattern", "=", 
   RowBox[{"{", 
    RowBox[{"AncestralLineagePattern", "..."}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"3db72879-79fa-40ec-9b52-061a3ebd90e1"]
}, Closed]],

Cell[CellGroupData[{

Cell["AncestralLineagePattern", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"861ef71b-2877-40e3-8c9b-27e68d627490"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AncestralLineagePattern", "=", 
   RowBox[{"AncestralLineage", "[", 
    RowBox[{"_", ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_"}], "}"}], ",", "_List", ",", "_List", ",", 
     RowBox[{"{", "___List", "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ab7f946a-14a3-444e-884b-95c5f7d2b141"]
}, Closed]],

Cell[CellGroupData[{

Cell["Junctions", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"7cafd86e-0ec3-4f82-8e57-08832bb98959"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Junctions", "[", 
    RowBox[{"AncestralLineage", "[", 
     RowBox[{"_", ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], ",", "_List", ",", "j_List", ",", 
      "_List"}], "]"}], "]"}], ":=", 
   RowBox[{"Drop", "[", 
    RowBox[{"j", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Junctions", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Junctions", "/@", "g"}], "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"fe86d7d2-d5d5-4e4d-8997-3840ffa8a69d"]
}, Closed]],

Cell[CellGroupData[{

Cell["MapLength", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"b57b5269-5781-47ba-934f-c00ae992771c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MapLength", "::", "mixedLengths"}], "=", 
   "\"\<The map lengths `1` differ among lineages\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"33a3d2b8-b8d4-4019-9cbc-f6a798e257d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MapLength", "[", 
    RowBox[{"AncestralLineage", "[", 
     RowBox[{"_", ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], ",", "_List", ",", "j_List", ",", 
      "_List"}], "]"}], "]"}], ":=", 
   RowBox[{"Last", "[", "j", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapLength", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ml", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"MapLength", "/@", "g"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "ml", "]"}], ">", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"MapLength", "::", "mixedLengths"}], ",", "ml"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "ml", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"5d1d89fe-5836-49d3-956a-5242f9df3a52"]
}, Closed]],

Cell[CellGroupData[{

Cell["TimesOfEvents", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"650af564-305a-483d-b767-bcf756b05599"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TimesOfEvents", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"g", "/.", 
      RowBox[{
       RowBox[{"AncestralLineage", "[", 
        RowBox[{"_", ",", 
         RowBox[{"{", 
          RowBox[{"t0_", ",", "t1_"}], "}"}], ",", "_List", ",", "_List", ",",
          "_List"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{"t0", ",", "t1"}], "}"}]}]}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"4c68f802-37bc-4067-ae42-fffee0512073"]
}, Closed]],

Cell[CellGroupData[{

Cell["AllEvents", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"7569b117-f2a0-4de4-a873-94a26e87a46f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AllEvents", "::", "badJunctions"}], "=", 
   "\"\<The junctions at the recombination event at t=`1` in graph `2` do not \
change by 1.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b7003a7f-13ff-43a8-b6e2-9d80702de971"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AllEvents", "::", "badRelationship"}], "=", 
   "\"\<The event at t=`1` in graph `2` does not have the right form.\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a5e8cf64-ed0c-4902-a667-aae549f35d2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AllEvents", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AllEvents", "[", "g", "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cs", ",", "ce", ",", "jj"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"cs", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"g", ",", 
             RowBox[{"AncestralLineage", "[", 
              RowBox[{"_", ",", 
               RowBox[{"{", 
                RowBox[{"#", ",", "_"}], "}"}], ",", "_List", ",", "_List", 
               ",", "_List"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ce", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"g", ",", 
             RowBox[{"AncestralLineage", "[", 
              RowBox[{"_", ",", 
               RowBox[{"{", 
                RowBox[{"_", ",", "#"}], "}"}], ",", "_List", ",", "_List", 
               ",", "_List"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"ce", ",", "cs"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "_"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"_", ",", "0"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"ce", "/.", "ExtractLabel"}], ",", 
              RowBox[{"cs", "/.", "ExtractLabel"}], ",", "None"}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"jj", "=", 
              RowBox[{"TakeAway", "[", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"cs", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"cs", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}]}], 
                 "]"}], ",", 
                RowBox[{"ce", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"If", "[", "\[InvisibleSpace]", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{"jj", ",", 
                    RowBox[{"{", 
                    RowBox[{"x_", ",", "x_", ",", "1"}], "}"}]}], "]"}], "||", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cs", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"cs", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], "]"}], "===", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "}"}], "}"}], ",", 
                    RowBox[{"ce", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], "]"}]}], ")"}]}], ")"}]}], ",", 
                RowBox[{"Message", "[", 
                 RowBox[{
                  RowBox[{"AllEvents", "::", "\"\<badJunctions\>\""}], ",", 
                  "#1", ",", "g"}], "]"}]}], "]"}], "*)"}], 
             RowBox[{"(*", " ", 
              RowBox[{"too", " ", "hard", " ", "to", " ", "do"}], " ", "*)"}],
              "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{
                 RowBox[{"{", "}"}], "===", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cs", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"cs", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "jj", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_"}], "}"}]}], "]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"cs", "=", 
                RowBox[{"Reverse", "[", "cs", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"ce", "/.", "ExtractLabel"}], ",", 
               RowBox[{"cs", "/.", "ExtractLabel"}], ",", 
               RowBox[{
               "jj", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               "}"}]}], ",", "\[IndentingNewLine]", "_", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"AllEvents", "::", "badRelationship"}], ",", "#", ",", 
               "g"}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"ce", "/.", "ExtractLabel"}], ",", 
               RowBox[{"cs", "/.", "ExtractLabel"}], ",", "None"}], "}"}]}]}],
            "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"TimesOfEvents", "[", "g", "]"}]}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"956bd17f-c6d3-4814-b2fb-21bb4f235c22"]
}, Closed]],

Cell[CellGroupData[{

Cell["CoalescenceEvents", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"9ec4ae10-d6ce-48d9-818a-b343fdf25dc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalescenceEvents", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"AllEvents", "[", "g", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", 
       RowBox[{"{", "_", "}"}], ",", "_"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"73c8bb99-f457-4637-9b50-4708d359ba1c"]
}, Closed]],

Cell[CellGroupData[{

Cell["RecombinationEvents", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"427ca868-c51e-4bcd-92fe-0c7edb9c337f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RecombinationEvents", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RecombinationEvents", "[", "g", "]"}], "=", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"AllEvents", "[", "g", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", 
        RowBox[{"{", "_", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", "_"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b7858fad-8271-4c37-8d73-edc69324dfc2"]
}, Closed]],

Cell[CellGroupData[{

Cell["NullRecombinationEvents", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"408da5ea-b66a-488e-b439-274e5c7c3206"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NullRecombinationEvents", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"NullRecombinationEvents", "[", "g", "]"}], "=", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"AllEvents", "[", "g", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", 
        RowBox[{"{", "_", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"MapLength", "[", "g", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"1c708929-a7cf-421e-bc07-343f6d3ff7da"]
}, Closed]],

Cell[CellGroupData[{

Cell["LeafEvents", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"67edd33d-e479-4ff9-874e-9203d36f3e64"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LeafEvents", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"LeafEvents", "[", "g", "]"}], "=", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"AllEvents", "[", "g", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "__", "}"}], ",", "_"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5a4ac800-af36-4ce2-a1e0-55a82a37c355"]
}, Closed]],

Cell[CellGroupData[{

Cell["RootEvents", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"18377879-754e-415c-bb44-31830ba30175"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RootEvents", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RootEvents", "[", "g", "]"}], "=", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"AllEvents", "[", "g", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", 
        RowBox[{"{", "__", "}"}], ",", 
        RowBox[{"{", "}"}], ",", "_"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"31c54999-e664-4666-9042-1e7e0e81cc6b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Leaves", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"fbfb06a6-dadb-45b6-a4be-28acfc4d0fc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Leaves", "::", "multipleLineages"}], "=", 
    "\"\<Some leaves share the same label: `1`\>\""}], ";"}], " "}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"97b08566-eef8-49c1-a9e4-19223a795f04"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Leaves", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "&"}],
           "/@", 
          RowBox[{"LeafEvents", "[", "g", "]"}]}], "]"}]}], ",", "uss", ",", 
       "res"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uss", "=", 
       RowBox[{"Union", "[", "ss", "]"}]}], ";", 
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{"TakeAway", "[", 
         RowBox[{"ss", ",", "uss"}], "]"}], "===", 
        RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "res", "]"}], ",", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"Leaves", "::", "multipleLineages"}], ",", "g"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "uss"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"64d38f72-f5a5-4a9f-b454-4cc504eb2be4"]
}, Closed]],

Cell[CellGroupData[{

Cell["LineagesPresent", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"1c611813-8501-4e3a-bb31-a97892536702"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LineagesPresent", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "t_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"g", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "\[LessEqual]", 
         "t", "<", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ")"}], 
       "&"}]}], "]"}], "/.", "ExtractLabel"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LineagesPresent", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"g", "/.", "ExtractLabel"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"1e42e639-2059-41ca-b708-00dbf223bfc5"]
}, Closed]],

Cell[CellGroupData[{

Cell["RecombinantLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"58182e08-d5f3-4944-95c7-65ec01b20f6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RecombinantLineages", "::", "multipleLineages"}], "=", 
    "\"\<Some recombinant lineages share the same label: `1`\>\""}], ";"}], 
  " "}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e8ad0c8b-12b8-48d4-a41b-e70363f476eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RecombinantLineages", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "&"}],
           "/@", 
          RowBox[{"RecombinationEvents", "[", "g", "]"}]}], "]"}]}], ",", 
       "uss", ",", "dss"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uss", "=", 
       RowBox[{"Union", "[", "ss", "]"}]}], ";", 
      RowBox[{"dss", "=", 
       RowBox[{"TakeAway", "[", 
        RowBox[{"ss", ",", "uss"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"dss", "===", 
          RowBox[{"{", "}"}]}], "]"}], ",", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RecombinantLineages", "::", "multipleLineages"}], ",", 
          "g"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", "uss"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571237526718936*^9, 
  3.57123753071564*^9}},ExpressionUUID->"65ef9195-5fc9-4799-8b18-\
781a1b9338a2"]
}, Closed]],

Cell[CellGroupData[{

Cell["CoalescentLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"7671de16-880a-46da-95d6-dfc15c937271"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoalescentLineages", "::", "multipleLineages"}], "=", 
    "\"\<Some coalescent lineages share the same label: `1`\>\""}], ";"}], 
  " "}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0a0d5c29-baf2-4599-9dd2-726d0e8b15a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalescentLineages", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "&"}],
           "/@", 
          RowBox[{"CoalescenceEvents", "[", "g", "]"}]}], "]"}]}], ",", "uss",
        ",", "dss"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uss", "=", 
       RowBox[{"Union", "[", "ss", "]"}]}], ";", 
      RowBox[{"dss", "=", 
       RowBox[{"TakeAway", "[", 
        RowBox[{"ss", ",", "uss"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"dss", "===", 
          RowBox[{"{", "}"}]}], "]"}], ",", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CoalescentLineages", "::", "multipleLineages"}], ",", 
          "g"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", "uss"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5712375374715757`*^9, 
  3.571237541571347*^9}},ExpressionUUID->"ddb0bd9e-6814-41ab-8849-\
604d65fd7739"]
}, Closed]],

Cell[CellGroupData[{

Cell["RootLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"50a83a9c-a431-46a4-a770-81819aa3ba0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RootLineages", "::", "multipleLineages"}], "=", 
    "\"\<Some root lineages share the same label: `1`\>\""}], ";"}], 
  " "}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a4538871-349f-44a8-a6b7-f6b979decf85"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RootLineages", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ")"}], "&"}], "/@", 
          RowBox[{"RootEvents", "[", "g", "]"}]}], "]"}]}], ",", "uss", ",", 
       "res"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uss", "=", 
       RowBox[{"Union", "[", "ss", "]"}]}], ";", 
      RowBox[{
       RowBox[{"TakeAway", "[", 
        RowBox[{"s", ",", "uss"}], "]"}], "===", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "res", "]"}], ",", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RootLineages", "::", "multipleLineages"}], ",", "g"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "uss"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571237547695019*^9, 
  3.571237552721796*^9}},ExpressionUUID->"3855a118-1770-4545-bf00-\
2019f266b5a0"]
}, Closed]],

Cell[CellGroupData[{

Cell["NullLineages", "Subsubsection",ExpressionUUID->"8b74242d-66a2-4174-b2b1-90807bc48d0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NullLineages", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"NullLineages", "[", "g", "]"}], "=", 
    RowBox[{"Cases", "[", 
     RowBox[{"g", ",", 
      RowBox[{"AncestralLineage", "[", 
       RowBox[{"_", ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"MapLength", "[", "g", "]"}], "}"}], ",", "_List"}], "]"}]}],
      "]"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"69115443-dd6f-4402-92df-8cc3aa52af08"]
}, Closed]],

Cell[CellGroupData[{

Cell["TimespanOfLineage", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"7674ac0f-c137-4822-aa9f-6e04997de9f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TimespanOfLineage", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ExtractLineage", "[", 
     RowBox[{"g", ",", "l"}], "]"}], "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"8b1d987a-1204-4994-bf5b-6a8480f4463c"]
}, Closed]],

Cell[CellGroupData[{

Cell["TimeSpanOfJunctions", "Subsubsection",ExpressionUUID->"5942c120-155a-431a-ac13-41d2ac448a94"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TimespanOfJunction", "[", 
    RowBox[{
     RowBox[{"ag", ":", "AncestralGraphPattern"}], ",", "j_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cc", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cc", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"ag", ",", 
         RowBox[{"AncestralLineage", "[", 
          RowBox[{"_", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_"}], "}"}], ",", "_", ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", "j", ",", "___"}], "}"}], ",", "_"}], "]"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"Sort", "[", 
          RowBox[{"cc", "/.", 
           RowBox[{
            RowBox[{"AncestralLineage", "[", 
             RowBox[{"_", ",", 
              RowBox[{"{", 
               RowBox[{"t0_", ",", "_"}], "}"}], ",", "_", ",", "_", ",", 
              "_"}], "]"}], "\[RuleDelayed]", "t0"}]}], "]"}], "]"}], ",", 
        RowBox[{"Last", "[", 
         RowBox[{"Sort", "[", 
          RowBox[{"cc", "/.", 
           RowBox[{
            RowBox[{"AncestralLineage", "[", 
             RowBox[{"_", ",", 
              RowBox[{"{", 
               RowBox[{"_", ",", "t1_"}], "}"}], ",", "_", ",", "_", ",", 
              "_"}], "]"}], "\[RuleDelayed]", "t1"}]}], "]"}], "]"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0817f27b-d542-4c9f-81e8-10ac384503dc"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractLabel", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"8ca1d7b7-1643-4005-9f25-76afff78ee19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractLabel", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"AncestralLineage", "[", 
      RowBox[{"l_", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", "_List", ",", "_List", ",", 
       "_List"}], "]"}], "\[RuleDelayed]", "l"}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7500991e-b75d-4fb6-8ec2-09377cc42041"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractInformation", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"778a5dae-e1dc-49cb-869d-f746cf4e49fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractInformation", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "l_"}], "]"}], ":=", 
   RowBox[{"Last", "[", 
    RowBox[{"ExtractLineage", "[", 
     RowBox[{"g", ",", "l"}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"50e6680d-0996-45ab-a917-4c15e49b89f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractLineage", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"e726ecd4-feeb-4ddf-9243-8e93de183296"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLineage", "::", "notPresent"}], "=", 
   "\"\<Lineage `1` is not present in the graph `2`\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e053707e-22a8-4f26-b9ce-fa0ea2bb493c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLineage", "::", "multipleLineages"}], "=", 
   "\"\<Lineage `1` occurs more than once in the graph `2`\>\""}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"eb89ef79-512a-486a-b43a-da1a4453d1c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLineage", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "l_List"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ExtractLineage", "[", 
       RowBox[{"g", ",", "#"}], "]"}], "&"}], ",", "l", ",", "1"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"80e051f3-0ec4-4329-bcaf-1f65ca298b54"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLineage", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", 
     RowBox[{"l_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cs", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cs", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"g", ",", 
         RowBox[{"AncestralLineage", "[", 
          RowBox[{"l", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_"}], "}"}], ",", "_List", ",", "_List", ",", 
           "_List"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"Length", "[", "cs", "]"}], ",", "\[IndentingNewLine]", "0", 
        ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ExtractLineage", "::", "notPresent"}], ",", "l", ",", 
           "g"}], "]"}], ";", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "1", ",", 
        RowBox[{"cs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "\[IndentingNewLine]", "_", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ExtractLineage", "::", "multipleLineages"}], ",", "l", 
           ",", "g"}], "]"}], ";", "cs"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"14bd2f23-3949-49c9-8d9e-124508844d08"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractLineagesEndingAtT", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"c47bcf8c-d0ea-42f3-aebe-5b3617abe65d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLineagesEndingAtT", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cs", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"cs", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"g", ",", 
         RowBox[{"AncestralLineage", "[", 
          RowBox[{"_", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "t"}], "}"}], ",", "_List", ",", "_List", ",", 
           "_List"}], "]"}]}], "]"}], "/.", "ExtractLabel"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"3f8a44b1-88cc-476d-b647-3f4c8d2f9068"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractLineagesStartingAtT", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"7c7c4eef-70ab-4743-b010-01aaeeac450e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractLineagesStartingAtT", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cs", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"cs", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"g", ",", 
         RowBox[{"AncestralLineage", "[", 
          RowBox[{"_", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "_"}], "}"}], ",", "_List", ",", "_List", ",", 
           "_List"}], "]"}]}], "]"}], "/.", "ExtractLabel"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a4a27029-d122-4eff-a140-e0d7ec18a4f3"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractGenealogy", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"3b88516a-234b-4e4a-92b7-077249dae119"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractGenealogy", "::", "multipleRoots"}], "=", 
   "\"\<Some of the leaves `1` have more than one ancestral lineage at map \
position `3`: `2`\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f4dfd67a-e74c-4231-a79c-37cbc95842e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractGenealogy", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "x_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ng", "=", "g"}], ",", "ds", ",", 
       RowBox[{"ll", "=", 
        RowBox[{"Leaves", "[", "g", "]"}]}], ",", "rl"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rl", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Ancestors", "[", 
           RowBox[{"g", ",", "#", ",", 
            RowBox[{"AncestorList", "\[Rule]", "Roots"}], ",", 
            RowBox[{"MapPosition", "\[Rule]", "x"}]}], "]"}], "&"}], "/@", 
         "ll"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "rl", "]"}], "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ds", "=", 
          RowBox[{"Descendants", "[", 
           RowBox[{"g", ",", 
            RowBox[{
            "rl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"MapPosition", "\[Rule]", "x"}], ",", 
            RowBox[{"DescendantList", "\[Rule]", "All"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ds", "=", 
          RowBox[{"ds", "//.", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a___", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"l_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Not", "[", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"ll", ",", " ", "#"}], "]"}], "]"}], "&"}], 
                  ")"}]}], ",", 
                RowBox[{"{", "}"}]}], "}"}], ",", "b___"}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ListToGenealogy", "[", 
          RowBox[{"ds", ",", "\[IndentingNewLine]", 
           RowBox[{"NodeFunction", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"First", "[", 
                RowBox[{"TimespanOfLineage", "[", 
                 RowBox[{"g", ",", "#"}], "]"}], "]"}], "}"}], "&"}], 
             ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ExtractGenealogy", "::", "multipleRoots"}], ",", "ll", 
           ",", "rl", ",", "x"}], "]"}], ";", "$Failed"}]}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"b3fc9402-81fb-4319-8695-5772c3e30f3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "an", " ", "old", " ", "piece", " ", "of", " ", 
    "code", " ", "which", " ", "is", " ", "in", " ", "some", " ", "ways", " ",
     "more", " ", "efficient"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractGenealogy", "[", 
      RowBox[{
       RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "x_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ng", "=", "g"}], ",", "ds", ",", 
         RowBox[{"ll", "=", 
          RowBox[{"Leaves", "[", "g", "]"}]}], ",", "rl"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rl", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Ancestors", "[", 
              RowBox[{"g", ",", "#", ",", 
               RowBox[{"AncestorList", "\[Rule]", "Roots"}]}], "]"}], "]"}], 
            "]"}], "&"}], "/@", "ll"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], "&"}], "/@",
              "rl"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ds", "=", 
            RowBox[{
             RowBox[{"RecombinationEvents", "[", "g", "]"}], "/.", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"_", ",", "_", ",", 
                RowBox[{"{", 
                 RowBox[{"aL_", ",", "aR_"}], "}"}], ",", "j_"}], "}"}], 
              "\[RuleDelayed]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x", "<", "j"}], ",", "aR", ",", "aL"}], "]"}]}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ng", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"ng", ",", 
                 RowBox[{"AncestralLineage", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{"_", ",", "_"}], "}"}], ",", "_List", ",", 
                   "_List", ",", "_List"}], "]"}]}], "]"}]}], ")"}], "&"}], "/@",
             "ds"}], ";", "\[IndentingNewLine]", "ng"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"ExtractGenealogy", "::", "multipleRoots"}], ",", "ll", 
             ",", "rl"}], "]"}], ";", "$Failed"}]}], "]"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"528b9947-d219-4bf0-b184-3128094dec0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractGenealogy", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"js", "=", 
       RowBox[{"Junctions", "[", "g", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ExtractGenealogy", "[", 
        RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", 
      FractionBox[
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"js", ",", "0"}], "]"}], "+", 
        RowBox[{"Append", "[", 
         RowBox[{"js", ",", "1"}], "]"}]}], "2"]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0efe44aa-b26c-44a5-ab18-4dbd455e1405"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ancestors", "[", 
  RowBox[{"ag", ",", "a"}], "]"}]], "Input",ExpressionUUID->"9a930c00-4577-\
4bb0-b636-a3c13894cc70"],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",ExpressionUUID->"1342957c-5aba-4bd4-ab3b-1c474c7e9a0a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Descendants", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"c2924706-3faf-4fe0-a7aa-006a947ef274"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Descendants", "]"}], "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Options", "[", "Descendants", "]"}], ",", 
     RowBox[{"MapPosition", "\[Rule]", "None"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"14d37afa-827a-4045-81aa-bd0a095658c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Descendants", "::", "multipleLineages"}], "=", 
   "\"\<Several events occur at `1`; `2`\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"989387d6-4160-4df6-a0f3-40f52a946435"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Descendants", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "l_", ",", 
     "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t0", ",", "desc", ",", "f", ",", 
       RowBox[{"dl", "=", 
        RowBox[{
         RowBox[{"DescendantList", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "Descendants", "]"}]}]}], ",", "mp", ",", 
       "cs", ",", "re"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "dl", ",", "\[IndentingNewLine]", "Next", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mp", "=", 
         RowBox[{
          RowBox[{"MapPosition", "/.", 
           RowBox[{"{", "opts", "}"}]}], "/.", 
          RowBox[{"Options", "[", "Descendants", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t0", "=", 
         RowBox[{
          RowBox[{"TimespanOfLineage", "[", 
           RowBox[{"g", ",", "l"}], "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cs", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"g", ",", 
            RowBox[{"AncestralLineage", "[", 
             RowBox[{"_", ",", 
              RowBox[{"{", 
               RowBox[{"_", ",", "t0"}], "}"}], ",", "_List", ",", "_List", 
              ",", "_List"}], "]"}]}], "]"}], "/.", "ExtractLabel"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mp", "===", "None"}], ",", "\[IndentingNewLine]", "cs", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"re", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"AllEvents", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t0", ",", "_", ",", "_", ",", "_"}], "}"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "re", "]"}], "\[NotEqual]", "1"}], ",", 
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"Descendants", "::", "multipleLineages"}], ",", "t0", 
               ",", "g"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"re", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "===", 
              "None"}], ",", "\[IndentingNewLine]", "cs", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"mp", "<", 
                   RowBox[{"re", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "&&", 
                  RowBox[{
                   RowBox[{"re", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "3", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "===", "l"}]}], ")"}], "||", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"mp", "\[GreaterEqual]", 
                   RowBox[{"re", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "&&", 
                  RowBox[{
                   RowBox[{"re", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "3", ",", "2"}], 
                    "\[RightDoubleBracket]"}], "===", "l"}]}], ")"}]}], ",", 
               "\[IndentingNewLine]", "cs", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "All", ",", "\[IndentingNewLine]", 
       RowBox[{"First", "[", 
        RowBox[{"FixedPoint", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"AddDescendants", "[", 
               RowBox[{"g", ",", "#", ",", "opts"}], "]"}], "&"}], ",", "#", 
             ",", 
             RowBox[{"{", 
              RowBox[{"-", "2"}], "}"}]}], "]"}], "&"}], ",", " ", 
          RowBox[{"{", "l", "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]",
        "Leaves", ",", "\[IndentingNewLine]", 
       RowBox[{"First", "[", 
        RowBox[{
         RowBox[{"{", "l", "}"}], "//.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x__", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
            "}"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"dd", "=", 
                 RowBox[{"Descendants", "[", 
                  RowBox[{"g", ",", "#", ",", 
                   RowBox[{"DescendantList", "\[Rule]", "Next"}], ",", 
                   "opts"}], "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"dd", "===", 
                   RowBox[{"{", "}"}]}], ",", "#", ",", "dd"}], "]"}]}], 
               ")"}], "&"}], "/@", 
             RowBox[{"{", "x", "}"}]}], ")"}]}], "}"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f0da3076-2719-4361-b2aa-394e1c9c48c2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "there", " ", "may", " ", "be", " ", "a", " ", "problem", " ", "with", " ",
     "DescendantList"}], "\[Rule]", 
   RowBox[{"All", " ", "in", " ", "the", " ", 
    RowBox[{"above", ".", "  ", "Also"}], " ", "it", " ", "is", " ", "not", 
    " ", "clear", " ", "to", " ", "me", " ", "that", " ", "MapPosition", " ", 
    "is", " ", "a", " ", "sensible", " ", "option", " ", "for", " ", 
    "Descendants", " ", 
    RowBox[{"(", 
     RowBox[{
     "it", " ", "is", " ", "unambiguous", " ", "for", " ", "Ancestors"}], 
     ")"}]}]}], " ", "*)"}]], "Input",ExpressionUUID->"1f326eda-b745-47b5-\
a7f6-313b5456c8c4"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddDescendants", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"02225772-a09f-44c0-a362-4353aa174bfb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AddDescendants", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", 
     RowBox[{"{", "}"}], ",", "___Rule"}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddDescendants", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", 
     RowBox[{"{", 
      RowBox[{"x__", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], "}"}], ",",
      "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", 
       RowBox[{"Descendants", "[", 
        RowBox[{"g", ",", "#", ",", 
         RowBox[{"DescendantList", "\[Rule]", "Next"}], ",", "opts"}], 
        "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"{", "x", "}"}]}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"0f02077f-1e52-486e-bc29-286c8efbf86f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ancestors", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"be8be303-927f-41d7-a1b4-00e60116b498"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Ancestors", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"AncestorList", "\[Rule]", "Previous"}], ",", 
     RowBox[{"MapPosition", "\[Rule]", "None"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"eac23b4f-5311-4df4-aec2-1c4e059f2c06"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ancestors", "::", "multipleLineages"}], "=", 
   "\"\<Several events occur at `1`; `2`\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"609f44cc-3d11-4b1a-b374-9596fbfe7299"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ancestors", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "l_", ",", 
     "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t0", ",", "anc", ",", "f", ",", 
       RowBox[{"al", "=", 
        RowBox[{
         RowBox[{"AncestorList", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "Ancestors", "]"}]}]}], ",", "mp", ",", "cs",
        ",", "re"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "al", ",", "\[IndentingNewLine]", "Previous", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mp", "=", 
         RowBox[{
          RowBox[{"MapPosition", "/.", 
           RowBox[{"{", "opts", "}"}]}], "/.", 
          RowBox[{"Options", "[", "Ancestors", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t0", "=", 
         RowBox[{
          RowBox[{"TimespanOfLineage", "[", 
           RowBox[{"g", ",", "l"}], "]"}], "//", "Last"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cs", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"g", ",", 
            RowBox[{"AncestralLineage", "[", 
             RowBox[{"_", ",", 
              RowBox[{"{", 
               RowBox[{"t0", ",", "_"}], "}"}], ",", "_List", ",", "_List", 
              ",", "_List"}], "]"}]}], "]"}], "/.", "ExtractLabel"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mp", "===", "None"}], ",", "\[IndentingNewLine]", "cs", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"re", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"AllEvents", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t0", ",", "_", ",", "_", ",", "_"}], "}"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "re", "]"}], "\[NotEqual]", "1"}], ",", 
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"Ancestors", "::", "multipleLineages"}], ",", "t0", 
               ",", "g"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"re", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "===", 
              "None"}], ",", "\[IndentingNewLine]", "cs", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"mp", "<", 
                RowBox[{"re", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"re", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "3", ",", "1"}], "\[RightDoubleBracket]"}],
                 "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"re", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "3", ",", "2"}], "\[RightDoubleBracket]"}],
                 "}"}]}], "]"}]}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "All", ",", "\[IndentingNewLine]", 
       RowBox[{"First", "[", 
        RowBox[{"FixedPoint", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"AddAncestors", "[", 
               RowBox[{"g", ",", "#", ",", "opts"}], "]"}], "&"}], ",", "#", 
             ",", 
             RowBox[{"{", 
              RowBox[{"-", "2"}], "}"}]}], "]"}], "&"}], ",", " ", 
          RowBox[{"{", "l", "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]",
        "Roots", ",", "\[IndentingNewLine]", 
       RowBox[{"First", "[", 
        RowBox[{
         RowBox[{"{", "l", "}"}], "//.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x__", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
            "}"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dd", "=", 
                    RowBox[{"Ancestors", "[", 
                    RowBox[{"g", ",", "#", ",", 
                    RowBox[{"AncestorList", "\[Rule]", "Previous"}], ",", 
                    "opts"}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"dd", "===", 
                    RowBox[{"{", "}"}]}], ",", "#", ",", "dd"}], "]"}]}], 
                    ")"}], "&"}], "/@", 
                  RowBox[{"{", "x", "}"}]}], ")"}], "]"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", "y", "]"}], ";"}], "*)"}], "y"}], 
            ")"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"36ab75d6-cea3-434e-8cdd-74803471ad2a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Problem with Ancestors", "Subsubsection",ExpressionUUID->"a38be4b3-6960-4b1d-9804-a4f5f0fb9c76"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x__", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Not", "[", 
              RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], "}"}], 
         "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dd", "=", 
               RowBox[{"Ancestors", "[", 
                RowBox[{"ng2", ",", "#"}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"dd", "===", 
                 RowBox[{"{", "}"}]}], ",", "#", ",", "dd"}], "]"}]}], ")"}], 
            "&"}], "/@", 
           RowBox[{"{", "x", "}"}]}], ")"}]}], "}"}]}], ")"}], "&"}], ",", 
    RowBox[{"{", "a", "}"}], ",", "20"}], "]"}], "\[LeftDoubleBracket]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "2"}], ",", 
    RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]], "Input",Expressio\
nUUID->"0814a11c-6c29-48fc-a3e8-a4e83d61559b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], 
               "}"}]}], "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}]}], 
                  "}"}]}], "}"}], "}"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}]}], 
                  "}"}]}], "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"33", ",", "34"}], "}"}], "}"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "44", "}"}], ",", 
                    RowBox[{"{", "43", "}"}]}], "}"}]}], "}"}], "}"}]}], 
                    "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], 
               "}"}]}], "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}]}], 
                  "}"}]}], "}"}], "}"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}]}], 
                  "}"}]}], "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}]}], 
       "}"}], "}"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], 
                "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], 
                "}"}], "}"}]}], "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}]}], 
                  "}"}]}], "}"}], "}"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}]}], 
                  "}"}]}], "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], 
                "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "37", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "36"}], "}"}]}], "}"}], "}"}], "}"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "45", "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "44", "}"}], "}"}]}], "}"}]}], "}"}], 
                    "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], "}"}], "}"}]}], 
                "}"}], "}"}]}], "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}]}], 
                  "}"}]}], "}"}], "}"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"48", ",", "49"}], "}"}], ",", "47"}], "}"}], 
                    "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}], "}"}]}], 
                  "}"}]}], "}"}], "}"}], "}"}]}], "}"}]}], "}"}], "}"}]}], 
       "}"}], "}"}], "}"}], "}"}]}], "}"}]], "Output",ExpressionUUID->\
"08bb2e17-abe7-42f9-8312-0d8011104d6c"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "a", "}"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x__", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], "}"}], 
    "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dd", "=", 
          RowBox[{"Ancestors", "[", 
           RowBox[{"ng2", ",", "#", ",", 
            RowBox[{"MapPosition", "\[Rule]", "0.2"}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dd", "===", 
            RowBox[{"{", "}"}]}], ",", "#", ",", "dd"}], "]"}]}], ")"}], 
       "&"}], "/@", 
      RowBox[{"{", "x", "}"}]}], ")"}]}], "}"}]}]], "Input",ExpressionUUID->\
"4de88379-71d3-4625-86cf-4254343b5a0a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "4", "}"}], "}"}]], "Output",ExpressionUUID->"16605db1-a2bf-45cd-b700-eb0d686055d5"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "a", "}"}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x__", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], "}"}], 
    "\[RuleDelayed]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dd", "=", 
           RowBox[{"Ancestors", "[", 
            RowBox[{"ng2", ",", "#", ",", 
             RowBox[{"MapPosition", "\[Rule]", "0.2"}]}], "]"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"dd", "===", 
             RowBox[{"{", "}"}]}], ",", "#", ",", "dd"}], "]"}]}], ")"}], 
        "&"}], "/@", 
       RowBox[{"{", "x", "}"}]}], ")"}], "]"}]}], "}"}]}]], "Input",Expression\
UUID->"12ee55b4-a541-4f9a-bc4f-b04f9e37e803"],

Cell[BoxData[
 RowBox[{"{", "48", "}"}]], "Output",ExpressionUUID->"0a289817-1850-42cf-aa0d-531437fc8e6d"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ancestors", "[", 
  RowBox[{"ng2", ",", "a", ",", 
   RowBox[{"AncestorList", "\[Rule]", "Roots"}]}], "]"}]], "Input",ExpressionU\
UID->"63239821-6209-4be5-9e7d-3cc3b1d8aa79"],

Cell[BoxData[
 RowBox[{"{", "4", "}"}]], "Print",ExpressionUUID->"639326d1-73f7-480e-8d62-70c037cb3349"],

Cell[BoxData[
 RowBox[{"{", "5", "}"}]], "Print",ExpressionUUID->"b9d1ef6f-0f4c-4d38-91d0-3769a8d97ef4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "7"}], "}"}]], "Print",ExpressionUUID->"89ff32aa-e930-41ad-87b5-d8175fc90a32"],

Cell[BoxData[
 RowBox[{"{", "8", "}"}]], "Print",ExpressionUUID->"d0956f2f-ff3b-43bc-b419-56e16e508afa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "10"}], "}"}]], "Print",ExpressionUUID->"04756635-1c3f-4008-a713-0d2e821898f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"11", ",", "28", ",", "29"}], "}"}]], "Print",ExpressionUUID->\
"97fe4f16-1e2c-4046-b8d7-2b53e52aa363"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12", ",", "13", ",", "30", ",", "31"}], "}"}]], "Print",ExpressionU\
UID->"5a59a46d-5ea5-4483-9e99-f76231bef11c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"14", ",", "32"}], "}"}]], "Print",ExpressionUUID->"b57cfe6e-002f-4dd6-851c-967c02a8f7a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15", ",", "16", ",", "33", ",", "34"}], "}"}]], "Print",ExpressionU\
UID->"c30888b4-8ad5-404f-a93e-1566213c19fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"17", ",", "35", ",", "36", ",", "37"}], "}"}]], "Print",ExpressionU\
UID->"555e47c1-eaef-4a77-9c8a-7f646f5abd25"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"18", ",", "19", ",", "37", ",", "38", ",", "45"}], "}"}]], "Print",\
ExpressionUUID->"cc3dfead-bef6-4389-9812-a37c6c7b9aeb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20", ",", "38", ",", "39", ",", "40", ",", "46", ",", "47"}], 
  "}"}]], "Print",ExpressionUUID->"fb174d32-de23-45a5-9126-86594ff14283"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "21", ",", "22", ",", "39", ",", "40", ",", "41", ",", "42", ",", "43", ",",
    "47", ",", "48", ",", "49"}], "}"}]], "Print",ExpressionUUID->"d9ec73a4-\
2694-462c-b4d0-6283447a41bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "23", ",", "41", ",", "42", ",", "43", ",", "44", ",", "47", ",", "48", ",",
    "49"}], "}"}]], "Print",ExpressionUUID->"ebb78dbb-005f-451b-93a9-\
165f12ad9543"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "24", ",", "25", ",", "43", ",", "44", ",", "45", ",", "47", ",", "48", ",",
    "49"}], "}"}]], "Print",ExpressionUUID->"b382e845-4d43-484e-a7b4-\
6e65c7028276"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "26", ",", "27", ",", "38", ",", "44", ",", "45", ",", "46", ",", "47", ",",
    "48", ",", "49"}], "}"}]], "Print",ExpressionUUID->"fb98129d-8365-4940-\
9842-5a15d7f2d6c5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "30", ",", "31", ",", "39", ",", "40", ",", "45", ",", "46", ",", "47", ",",
    "48", ",", "49"}], "}"}]], "Print",ExpressionUUID->"af9b114b-42cf-4007-\
b0f8-d9d57c2fb1de"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "32", ",", "41", ",", "42", ",", "43", ",", "46", ",", "47", ",", "48", ",",
    "49"}], "}"}]], "Print",ExpressionUUID->"98c30097-8e86-413a-af3a-\
e5fc165938b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "33", ",", "34", ",", "43", ",", "44", ",", "47", ",", "48", ",", "49"}], 
  "}"}]], "Print",ExpressionUUID->"aff34255-c977-4f72-ba54-9f2d55c64fef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "35", ",", "36", ",", "37", ",", "44", ",", "45", ",", "47", ",", "48", ",",
    "49"}], "}"}]], "Print",ExpressionUUID->"22ad8371-2401-4926-b6e9-\
15d7a9f84943"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "37", ",", "38", ",", "45", ",", "46", ",", "47", ",", "48", ",", "49"}], 
  "}"}]], "Print",ExpressionUUID->"957be489-d906-4daa-b115-45eb72f78c11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "38", ",", "39", ",", "40", ",", "46", ",", "47", ",", "48", ",", "49"}], 
  "}"}]], "Print",ExpressionUUID->"71e79ade-999e-4991-a1a9-02a232b2853e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "39", ",", "40", ",", "41", ",", "42", ",", "43", ",", "47", ",", "48", ",",
    "49"}], "}"}]], "Print",ExpressionUUID->"baf72b80-0947-4ce8-89cd-\
e8618d5b82df"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "41", ",", "42", ",", "43", ",", "44", ",", "47", ",", "48", ",", "49"}], 
  "}"}]], "Print",ExpressionUUID->"518bac42-6761-4be7-bbd3-695630871b09"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"43", ",", "44", ",", "45", ",", "47", ",", "48", ",", "49"}], 
  "}"}]], "Print",ExpressionUUID->"245d34e1-f052-4a74-8819-b69e7d751666"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"44", ",", "45", ",", "46", ",", "47", ",", "48", ",", "49"}], 
  "}"}]], "Print",ExpressionUUID->"9a3cffd0-ee5e-4183-b9b9-c7cc2780279d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"45", ",", "46", ",", "47", ",", "48", ",", "49"}], "}"}]], "Print",\
ExpressionUUID->"555adcec-f698-437d-bad3-511e4c6b6208"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"46", ",", "47", ",", "48", ",", "49"}], "}"}]], "Print",ExpressionU\
UID->"d1a441ce-c6eb-4951-a677-d582a50fcaa6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"47", ",", "48", ",", "49"}], "}"}]], "Print",ExpressionUUID->\
"f7d67805-d0b5-4d87-b1fe-7a26c70f35cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"47", ",", "48", ",", "49"}], "}"}]], "Print",ExpressionUUID->\
"87a97fbb-3d6b-4e2c-88fe-501f3be200b9"],

Cell[BoxData["47"], "Output",ExpressionUUID->"e3434f61-4298-43e8-8141-b505ffa535bb"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["AddAncestors", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"f2c806cf-ec28-4da0-bed8-a0e2c83346b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AddAncestors", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", 
     RowBox[{"{", "}"}], ",", "___Rule"}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddAncestors", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", 
     RowBox[{"{", 
      RowBox[{"x__", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], "}"}], ",",
      "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", 
       RowBox[{"Ancestors", "[", 
        RowBox[{"g", ",", "#", ",", 
         RowBox[{"AncestorList", "\[Rule]", "Previous"}], ",", "opts"}], 
        "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"{", "x", "}"}]}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"7da63aaf-cb95-4db4-98c5-68a1097dbdb8"]
}, Closed]],

Cell[CellGroupData[{

Cell["CoalesceLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"e50b0a78-675d-44c5-a759-1950060f4b17"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CoalesceLineages", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"InformationFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", "##", "}"}], "]"}], "&"}], ")"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c0c96dc2-06f4-445e-b8e6-c761a78e8ed8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalesceLineages", "::", "badInfoLists"}], "=", 
   "\"\<The information lists associated with the two lineages have different \
lengths.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a3abe507-b978-4084-8c5a-71a21426bb3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoalesceLineages", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AncestralLineage", "[", 
      RowBox[{"_", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", "s1_List", ",", "j1_List", ",", 
       RowBox[{"i1", ":", 
        RowBox[{"{", "___List", "}"}]}]}], "]"}], ",", 
     RowBox[{"AncestralLineage", "[", 
      RowBox[{"_", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", "s2_List", ",", "j2_List", ",", 
       RowBox[{"i2", ":", 
        RowBox[{"{", "___List", "}"}]}]}], "]"}], ",", "l12_", ",", "t12_", 
     ",", "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"if", "=", 
        RowBox[{
         RowBox[{"InformationFunction", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "CoalesceLineages", "]"}]}]}], ",", "jsl"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "i1", "]"}], "\[NotEqual]", 
        RowBox[{"Length", "[", "i2", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CoalesceLineages", "::", "badInfoLists"}], ",", "i1", ",", 
          "i2"}], "]"}], ";", "$Failed"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jsl", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Sort", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"j1", ",", "s1"}], "}"}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j_", ",", "s_"}], "}"}], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "s", ",", "Null"}], "}"}]}], ",", "1"}], 
              "]"}], ",", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"j2", ",", "s2"}], "}"}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j_", ",", "s_"}], "}"}], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "Null", ",", "s"}], "}"}]}], ",", "1"}], 
              "]"}]}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jsl", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"jsl", "//.", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a___", ",", "Null", ",", 
                RowBox[{"x_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Not", "[", 
                    RowBox[{"#", "===", "Null"}], "]"}], "&"}], ")"}]}], ",", 
                "b___"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"a", ",", "x", ",", "x", ",", "b"}], "}"}]}]}], "]"}], 
           ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jsl", "=", 
         RowBox[{"Replace", "[", 
          RowBox[{"jsl", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j_", ",", "ss1_", ",", "ss2_"}], "}"}], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"ss1", ",", "ss2"}], "]"}], "]"}]}], "}"}]}], ",", 
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jsl", "=", 
         RowBox[{"jsl", "//.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a___", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"j_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Not", "[", 
                   RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
               ",", "s__"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"j_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Not", "[", 
                   RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
               ",", "__"}], "}"}], ",", "b___"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "s"}], "}"}], ",", "b"}], "}"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"jsl", "=", 
         RowBox[{"jsl", "//.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a___", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Not", "[", 
                   RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
               ",", "s__"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"jj2_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Not", "[", 
                   RowBox[{"ListQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
               ",", "s__"}], "}"}], ",", "b___"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"jj2", ",", "s"}], "}"}], ",", "b"}], "}"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"jsl", "=", 
         RowBox[{"Transpose", "[", "jsl", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AncestralLineage", "[", 
         RowBox[{"l12", ",", 
          RowBox[{"{", 
           RowBox[{"t12", ",", "\[Infinity]"}], "}"}], ",", 
          RowBox[{"Sort", "/@", 
           RowBox[{
           "jsl", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{
          "jsl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"if", "[", 
           RowBox[{"i1", ",", "i2"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"539c3ab6-aee1-4c25-8a86-80b6a4c2f334"]
}, Closed]],

Cell[CellGroupData[{

Cell["RecombineLineage", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"15d977cd-0dd8-4a3e-8211-fb1a7c8dbcab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "RecombineLineage", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"InformationFunction", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Identity", ",", "Identity"}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"baa42c05-7a1f-4a4b-ade9-a423fd1f67cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RecombineLineage", "[", 
    RowBox[{
     RowBox[{"AncestralLineage", "[", 
      RowBox[{"_", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", "s_List", ",", "j_List", ",", 
       "i_List"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"lL_", ",", "lR_"}], "}"}], ",", "x_", ",", "t_", ",", 
     "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"if", "=", 
        RowBox[{
         RowBox[{"InformationFunction", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "RecombineLineage", "]"}]}]}], ",", "jsl", 
       ",", "jsL", ",", "jsR", ",", "jsRR"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"jsl", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"j", ",", "s"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"jsRR", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"jsl", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ">", 
            "x"}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"jsRR", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "===", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jsR", "=", 
          RowBox[{"Transpose", "[", "jsRR", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"jsL", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"jsl", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "\[LessEqual]", "x"}], ")"}], "&"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"jsR", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", "}"}]}], "}"}], "}"}]}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jsR", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Prepend", "[", 
            RowBox[{"jsRR", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"{", "}"}]}], "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"jsL", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"jsl", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "\[LessEqual]", "x"}], ")"}], "&"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"jsR", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"jsR", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", "}"}]}], "}"}]}], "}"}]}], "]"}], "]"}]}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AncestralLineage", "[", 
         RowBox[{"lL", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Infinity]"}], "}"}], ",", 
          RowBox[{"Sort", "/@", 
           RowBox[{
           "jsL", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{
          "jsL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{
           "if", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "[", 
           "i", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AncestralLineage", "[", 
         RowBox[{"lR", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Infinity]"}], "}"}], ",", 
          RowBox[{"Sort", "/@", 
           RowBox[{
           "jsR", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{
          "jsR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{
           "if", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "[", 
           "i", "]"}]}], "]"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c8569618-794f-44e1-bc60-7ea3967252df"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddRecombinantLineages", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"cc8cf59c-31ed-458e-9d13-f0c6c783447c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AddRecombinantLineages", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"DeleteNullLineages", "\[Rule]", "False"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"09d2542d-b0d8-41e5-a318-c6d4a133c494"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddRecombinantLineages", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", "l_", ",", 
     RowBox[{"{", 
      RowBox[{"lL_", ",", "lR_"}], "}"}], ",", "x_", ",", "t_", ",", 
     "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rl", "=", 
       RowBox[{"RecombineLineage", "[", 
        RowBox[{
         RowBox[{"ExtractLineage", "[", 
          RowBox[{"g", ",", "l"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"lL", ",", "lR"}], "}"}], ",", "x", ",", "t"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DeleteNullLineages", "/.", 
           RowBox[{"{", "opts", "}"}]}], "/.", 
          RowBox[{"Options", "[", "AddRecombinantLineages", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"rl", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "===", 
           RowBox[{"{", 
            RowBox[{"{", "}"}], "}"}]}], "||", 
          RowBox[{
           RowBox[{"rl", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "===", 
           RowBox[{"{", 
            RowBox[{"{", "}"}], "}"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "g", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"g", "/.", 
          RowBox[{
           RowBox[{"AncestralLineage", "[", 
            RowBox[{"l", ",", 
             RowBox[{"{", 
              RowBox[{"t0_", ",", "_"}], "}"}], ",", "s_", ",", "j_", ",", 
             "i_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"AncestralLineage", "[", 
            RowBox[{"l", ",", 
             RowBox[{"{", 
              RowBox[{"t0", ",", "t"}], "}"}], ",", "s", ",", "j", ",", "i"}],
             "]"}]}]}], ",", "rl"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5a8d0330-2846-4aa6-9971-d7495dedcbe1"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddCoalescentLineage", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"8eea9a9f-393a-4d66-b0de-249e2d71e49f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddCoalescentLineage", "[", 
    RowBox[{
     RowBox[{"g", ":", "AncestralGraphPattern"}], ",", 
     RowBox[{"{", 
      RowBox[{"l1_", ",", "l2_"}], "}"}], ",", "lC_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cl", "=", 
       RowBox[{"CoalesceLineages", "[", 
        RowBox[{
         RowBox[{"ExtractLineage", "[", 
          RowBox[{"g", ",", "l1"}], "]"}], ",", 
         RowBox[{"ExtractLineage", "[", 
          RowBox[{"g", ",", "l2"}], "]"}], ",", "lC", ",", "t"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"g", "/.", 
        RowBox[{
         RowBox[{"AncestralLineage", "[", 
          RowBox[{
           RowBox[{"ll", ":", 
            RowBox[{"l1", "|", "l2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t0_", ",", "_"}], "}"}], ",", "s_", ",", "j_", ",", 
           "i_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"AncestralLineage", "[", 
          RowBox[{"ll", ",", 
           RowBox[{"{", 
            RowBox[{"t0", ",", "t"}], "}"}], ",", "s", ",", "j", ",", "i"}], 
          "]"}]}]}], ",", "cl"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"3c92dce2-d419-4a3d-aa07-4b3952189192"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomCoalescenceTimes", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"85b267da-25f3-45a4-bfd1-2da32e468840"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomCoalescenceTimes", "[", 
    RowBox[{"k_Integer", ",", "R_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"k", "-", "1"}], ")"}]}], "+", 
         RowBox[{"k", " ", "R"}]}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"Random", "[", 
        RowBox[{"ExponentialDistribution", "[", "\[Lambda]", "]"}], "]"}]}], 
      ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RandomReal", "[", "]"}], "<", 
         FractionBox[
          RowBox[{"k", " ", "R"}], "\[Lambda]"]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"k", "+", "1"}], ",", 
          RowBox[{"Random", "[", 
           RowBox[{"UniformDistribution", "[", 
            RowBox[{"0", ",", "R"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"k", "-", "1"}], ",", "None"}], "}"}]}], "]"}]}]}], "]"}]}],
   ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5eca6e85-f6b3-4434-b76d-5d9fe9a37ee7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomCoalescenceTimes", "[", 
    RowBox[{"n_Integer", ",", "k_Integer", ",", "R_"}], "]"}], ":=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"FoldList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#2", "+", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "0", ",", "0"}], "}"}]}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"NestList", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RandomCoalescenceTimes", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", "R"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "k", ",", "0"}], "}"}], ",", "n"}], "]"}], ",", 
         "1"}], "]"}]}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0e587e57-8601-4bf0-b543-92fdda64ec9b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["RandomGenealogy", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"64867a4c-a4b9-4fa5-85bd-e3d1d643e333"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "RandomGenealogy", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Options", "[", "RandomGenealogy", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PrintDetails", "\[Rule]", "False"}], ",", 
       RowBox[{"MaxTime", "\[Rule]", "\[Infinity]"}], ",", 
       RowBox[{"Fixation", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"705520b9-adef-47be-81c3-2c9a87673b1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RandomGenealogy", "::", "badRec"}], "=", 
   "\"\<Attempt to add recombinant lineages derived from `1` to `2` failed.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomGenealogy", "::", "oneRec"}], "=", 
   "\"\<Only one recombinant lineages derived from `1` added to `2`: error.\>\
\""}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"71ebc6bf-5bf3-4c6d-802c-5b53b9dad400"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomGenealogy", "[", 
    RowBox[{"ll_List", ",", "n_Integer", ",", "R_", ",", "opts___Rule"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rct", ",", 
       RowBox[{"g1", "=", 
        RowBox[{"g0", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"AncestralLineage", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "\[Infinity]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", "#", "}"}], "}"}], ",", 
             RowBox[{"{", "R", "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", "ll"}]}]}], ",", 
       RowBox[{"k", "=", "0"}], ",", 
       RowBox[{"lvs", "=", "ll"}], ",", "nl", ",", 
       RowBox[{"t", "=", "0"}], ",", "cl", ",", "\[IndentingNewLine]", 
       RowBox[{"pd", "=", 
        RowBox[{
         RowBox[{"PrintDetails", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "RandomGenealogy", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tm", "=", 
        RowBox[{
         RowBox[{"MaxTime", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "RandomGenealogy", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fix", "=", 
        RowBox[{
         RowBox[{"Fixation", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "RandomGenealogy", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "\[LessEqual]", "n"}], "\[And]", 
         RowBox[{"t", "<", "tm"}], "\[And]", 
         RowBox[{"If", "[", 
          RowBox[{"fix", ",", "\[IndentingNewLine]", 
           RowBox[{"Not", "[", 
            RowBox[{"FixedQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ExtractLineage", "[", 
                 RowBox[{"g0", ",", "#"}], "]"}], "&"}], "/@", "lvs"}], ",", 
              "ll"}], "]"}], "]"}], ",", "\[IndentingNewLine]", "True"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k", "+=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rct", "=", 
           RowBox[{"RandomCoalescenceTimes", "[", 
            RowBox[{
             RowBox[{"Length", "[", "lvs", "]"}], ",", "R"}], "]"}]}], ";", 
          RowBox[{"t", "+=", 
           RowBox[{
           "rct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"pd", ",", 
            RowBox[{"Print", "[", "rct", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "rct", "]"}], "===", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nl", "=", 
              RowBox[{"RandomSample", "[", 
               RowBox[{"lvs", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"pd", ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Coalescing \>\"", ",", "nl", ",", 
                 "\"\<; current lineages \>\"", ",", "lvs"}], "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"g1", "=", 
              RowBox[{"AddCoalescentLineage", "[", 
               RowBox[{"g0", ",", "nl", ",", 
                RowBox[{"k", "+", "1"}], ",", "t"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"lvs", "=", 
              RowBox[{"TakeAway", "[", 
               RowBox[{"lvs", ",", "nl"}], "]"}]}], ";", 
             RowBox[{"lvs", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"lvs", ",", 
                RowBox[{"k", "+", "1"}]}], "]"}]}], ";", 
             RowBox[{"k", "+=", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nl", "=", 
              RowBox[{
               RowBox[{"RandomSample", "[", 
                RowBox[{"lvs", ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1",
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"pd", ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Recombining \>\"", ",", "nl", ",", 
                 "\"\<; current lineages \>\"", ",", "lvs"}], "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"g1", "=", 
              RowBox[{"AddRecombinantLineages", "[", 
               RowBox[{"g0", ",", "nl", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"k", "+", "1"}], ",", 
                  RowBox[{"k", "+", "2"}]}], "}"}], ",", 
                RowBox[{
                "rct", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                 ",", "t", ",", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"pd", ",", 
                 RowBox[{"Print", "[", 
                  RowBox[{"g0", ",", "Tab", ",", "g1"}], "]"}]}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "g1", "]"}], "-", 
                RowBox[{"Length", "[", "g0", "]"}]}], ",", 
               "\[IndentingNewLine]", "0", ",", "Null", ",", 
               "\[IndentingNewLine]", "1", ",", 
               RowBox[{
                RowBox[{"Message", "[", 
                 RowBox[{
                  RowBox[{"RandomGenealogy", "::", "oneRec"}], ",", "nl", ",",
                   "g1"}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"lvs", "=", 
                 RowBox[{"TakeAway", "[", 
                  RowBox[{"lvs", ",", 
                   RowBox[{"{", "nl", "}"}]}], "]"}]}], ";", 
                RowBox[{"lvs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"lvs", ",", 
                   RowBox[{"{", 
                    RowBox[{"k", "+", "1"}], "}"}]}], "]"}]}], ";", 
                RowBox[{"k", "+=", "1"}]}], ",", "\[IndentingNewLine]", "2", 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"lvs", "=", 
                 RowBox[{"TakeAway", "[", 
                  RowBox[{"lvs", ",", 
                   RowBox[{"{", "nl", "}"}]}], "]"}]}], ";", 
                RowBox[{"lvs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"lvs", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"k", "+", "2"}]}], "}"}]}], "]"}]}], ";", 
                RowBox[{"k", "+=", "2"}]}], ",", "\[IndentingNewLine]", "_", 
               ",", 
               RowBox[{"Message", "[", 
                RowBox[{
                 RowBox[{"RandomGenealogy", "::", "badRec"}], ",", "nl", ",", 
                 "g1"}], "]"}]}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"pd", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cl", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"ExtractLineage", "[", 
                 RowBox[{"g1", ",", "#"}], "]"}], "&"}], "/@", "lvs"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Current lineages =\>\"", ",", "cl", ",", 
               "\"\< fixed? \>\"", ",", 
               RowBox[{"FixedQ", "[", 
                RowBox[{"cl", ",", "ll"}], "]"}]}], "]"}]}]}], "]"}], ";", 
          RowBox[{"g0", "=", "g1"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "g1"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571282966212823*^9, 
  3.5712829861478653`*^9}},ExpressionUUID->"2581525f-25ab-40c4-851b-\
df7d45f5c5af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomGenealogy", "[", 
    RowBox[{"ll_List", ",", 
     RowBox[{"rct", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_Integer", ",", "_"}], "}"}], "..."}], "}"}]}], 
     ",", "R_", ",", "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g1", ",", 
       RowBox[{"g0", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"AncestralLineage", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "#", "}"}], "}"}], ",", 
            RowBox[{"{", "R", "}"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", "ll"}]}], ",", 
       RowBox[{"k", "=", "0"}], ",", 
       RowBox[{"lvs", "=", "ll"}], ",", "nl", ",", 
       RowBox[{"pd", "=", 
        RowBox[{
         RowBox[{"PrintDetails", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "RandomGenealogy", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"pd", ",", 
            RowBox[{"Print", "[", "#", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "#", "]"}], "===", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nl", "=", 
              RowBox[{"RandomSample", "[", 
               RowBox[{"lvs", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"pd", ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Coalescing \>\"", ",", "nl", ",", 
                 "\"\<; current lineages \>\"", ",", "lvs"}], "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"g1", "=", 
              RowBox[{"AddCoalescentLineage", "[", 
               RowBox[{"g0", ",", "nl", ",", 
                RowBox[{"k", "+", "1"}], ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"lvs", "=", 
              RowBox[{"TakeAway", "[", 
               RowBox[{"lvs", ",", "nl"}], "]"}]}], ";", 
             RowBox[{"lvs", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"lvs", ",", 
                RowBox[{"k", "+", "1"}]}], "]"}]}], ";", 
             RowBox[{"k", "+=", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nl", "=", 
              RowBox[{
               RowBox[{"RandomSample", "[", 
                RowBox[{"lvs", ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1",
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"pd", ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Recombining \>\"", ",", "nl", ",", 
                 "\"\<; current lineages \>\"", ",", "lvs"}], "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"g1", "=", 
              RowBox[{"AddRecombinantLineages", "[", 
               RowBox[{"g0", ",", "nl", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"k", "+", "1"}], ",", 
                  RowBox[{"k", "+", "2"}]}], "}"}], ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "g1", "]"}], "-", 
                RowBox[{"Length", "[", "g0", "]"}]}], ",", 
               "\[IndentingNewLine]", "1", ",", 
               RowBox[{
                RowBox[{"lvs", "=", 
                 RowBox[{"TakeAway", "[", 
                  RowBox[{"lvs", ",", 
                   RowBox[{"{", "nl", "}"}]}], "]"}]}], ";", 
                RowBox[{"lvs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"lvs", ",", 
                   RowBox[{"{", 
                    RowBox[{"k", "+", "1"}], "}"}]}], "]"}]}], ";", 
                RowBox[{"k", "+=", "1"}]}], ",", "\[IndentingNewLine]", "2", 
               ",", 
               RowBox[{
                RowBox[{"lvs", "=", 
                 RowBox[{"TakeAway", "[", 
                  RowBox[{"lvs", ",", 
                   RowBox[{"{", "nl", "}"}]}], "]"}]}], ";", 
                RowBox[{"lvs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"lvs", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"k", "+", "2"}]}], "}"}]}], "]"}]}], ";", 
                RowBox[{"k", "+=", "2"}]}], ",", "\[IndentingNewLine]", "_", 
               ",", 
               RowBox[{"Message", "[", 
                RowBox[{
                 RowBox[{"RandomGenealogy", "::", "badRec"}], ",", "nl", ",", 
                 "g1"}], "]"}]}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"pd", ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<G=\>\"", ",", "g1"}], "]"}]}], "]"}], ";", 
          RowBox[{"g0", "=", "g1"}]}], ")"}], "&"}], "/@", "rct"}], ";", 
      "\[IndentingNewLine]", "g1"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5712829937640457`*^9, 
  3.571283006113604*^9}},ExpressionUUID->"268c1f19-fe09-4df5-ba93-\
f74458ab3007"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Segments", "Subsubsection",ExpressionUUID->"477e5608-ea4a-4c1d-b93d-887812ce6d10"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Segments", "[", 
    RowBox[{
     RowBox[{"al", ":", "AncestralLineagePattern"}], ",", "l_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xx", "=", 
        RowBox[{"al", "/.", 
         RowBox[{
          RowBox[{"AncestralLineage", "[", 
           RowBox[{"_", ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_"}], "}"}], ",", "s_", ",", "j_", ",", "_"}],
            "]"}], ":>", 
          RowBox[{"{", 
           RowBox[{"s", ",", "j"}], "}"}]}]}]}], ",", "yy"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"yy", "=", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "xx", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"___", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "l"}], "]"}], "&"}], ")"}]}], "}"}], 
             "\[RuleDelayed]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"___", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "l"}], "]"}], "&"}], ")"}]}], ",", "l", 
               ",", 
               RowBox[{"___", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "l"}], "]"}], "&"}], ")"}]}]}], "}"}], 
             "\[RuleDelayed]", 
             RowBox[{"{", "l", "}"}]}]}], "}"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "//.", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a___", ",", 
           RowBox[{"{", 
            RowBox[{"s_List", ",", "x0_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"s_List", ",", "x1_"}], "}"}], ",", "b___"}], "}"}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "x1"}], "}"}], ",", "b"}], "}"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yy", "=", 
       RowBox[{"(", 
        RowBox[{"yy", "//.", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b___", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "}"}], ",", "x0_"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"___", ",", "l", ",", "___"}], "}"}], ",", "x1_"}], 
               "}"}], ",", "c___"}], "}"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"b", ",", 
              RowBox[{"{", 
               RowBox[{"x0", ",", "x1"}], "}"}], ",", "c"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b___", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "}"}], ",", "_"}], "}"}]}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", "b", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"___", ",", "l", ",", "___"}], "}"}], ",", "x0_"}], 
               "}"}], ",", "b___"}], "}"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "x0"}], "}"}], ",", "b"}], "}"}]}]}], 
          "}"}]}], ")"}]}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"6451e965-1674-4778-8aaa-a46371b2746e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Segments", "[", 
    RowBox[{
     RowBox[{"al", ":", "AncestralGraphPattern"}], ",", "l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Segments", "[", 
      RowBox[{"#", ",", "l"}], "]"}], "&"}], "/@", "al"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f1fdc912-f900-4cde-8da7-72ab3012a5cb"]
}, Closed]],

Cell[CellGroupData[{

Cell["PlotSegments", "Subsubsection",ExpressionUUID->"f746a558-7614-46fd-abc3-b8d313e3ee2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotSegments", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"JunctionStyle", "\[Rule]", 
      RowBox[{"{", "Black", "}"}]}], ",", 
     RowBox[{"SegmentStyle", "\[Rule]", 
      RowBox[{"{", "Blue", "}"}]}], ",", 
     RowBox[{"BackgroundStyle", "\[Rule]", 
      RowBox[{"{", "Yellow", "}"}]}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5bd0379d-4753-4eb2-a812-512b81664b1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlotSegments", "[", 
    RowBox[{
     RowBox[{"al", ":", "AncestralLineagePattern"}], ",", "l_", ",", "y_", 
     ",", "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"segs", "=", 
        RowBox[{"Segments", "[", 
         RowBox[{"al", ",", "l"}], "]"}]}], ",", "yy", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"bs", "=", 
        RowBox[{
         RowBox[{"BackgroundStyle", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "PlotSegments", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ss", "=", 
        RowBox[{
         RowBox[{"SegmentStyle", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "PlotSegments", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"yy", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"bs", ",", 
         RowBox[{"{", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "y"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MapLength", "[", "al", "]"}], ",", "y"}], "}"}]}], 
            "}"}], "]"}], "}"}], ",", "ss", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Replace", "[", 
           RowBox[{"segs", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x0_", ",", "x1_"}], "}"}], "\[RuleDelayed]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x0", ",", "y"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x1", ",", "y"}], "}"}]}], "}"}], "]"}]}], ",", 
            "1"}], "]"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", "yy", "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571237585041926*^9, 
  3.571237599218025*^9}},ExpressionUUID->"64f78b81-c221-4014-a474-\
a136f30cf449"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlotSegments", "[", 
    RowBox[{
     RowBox[{"al", ":", "AncestralGraphPattern"}], ",", "l_", ",", 
     RowBox[{"{", 
      RowBox[{"y0_", ",", "y1_"}], "}"}], ",", "opts___Rule"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"segs", "=", 
        RowBox[{"Segments", "[", 
         RowBox[{"al", ",", "l"}], "]"}]}], ",", "yy", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"jj", "=", 
        RowBox[{"Junctions", "[", "al", "]"}]}], ",", "y", ",", "k", ",", 
       RowBox[{"nl", "=", 
        RowBox[{"Length", "[", "al", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"bs", "=", 
        RowBox[{
         RowBox[{"BackgroundStyle", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "PlotSegments", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"js", "=", 
        RowBox[{
         RowBox[{"JunctionStyle", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "PlotSegments", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ss", "=", 
        RowBox[{
         RowBox[{"SegmentStyle", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "PlotSegments", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"yy", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"js", ",", 
         RowBox[{"Replace", "[", 
          RowBox[{"jj", ",", 
           RowBox[{"x_", "\[RuleDelayed]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y1"}], "}"}]}], "}"}], "]"}]}], ",", "1"}],
           "]"}], ",", "bs", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"MapLength", "[", "al", "]"}], ",", "y"}], "}"}]}], 
             "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "y0", ",", "y1", ",", 
             FractionBox[
              RowBox[{"y1", "-", "y0"}], 
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", 
                RowBox[{"nl", "-", "1"}]}], "]"}]]}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"ss", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"segs", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x0_", ",", "x1_"}], "}"}], "\[RuleDelayed]", 
                RowBox[{"{", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"y0", 
                    RowBox[{"(", 
                    RowBox[{"nl", "-", "k"}], ")"}]}], "+", 
                    RowBox[{"y1", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"nl", "-", "1"}]}], "]"}]]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x1", ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"y0", 
                    RowBox[{"(", 
                    RowBox[{"nl", "-", "k"}], ")"}]}], "+", 
                    RowBox[{"y1", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"nl", "-", "1"}]}], "]"}]]}], "}"}]}], "}"}], 
                  "]"}], "}"}]}], ",", "1"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "nl"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", "yy", "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571237619550145*^9, 
  3.5712376738506727`*^9}},ExpressionUUID->"fac3ee31-6201-4c93-bf49-\
6f67ed028544"]
}, Closed]],

Cell[CellGroupData[{

Cell["FixedQ", "Subsubsection",ExpressionUUID->"bc137ce2-ef8d-4405-a73d-1668fee3fc0a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FixedQ", "[", 
    RowBox[{
     RowBox[{"AncestralLineage", "[", 
      RowBox[{"_", ",", "_List", ",", "s_List", ",", "_List", ",", "_List"}], 
      "]"}], ",", "lvs_List"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Sort", "/@", "s"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"Sort", "[", "lvs", "]"}]}], "}"}]}], "]"}], "===", 
     RowBox[{"{", "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FixedQ", "[", 
    RowBox[{
     RowBox[{"ag", ":", "AncestralGraphPattern"}], ",", "lvs_List"}], "]"}], ":=", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"FixedQ", "[", 
        RowBox[{"#", ",", "lvs"}], "]"}], "&"}], "/@", "ag"}], ")"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"c242de75-47e9-43da-a171-bf18b3b1c388"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Describing genealogies", "Subsection",ExpressionUUID->"e1451397-1f6d-46b3-918b-472760b8ba65"],

Cell[CellGroupData[{

Cell["MRCA", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"f45a4875-bb66-4ae0-a844-d9d14d246143"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MRCA", "[", 
    RowBox[{"g_Node", ",", 
     RowBox[{"{", "}"}]}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MRCA", "[", 
    RowBox[{"g_Node", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "x_", ")"}], ".."}], "}"}]}], "]"}], ":=", "x"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MRCA", "[", 
    RowBox[{"g_Node", ",", "nl_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"al", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Ancestors", "[", 
          RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "nl"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Last", "[", 
      RowBox[{"TakeAway", "[", 
       RowBox[{
        RowBox[{"First", "[", "al", "]"}], ",", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"First", "[", "al", "]"}], ",", 
          RowBox[{"Intersection", "@@", "al"}]}], "]"}]}], "]"}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"f5da658a-b0ac-40ed-a9a7-feedc9f0dcde"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PairwiseDivergence", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"9a189c20-8817-4acd-b378-f2298e42bc83"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDivergence", "[", 
    RowBox[{"g_Node", ",", "nl_List"}], "]"}], ":=", 
   RowBox[{"First", "[", 
    RowBox[{"ExtractInformation", "[", 
     RowBox[{"g", ",", 
      RowBox[{"MRCA", "[", 
       RowBox[{"g", ",", "nl"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDivergence", "[", "g_Node", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"PairwiseDivergence", "[", 
      RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Union", "[", 
     RowBox[{"Sort", "/@", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"List", ",", 
            RowBox[{"Leaves", "[", "g", "]"}], ",", 
            RowBox[{"Leaves", "[", "g", "]"}]}], "]"}], ",", "1"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "a_"}], "}"}]}], "]"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"ffb504e0-13dd-4dd2-8383-5e6a0c10f0c5"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairwiseDifference", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"748ef7e7-62ae-4453-9b59-5681ba6bd1ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDifference", "[", 
    RowBox[{"g_Node", ",", "nl_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ml", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ExtractInformation", "[", 
           RowBox[{"g", ",", "#"}], "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], "&"}], "/@", "nl"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Union", "@@", "ml"}], ",", 
       RowBox[{"Intersection", "@@", "ml"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDifference", "[", "g_Node", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"PairwiseDifference", "[", 
       RowBox[{"g", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Union", "[", 
     RowBox[{"Sort", "/@", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"List", ",", 
            RowBox[{"Leaves", "[", "g", "]"}], ",", 
            RowBox[{"Leaves", "[", "g", "]"}]}], "]"}], ",", "1"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "a_"}], "}"}]}], "]"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"fccb1d1a-c18e-4aa5-8815-26e119c1a23c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MeanPairwiseDivergence", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"474941d6-6e24-4b0e-a754-43dc97b16119"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanPairwiseDivergence", "[", "g_Node", "]"}], ":=", 
   RowBox[{"Mean", "[", 
    RowBox[{"PairwiseDivergence", "[", "g", "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"6ed5eddc-4a8c-4fbc-9cb8-4ddf741326f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ExtractCoalescenceTimes", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"6952eed3-0ceb-4ada-9e90-a6bd56c371a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtractCoalescenceTimes", "[", "g_Node", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"First", "/@", 
     RowBox[{"ExtractInformation", "[", "g", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d5f79246-401e-4b46-aee2-53c471ed28b6"]
}, Closed]],

Cell[CellGroupData[{

Cell["LengthOfGenealogy", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"5029f2c4-0662-4410-8280-7000521804c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LengthOfGenealogy", "[", "g_Node", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ct", "=", 
       RowBox[{"ExtractCoalescenceTimes", "[", "g", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Last", "[", "ct", "]"}], "+", 
      RowBox[{"Plus", "@@", "ct"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"3b3a94de-e7cc-4d51-a083-844022a26516"]
}, Closed]],

Cell[CellGroupData[{

Cell["DepthOfGenealogy", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"8bf0ac54-7312-4e8b-8654-41d57fa52ba6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DepthOfGenealogy", "[", "g_Node", "]"}], ":=", 
   RowBox[{"Last", "[", 
    RowBox[{"ExtractCoalescenceTimes", "[", "g", "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d5a8f832-43df-48a5-ada3-b4cdfa3385de"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairwiseDivergencePlot", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"9bf220c9-316b-45b8-978f-9911e7d551db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDivergencePlot", "[", 
    RowBox[{
     RowBox[{"gl", ":", 
      RowBox[{"{", "__Node", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"dm_", ",", "d_"}], "}"}], ",", "opts___Rule"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bc", "=", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"BinCounts", "[", 
            RowBox[{
             RowBox[{"PairwiseDivergence", "[", "#", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "dm", ",", "d"}], "}"}]}], "]"}], "&"}], "/@",
           "gl"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            FractionBox["d", "2"], ",", 
            RowBox[{"dm", "-", 
             FractionBox["d", "2"]}], ",", "d"}], "]"}], ",", "bc"}], "}"}], 
        "]"}], ",", "opts"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDivergencePlot", "[", 
    RowBox[{"g_Node", ",", 
     RowBox[{"{", 
      RowBox[{"dm_", ",", "d_"}], "}"}], ",", "opts___Rule"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"PairwiseDivergencePlot", "[", 
    RowBox[{
     RowBox[{"{", "g", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"dm", ",", "d"}], "}"}], ",", "opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"e4e86824-3799-44b1-8aa9-b2fb53949cb8"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairwiseDifferencePlot", "Subsubsection",
 InitializationCell->
  True,ExpressionUUID->"612040b4-5582-43a1-a678-9e81982e98d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDifferencePlot", "[", 
    RowBox[{
     RowBox[{"gl", ":", 
      RowBox[{"{", "__Node", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"dm_", ",", "d_"}], "}"}], ",", "opts___Rule"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bc", "=", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"BinCounts", "[", 
            RowBox[{
             RowBox[{"PairwiseDifference", "[", "#", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "dm", ",", "d"}], "}"}]}], "]"}], "&"}], "/@",
           "gl"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            FractionBox["d", "2"], ",", 
            RowBox[{"dm", "-", 
             FractionBox["d", "2"]}], ",", "d"}], "]"}], ",", "bc"}], "}"}], 
        "]"}], ",", "opts"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseDifferencePlot", "[", 
    RowBox[{"g_Node", ",", 
     RowBox[{"{", 
      RowBox[{"dm_", ",", "d_"}], "}"}], ",", "opts___Rule"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"PairwiseDifferencePlot", "[", 
    RowBox[{
     RowBox[{"{", "g", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"dm", ",", "d"}], "}"}], ",", "opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"c04e1cc0-5870-486a-a86f-a0724fe82804"]
}, Closed]],

Cell[CellGroupData[{

Cell["DeleteNullLineages", "Subsubsection",ExpressionUUID->"6bde2b4c-e149-453c-bbab-c3eafc5e685c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeleteNullLineages", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"g", ",", 
     RowBox[{"AncestralLineage", "[", 
      RowBox[{"_", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}], ",", 
       RowBox[{"{", "_", "}"}], ",", "_List"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"977eba0c-85e6-4af8-b7df-0e4a2c947782"]
}, Closed]],

Cell[CellGroupData[{

Cell["BlockSizes", "Subsubsection",ExpressionUUID->"6d677373-bf17-48f0-bbf0-38558233aa4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BlockSizes", "[", 
    RowBox[{"AncestralLineage", "[", 
     RowBox[{"_", ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}], ",", "_List", ",", "_List"}], "]"}], "]"}], 
   ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockSizes", "[", 
    RowBox[{"AncestralLineage", "[", 
     RowBox[{"_", ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], ",", "_List", ",", "r_List", ",", 
      "_List"}], "]"}], "]"}], ":=", 
   RowBox[{"r", "-", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{"r", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", "0"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockSizes", "[", 
    RowBox[{"g", ":", "AncestralGraphPattern"}], "]"}], ":=", 
   RowBox[{"BlockSizes", "/@", "g"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"f5fbc811-166c-4bd8-ab50-48213f326cf9"]
}, Closed]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1114, 1075},
WindowMargins->{{219, Automatic}, {Automatic, 0}},
Visible->True,
ShowSelection->True,
InputAliases->{"notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TagBox[
       "\[Placeholder]", Utilities`Notation`NotationBoxTag, TagStyle -> 
        "NotationTemplateStyle"], " ", "\[DoubleLongLeftRightArrow]", " ", 
       TagBox[
       "\[Placeholder]", Utilities`Notation`NotationBoxTag, TagStyle -> 
        "NotationTemplateStyle"]}], "]"}], "notation>" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TagBox[
       "\[Placeholder]", Utilities`Notation`NotationBoxTag, TagStyle -> 
        "NotationTemplateStyle"], " ", "\[DoubleLongRightArrow]", " ", 
       TagBox[
       "\[Placeholder]", Utilities`Notation`NotationBoxTag, TagStyle -> 
        "NotationTemplateStyle"]}], "]"}], "notation<" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TagBox[
       "\[Placeholder]", Utilities`Notation`NotationBoxTag, TagStyle -> 
        "NotationTemplateStyle"], " ", "\[DoubleLongLeftArrow]", " ", 
       TagBox[
       "\[Placeholder]", Utilities`Notation`NotationBoxTag, TagStyle -> 
        "NotationTemplateStyle"]}], "]"}], "symb" -> RowBox[{"Symbolize", "[", 
     TagBox[
     "\[Placeholder]", Utilities`Notation`NotationBoxTag, TagStyle -> 
      "NotationTemplateStyle"], "]"}], "infixnotation" -> 
  RowBox[{"InfixNotation", "[", 
     RowBox[{
       TagBox[
       "\[Placeholder]", Utilities`Notation`NotationBoxTag, TagStyle -> 
        "NotationTemplateStyle"], ",", "\[Placeholder]"}], "]"}], "addia" -> 
  RowBox[{"AddInputAlias", "[", 
     RowBox[{"\[Placeholder]", "\[Rule]", 
       TagBox[
       "\[Placeholder]", Utilities`Notation`NotationBoxTag, TagStyle -> 
        "NotationTemplateStyle"]}], "]"}], "pattwraper" -> 
  TagBox["\[Placeholder]", Utilities`Notation`NotationPatternTag, TagStyle -> 
    "NotationPatternWrapperStyle"], "madeboxeswraper" -> 
  TagBox["\[Placeholder]", Utilities`Notation`NotationMadeBoxesTag, TagStyle -> 
    "NotationMadeBoxesWrapperStyle"], "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TagBox["\[Placeholder]", "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TagBox["\[Placeholder]", "NotationTemplateTag"]}], "]"}], "notation>" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TagBox["\[Placeholder]", "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TagBox["\[Placeholder]", "NotationTemplateTag"]}], "]"}], "notation<" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TagBox["\[Placeholder]", "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TagBox["\[Placeholder]", "NotationTemplateTag"]}], "]"}], "symb" -> 
  RowBox[{"Symbolize", "[", 
     "NotationTemplateTag"[Utilities`Notation`Private`\[Placeholder]], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       "NotationTemplateTag"[Utilities`Notation`Private`\[Placeholder]], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[Placeholder]\"", "->", 
       "NotationTemplateTag"[Utilities`Notation`Private`\[Placeholder]]}], 
     "]"}], "pattwraper" -> TagBox["\[Placeholder]", "NotationPatternTag"], 
  "madeboxeswraper" -> TagBox["\[Placeholder]", "NotationMadeBoxesTag"]},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->Notebook[{
   Cell[
    CellGroupData[{
      Cell["Style Definitions", "Subtitle"], 
      Cell[
      "Modify the definitions below to change the default appearance of all \
cells in a given style.  Make modifications to any definition using commands \
in the Format menu.", "Text"], 
      Cell[
       CellGroupData[{
         Cell["Style Environment Names", "Section"], 
         Cell[
          StyleData[All, "Working"], PageWidth -> WindowWidth, 
          CellLabelMargins -> {{12, Inherited}, {Inherited, Inherited}}, 
          ScriptMinSize -> 9], 
         Cell[
          StyleData[All, "Presentation"], PageWidth -> WindowWidth, 
          CellLabelMargins -> {{24, Inherited}, {Inherited, Inherited}}, 
          ScriptMinSize -> 12], 
         Cell[
          StyleData[All, "Condensed"], PageWidth -> WindowWidth, 
          CellLabelMargins -> {{8, Inherited}, {Inherited, Inherited}}, 
          ScriptMinSize -> 8], 
         Cell[
          StyleData[All, "Printout"], PageWidth -> PaperWidth, 
          CellLabelMargins -> {{2, Inherited}, {Inherited, Inherited}}, 
          ScriptMinSize -> 5, 
          PrivateFontOptions -> {"FontType" -> "Outline"}]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Notebook Options", "Section"], 
         Cell[
         "The options defined for the style below will be used at the \
Notebook level.", "Text"], 
         Cell[
          StyleData["Notebook"], PageHeaders -> {{
             Cell[
              TextData[{
                CounterBox["Page"]}], "PageNumber"], None, 
             Cell[
              TextData[{
                ValueBox["FileName"]}], "Header"]}, {
             Cell[
              TextData[{
                ValueBox["FileName"]}], "Header"], None, 
             Cell[
              TextData[{
                CounterBox["Page"]}], "PageNumber"]}}, CellFrameLabelMargins -> 
          6, StyleMenuListing -> None]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Headings", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Title"], CellMargins -> {{12, Inherited}, {20, 40}}, 
             CellGroupingRules -> {"TitleGrouping", 0}, PageBreakBelow -> 
             False, DefaultNewInlineCellStyle -> "None", 
             InputAutoReplacements -> {"TeX" -> StyleBox[
                 RowBox[{"T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "LaTeX" -> StyleBox[
                 RowBox[{"L", 
                   StyleBox[
                    AdjustmentBox[
                    "A", BoxMargins -> {{-0.36, -0.1}, {0, 0}}, 
                    BoxBaselineShift -> -0.2], FontSize -> Smaller], "T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "mma" -> "Mathematica", 
               "Mma" -> "Mathematica", "MMA" -> "Mathematica"}, 
             LanguageCategory -> "NaturalLanguage", CounterIncrements -> 
             "Title", 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}, {"Subtitle", 0}, {"Subsubtitle", 0}}, FontFamily -> 
             "Helvetica", FontSize -> 36, FontWeight -> "Bold"], 
            Cell[
             StyleData["Title", "Presentation"], 
             CellMargins -> {{24, 10}, {20, 40}}, LineSpacing -> {1, 0}, 
             FontSize -> 44], 
            Cell[
             StyleData["Title", "Condensed"], 
             CellMargins -> {{8, 10}, {4, 8}}, FontSize -> 20], 
            Cell[
             StyleData["Title", "Printout"], 
             CellMargins -> {{2, 10}, {12, 30}}, FontSize -> 24]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subtitle"], 
             CellMargins -> {{12, Inherited}, {20, 15}}, 
             CellGroupingRules -> {"TitleGrouping", 10}, PageBreakBelow -> 
             False, DefaultNewInlineCellStyle -> "None", 
             InputAutoReplacements -> {"TeX" -> StyleBox[
                 RowBox[{"T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "LaTeX" -> StyleBox[
                 RowBox[{"L", 
                   StyleBox[
                    AdjustmentBox[
                    "A", BoxMargins -> {{-0.36, -0.1}, {0, 0}}, 
                    BoxBaselineShift -> -0.2], FontSize -> Smaller], "T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "mma" -> "Mathematica", 
               "Mma" -> "Mathematica", "MMA" -> "Mathematica"}, 
             LanguageCategory -> "NaturalLanguage", CounterIncrements -> 
             "Subtitle", 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}, {"Subsubtitle", 0}}, FontFamily -> "Helvetica", 
             FontSize -> 24], 
            Cell[
             StyleData["Subtitle", "Presentation"], 
             CellMargins -> {{24, 10}, {20, 20}}, LineSpacing -> {1, 0}, 
             FontSize -> 36], 
            Cell[
             StyleData["Subtitle", "Condensed"], 
             CellMargins -> {{8, 10}, {4, 4}}, FontSize -> 14], 
            Cell[
             StyleData["Subtitle", "Printout"], 
             CellMargins -> {{2, 10}, {12, 8}}, FontSize -> 18]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsubtitle"], 
             CellMargins -> {{12, Inherited}, {20, 15}}, 
             CellGroupingRules -> {"TitleGrouping", 20}, PageBreakBelow -> 
             False, DefaultNewInlineCellStyle -> "None", 
             InputAutoReplacements -> {"TeX" -> StyleBox[
                 RowBox[{"T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "LaTeX" -> StyleBox[
                 RowBox[{"L", 
                   StyleBox[
                    AdjustmentBox[
                    "A", BoxMargins -> {{-0.36, -0.1}, {0, 0}}, 
                    BoxBaselineShift -> -0.2], FontSize -> Smaller], "T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "mma" -> "Mathematica", 
               "Mma" -> "Mathematica", "MMA" -> "Mathematica"}, 
             LanguageCategory -> "NaturalLanguage", CounterIncrements -> 
             "Subsubtitle", 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}}, FontFamily -> "Helvetica", FontSize -> 14, 
             FontSlant -> "Italic"], 
            Cell[
             StyleData["Subsubtitle", "Presentation"], 
             CellMargins -> {{24, 10}, {20, 20}}, LineSpacing -> {1, 0}, 
             FontSize -> 24], 
            Cell[
             StyleData["Subsubtitle", "Condensed"], 
             CellMargins -> {{8, 10}, {8, 8}}, FontSize -> 12], 
            Cell[
             StyleData["Subsubtitle", "Printout"], 
             CellMargins -> {{2, 10}, {12, 8}}, FontSize -> 14]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Section"], CellDingbat -> "\[FilledSquare]", 
             CellMargins -> {{25, Inherited}, {8, 24}}, 
             CellGroupingRules -> {"SectionGrouping", 30}, PageBreakBelow -> 
             False, DefaultNewInlineCellStyle -> "None", 
             InputAutoReplacements -> {"TeX" -> StyleBox[
                 RowBox[{"T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "LaTeX" -> StyleBox[
                 RowBox[{"L", 
                   StyleBox[
                    AdjustmentBox[
                    "A", BoxMargins -> {{-0.36, -0.1}, {0, 0}}, 
                    BoxBaselineShift -> -0.2], FontSize -> Smaller], "T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "mma" -> "Mathematica", 
               "Mma" -> "Mathematica", "MMA" -> "Mathematica"}, 
             LanguageCategory -> "NaturalLanguage", CounterIncrements -> 
             "Section", 
             CounterAssignments -> {{"Subsection", 0}, {"Subsubsection", 0}}, 
             FontFamily -> "Helvetica", FontSize -> 16, FontWeight -> "Bold"], 
            Cell[
             StyleData["Section", "Presentation"], 
             CellMargins -> {{40, 10}, {11, 32}}, LineSpacing -> {1, 0}, 
             FontSize -> 24], 
            Cell[
             StyleData["Section", "Condensed"], 
             CellMargins -> {{18, Inherited}, {6, 12}}, FontSize -> 12], 
            Cell[
             StyleData["Section", "Printout"], 
             CellMargins -> {{13, 0}, {7, 22}}, FontSize -> 14]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsection"], CellDingbat -> "\[FilledSmallSquare]", 
             CellMargins -> {{22, Inherited}, {8, 20}}, 
             CellGroupingRules -> {"SectionGrouping", 40}, PageBreakBelow -> 
             False, DefaultNewInlineCellStyle -> "None", 
             InputAutoReplacements -> {"TeX" -> StyleBox[
                 RowBox[{"T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "LaTeX" -> StyleBox[
                 RowBox[{"L", 
                   StyleBox[
                    AdjustmentBox[
                    "A", BoxMargins -> {{-0.36, -0.1}, {0, 0}}, 
                    BoxBaselineShift -> -0.2], FontSize -> Smaller], "T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "mma" -> "Mathematica", 
               "Mma" -> "Mathematica", "MMA" -> "Mathematica"}, 
             LanguageCategory -> "NaturalLanguage", CounterIncrements -> 
             "Subsection", CounterAssignments -> {{"Subsubsection", 0}}, 
             FontFamily -> "Times", FontSize -> 14, FontWeight -> "Bold"], 
            Cell[
             StyleData["Subsection", "Presentation"], 
             CellMargins -> {{36, 10}, {11, 32}}, LineSpacing -> {1, 0}, 
             FontSize -> 22], 
            Cell[
             StyleData["Subsection", "Condensed"], 
             CellMargins -> {{16, Inherited}, {6, 12}}, FontSize -> 12], 
            Cell[
             StyleData["Subsection", "Printout"], 
             CellMargins -> {{9, 0}, {7, 22}}, FontSize -> 12]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsubsection"], CellDingbat -> 
             "\[FilledSmallSquare]", 
             CellMargins -> {{22, Inherited}, {8, 18}}, 
             CellGroupingRules -> {"SectionGrouping", 50}, PageBreakBelow -> 
             False, DefaultNewInlineCellStyle -> "None", 
             InputAutoReplacements -> {"TeX" -> StyleBox[
                 RowBox[{"T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "LaTeX" -> StyleBox[
                 RowBox[{"L", 
                   StyleBox[
                    AdjustmentBox[
                    "A", BoxMargins -> {{-0.36, -0.1}, {0, 0}}, 
                    BoxBaselineShift -> -0.2], FontSize -> Smaller], "T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "mma" -> "Mathematica", 
               "Mma" -> "Mathematica", "MMA" -> "Mathematica"}, 
             LanguageCategory -> "NaturalLanguage", CounterIncrements -> 
             "Subsubsection", FontFamily -> "Times", FontWeight -> "Bold"], 
            Cell[
             StyleData["Subsubsection", "Presentation"], 
             CellMargins -> {{34, 10}, {11, 26}}, LineSpacing -> {1, 0}, 
             FontSize -> 18], 
            Cell[
             StyleData["Subsubsection", "Condensed"], 
             CellMargins -> {{17, Inherited}, {6, 12}}, FontSize -> 10], 
            Cell[
             StyleData["Subsubsection", "Printout"], 
             CellMargins -> {{9, 0}, {7, 14}}, FontSize -> 11]}, Closed]]}, 
        Closed]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Body Text", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Text"], CellMargins -> {{12, 10}, {7, 7}}, 
             InputAutoReplacements -> {"TeX" -> StyleBox[
                 RowBox[{"T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "LaTeX" -> StyleBox[
                 RowBox[{"L", 
                   StyleBox[
                    AdjustmentBox[
                    "A", BoxMargins -> {{-0.36, -0.1}, {0, 0}}, 
                    BoxBaselineShift -> -0.2], FontSize -> Smaller], "T", 
                   AdjustmentBox[
                   "E", BoxMargins -> {{-0.075, -0.085}, {0, 0}}, 
                    BoxBaselineShift -> 0.5], "X"}]], "mma" -> "Mathematica", 
               "Mma" -> "Mathematica", "MMA" -> "Mathematica"}, Hyphenation -> 
             True, LineSpacing -> {1, 3}, CounterIncrements -> "Text"], 
            Cell[
             StyleData["Text", "Presentation"], 
             CellMargins -> {{24, 10}, {10, 10}}, LineSpacing -> {1, 5}, 
             FontSize -> 16], 
            Cell[
             StyleData["Text", "Condensed"], CellMargins -> {{8, 10}, {6, 6}},
              LineSpacing -> {1, 1}, FontSize -> 11], 
            Cell[
             StyleData["Text", "Printout"], CellMargins -> {{2, 2}, {6, 6}}, 
             TextJustification -> 0.5, FontSize -> 10]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["SmallText"], CellMargins -> {{12, 10}, {6, 6}}, 
             DefaultNewInlineCellStyle -> "None", Hyphenation -> True, 
             LineSpacing -> {1, 3}, LanguageCategory -> "NaturalLanguage", 
             CounterIncrements -> "SmallText", FontFamily -> "Helvetica", 
             FontSize -> 9], 
            Cell[
             StyleData["SmallText", "Presentation"], 
             CellMargins -> {{24, 10}, {8, 8}}, LineSpacing -> {1, 5}, 
             FontSize -> 12], 
            Cell[
             StyleData["SmallText", "Condensed"], 
             CellMargins -> {{8, 10}, {5, 5}}, LineSpacing -> {1, 2}, 
             FontSize -> 9], 
            Cell[
             StyleData["SmallText", "Printout"], 
             CellMargins -> {{2, 2}, {5, 5}}, TextJustification -> 0.5, 
             FontSize -> 7]}, Closed]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Input/Output", "Section"], 
         Cell[
         "The cells in this section define styles used for input and output \
to the kernel.  Be careful when modifying, renaming, or removing these \
styles, because the front end associates special meanings with these style \
names. Some attributes for these styles are actually set in FormatType Styles \
(in the last section of this stylesheet). ", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Input"], CellMargins -> {{45, 10}, {5, 7}}, 
             Evaluatable -> True, CellGroupingRules -> "InputGrouping", 
             CellHorizontalScrolling -> True, PageBreakWithin -> False, 
             GroupPageBreakWithin -> False, DefaultFormatType -> 
             DefaultInputFormatType, 
             HyphenationOptions -> {
              "HyphenationCharacter" -> "\[Continuation]"}, 
             AutoItalicWords -> {}, LanguageCategory -> "Formula", FormatType -> 
             InputForm, ShowStringCharacters -> True, NumberMarks -> True, 
             LinebreakAdjustments -> {0.85, 2, 10, 0, 1}, CounterIncrements -> 
             "Input", FontWeight -> "Bold"], 
            Cell[
             StyleData["Input", "Presentation"], 
             CellMargins -> {{72, Inherited}, {8, 10}}, LineSpacing -> {1, 0},
              FontSize -> 16], 
            Cell[
             StyleData["Input", "Condensed"], 
             CellMargins -> {{40, 10}, {2, 3}}, FontSize -> 11], 
            Cell[
             StyleData["Input", "Printout"], CellMargins -> {{39, 0}, {4, 6}},
              LinebreakAdjustments -> {0.85, 2, 10, 1, 1}, FontSize -> 9]}, 
           Closed]], 
         Cell[
          StyleData["InputOnly"], Evaluatable -> True, CellGroupingRules -> 
          "InputGrouping", CellHorizontalScrolling -> True, DefaultFormatType -> 
          DefaultInputFormatType, 
          HyphenationOptions -> {"HyphenationCharacter" -> "\[Continuation]"},
           AutoItalicWords -> {}, LanguageCategory -> "Formula", FormatType -> 
          InputForm, ShowStringCharacters -> True, NumberMarks -> True, 
          LinebreakAdjustments -> {0.85, 2, 10, 0, 1}, CounterIncrements -> 
          "Input", StyleMenuListing -> None, FontWeight -> "Bold"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Output"], CellMargins -> {{47, 10}, {7, 5}}, 
             CellEditDuplicate -> True, CellGroupingRules -> "OutputGrouping",
              CellHorizontalScrolling -> True, PageBreakWithin -> False, 
             GroupPageBreakWithin -> False, GeneratedCell -> True, 
             CellAutoOverwrite -> True, DefaultFormatType -> 
             DefaultOutputFormatType, 
             HyphenationOptions -> {
              "HyphenationCharacter" -> "\[Continuation]"}, 
             AutoItalicWords -> {}, LanguageCategory -> "Formula", FormatType -> 
             InputForm, CounterIncrements -> "Output"], 
            Cell[
             StyleData["Output", "Presentation"], 
             CellMargins -> {{72, Inherited}, {10, 8}}, LineSpacing -> {1, 0},
              FontSize -> 16], 
            Cell[
             StyleData["Output", "Condensed"], 
             CellMargins -> {{41, Inherited}, {3, 2}}, FontSize -> 11], 
            Cell[
             StyleData["Output", "Printout"], 
             CellMargins -> {{39, 0}, {6, 4}}, FontSize -> 9]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Message"], 
             CellMargins -> {{45, Inherited}, {Inherited, Inherited}}, 
             CellGroupingRules -> "OutputGrouping", PageBreakWithin -> False, 
             GroupPageBreakWithin -> False, GeneratedCell -> True, 
             CellAutoOverwrite -> True, ShowCellLabel -> False, 
             DefaultFormatType -> DefaultOutputFormatType, 
             HyphenationOptions -> {
              "HyphenationCharacter" -> "\[Continuation]"}, 
             AutoItalicWords -> {}, FormatType -> InputForm, 
             CounterIncrements -> "Message", StyleMenuListing -> None, 
             FontSize -> 11, FontColor -> RGBColor[0, 0, 1]], 
            Cell[
             StyleData["Message", "Presentation"], 
             CellMargins -> {{72, Inherited}, {Inherited, Inherited}}, 
             LineSpacing -> {1, 0}, FontSize -> 16], 
            Cell[
             StyleData["Message", "Condensed"], 
             CellMargins -> {{41, Inherited}, {Inherited, Inherited}}, 
             FontSize -> 11], 
            Cell[
             StyleData["Message", "Printout"], 
             CellMargins -> {{39, Inherited}, {Inherited, Inherited}}, 
             FontSize -> 7, FontColor -> GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Print"], 
             CellMargins -> {{45, Inherited}, {Inherited, Inherited}}, 
             CellGroupingRules -> "OutputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             GeneratedCell -> True, CellAutoOverwrite -> True, ShowCellLabel -> 
             False, DefaultFormatType -> DefaultOutputFormatType, 
             HyphenationOptions -> {
              "HyphenationCharacter" -> "\[Continuation]"}, 
             AutoItalicWords -> {}, FormatType -> InputForm, 
             CounterIncrements -> "Print", StyleMenuListing -> None], 
            Cell[
             StyleData["Print", "Presentation"], 
             CellMargins -> {{72, Inherited}, {Inherited, Inherited}}, 
             LineSpacing -> {1, 0}, FontSize -> 16], 
            Cell[
             StyleData["Print", "Condensed"], 
             CellMargins -> {{41, Inherited}, {Inherited, Inherited}}, 
             FontSize -> 11], 
            Cell[
             StyleData["Print", "Printout"], 
             CellMargins -> {{39, Inherited}, {Inherited, Inherited}}, 
             FontSize -> 8]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Graphics"], 
             CellMargins -> {{4, Inherited}, {Inherited, Inherited}}, 
             CellGroupingRules -> "GraphicsGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GeneratedCell -> True, 
             CellAutoOverwrite -> True, ShowCellLabel -> False, 
             DefaultFormatType -> DefaultOutputFormatType, LanguageCategory -> 
             None, FormatType -> InputForm, CounterIncrements -> "Graphics", 
             ImageMargins -> {{43, Inherited}, {Inherited, 0}}, 
             StyleMenuListing -> None, FontFamily -> "Courier", FontSize -> 
             10], 
            Cell[
             StyleData["Graphics", "Presentation"], 
             ImageMargins -> {{62, Inherited}, {Inherited, 0}}], 
            Cell[
             StyleData["Graphics", "Condensed"], 
             ImageMargins -> {{38, Inherited}, {Inherited, 0}}, Magnification -> 
             0.6], 
            Cell[
             StyleData["Graphics", "Printout"], 
             ImageMargins -> {{30, Inherited}, {Inherited, 0}}, Magnification -> 
             0.8]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["CellLabel"], StyleMenuListing -> None, FontFamily -> 
             "Helvetica", FontSize -> 9, FontColor -> RGBColor[0, 0, 1]], 
            Cell[
             StyleData["CellLabel", "Presentation"], FontSize -> 12], 
            Cell[
             StyleData["CellLabel", "Condensed"], FontSize -> 9], 
            Cell[
             StyleData["CellLabel", "Printout"], FontFamily -> "Courier", 
             FontSize -> 8, FontSlant -> "Italic", FontColor -> 
             GrayLevel[0]]}, Closed]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Inline Formatting", "Section"], 
         Cell[
         "These styles are for modifying individual words or letters in a \
cell exclusive of the cell tag.", "Text"], 
         Cell[
          StyleData["RM"], StyleMenuListing -> None, FontWeight -> "Plain", 
          FontSlant -> "Plain"], 
         Cell[
          StyleData["BF"], StyleMenuListing -> None, FontWeight -> "Bold"], 
         Cell[
          StyleData["IT"], StyleMenuListing -> None, FontSlant -> "Italic"], 
         Cell[
          StyleData["TR"], StyleMenuListing -> None, FontFamily -> "Times", 
          FontWeight -> "Plain", FontSlant -> "Plain"], 
         Cell[
          StyleData["TI"], StyleMenuListing -> None, FontFamily -> "Times", 
          FontWeight -> "Plain", FontSlant -> "Italic"], 
         Cell[
          StyleData["TB"], StyleMenuListing -> None, FontFamily -> "Times", 
          FontWeight -> "Bold", FontSlant -> "Plain"], 
         Cell[
          StyleData["TBI"], StyleMenuListing -> None, FontFamily -> "Times", 
          FontWeight -> "Bold", FontSlant -> "Italic"], 
         Cell[
          StyleData["MR"], StyleMenuListing -> None, FontFamily -> "Courier", 
          FontWeight -> "Plain", FontSlant -> "Plain"], 
         Cell[
          StyleData["MO"], StyleMenuListing -> None, FontFamily -> "Courier", 
          FontWeight -> "Plain", FontSlant -> "Italic"], 
         Cell[
          StyleData["MB"], StyleMenuListing -> None, FontFamily -> "Courier", 
          FontWeight -> "Bold", FontSlant -> "Plain"], 
         Cell[
          StyleData["MBO"], StyleMenuListing -> None, FontFamily -> "Courier",
           FontWeight -> "Bold", FontSlant -> "Italic"], 
         Cell[
          StyleData["SR"], StyleMenuListing -> None, FontFamily -> 
          "Helvetica", FontWeight -> "Plain", FontSlant -> "Plain"], 
         Cell[
          StyleData["SO"], StyleMenuListing -> None, FontFamily -> 
          "Helvetica", FontWeight -> "Plain", FontSlant -> "Italic"], 
         Cell[
          StyleData["SB"], StyleMenuListing -> None, FontFamily -> 
          "Helvetica", FontWeight -> "Bold", FontSlant -> "Plain"], 
         Cell[
          StyleData["SBO"], StyleMenuListing -> None, FontFamily -> 
          "Helvetica", FontWeight -> "Bold", FontSlant -> "Italic"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["SO10"], StyleMenuListing -> None, FontFamily -> 
             "Helvetica", FontSize -> 10, FontWeight -> "Plain", FontSlant -> 
             "Italic"], 
            Cell[
             StyleData["SO10", "Printout"], StyleMenuListing -> None, 
             FontFamily -> "Helvetica", FontSize -> 7, FontWeight -> "Plain", 
             FontSlant -> "Italic"], 
            Cell[
             StyleData["SO10", "EnhancedPrintout"], StyleMenuListing -> None, 
             FontFamily -> "Futura", FontSize -> 7, FontWeight -> "Plain", 
             FontSlant -> "Italic"]}, Closed]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Formulas and Programming", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["InlineFormula"], CellMargins -> {{10, 4}, {0, 8}}, 
             CellHorizontalScrolling -> True, 
             HyphenationOptions -> {
              "HyphenationCharacter" -> "\[Continuation]"}, LanguageCategory -> 
             "Formula", ScriptLevel -> 1, SingleLetterItalics -> True], 
            Cell[
             StyleData["InlineFormula", "Presentation"], 
             CellMargins -> {{24, 10}, {10, 10}}, LineSpacing -> {1, 5}, 
             FontSize -> 16], 
            Cell[
             StyleData["InlineFormula", "Condensed"], 
             CellMargins -> {{8, 10}, {6, 6}}, LineSpacing -> {1, 1}, 
             FontSize -> 11], 
            Cell[
             StyleData["InlineFormula", "Printout"], 
             CellMargins -> {{2, 0}, {6, 6}}, FontSize -> 10]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["DisplayFormula"], 
             CellMargins -> {{42, Inherited}, {Inherited, Inherited}}, 
             CellHorizontalScrolling -> True, DefaultFormatType -> 
             DefaultInputFormatType, 
             HyphenationOptions -> {
              "HyphenationCharacter" -> "\[Continuation]"}, LanguageCategory -> 
             "Formula", ScriptLevel -> 0, SingleLetterItalics -> True, 
             UnderoverscriptBoxOptions -> {LimitsPositioning -> True}], 
            Cell[
             StyleData["DisplayFormula", "Presentation"], 
             LineSpacing -> {1, 5}, FontSize -> 16], 
            Cell[
             StyleData["DisplayFormula", "Condensed"], LineSpacing -> {1, 1}, 
             FontSize -> 11], 
            Cell[
             StyleData["DisplayFormula", "Printout"], FontSize -> 10]}, 
           Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Program"], CellFrame -> {{0, 0}, {0.5, 0.5}}, 
             CellMargins -> {{10, 4}, {0, 8}}, CellHorizontalScrolling -> 
             True, LanguageCategory -> "Formula", ScriptLevel -> 1, 
             FontFamily -> "Courier"], 
            Cell[
             StyleData["Program", "Presentation"], 
             CellMargins -> {{24, 10}, {10, 10}}, LineSpacing -> {1, 5}, 
             FontSize -> 16], 
            Cell[
             StyleData["Program", "Condensed"], 
             CellMargins -> {{8, 10}, {6, 6}}, LineSpacing -> {1, 1}, 
             FontSize -> 11], 
            Cell[
             StyleData["Program", "Printout"], 
             CellMargins -> {{2, 0}, {6, 6}}, FontSize -> 9]}, Closed]]}, 
        Closed]], 
      Cell[
       CellGroupData[{
         Cell["Hyperlink Styles", "Section"], 
         Cell[
         "The cells below define styles useful for making hypertext \
ButtonBoxes.  The \"Hyperlink\" style is for links within the same Notebook, \
or between Notebooks.", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Hyperlink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, 
             FontVariations -> {"Underline" -> True}, FontColor -> 
             RGBColor[0, 0, 1], 
             ButtonBoxOptions -> {
              Active -> True, ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`NotebookLocate[#2]}]& ), ButtonNote -> 
               ButtonData}], 
            Cell[
             StyleData["Hyperlink", "Presentation"], FontSize -> 16], 
            Cell[
             StyleData["Hyperlink", "Condensed"], FontSize -> 11], 
            Cell[
             StyleData["Hyperlink", "Printout"], FontSize -> 10, 
             FontVariations -> {"Underline" -> False}, FontColor -> 
             GrayLevel[0]]}, Closed]], 
         Cell[
         "The following styles are for linking automatically to the on-line \
help system.", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["MainBookLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, 
             FontVariations -> {"Underline" -> True}, FontColor -> 
             RGBColor[0, 0, 1], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["MainBook", #]}]& )}], 
            Cell[
             StyleData["MainBookLink", "Presentation"], FontSize -> 16], 
            Cell[
             StyleData["MainBookLink", "Condensed"], FontSize -> 11], 
            Cell[
             StyleData["MainBookLink", "Printout"], FontSize -> 10, 
             FontVariations -> {"Underline" -> False}, FontColor -> 
             GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["AddOnsLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, FontFamily -> "Courier", 
             FontVariations -> {"Underline" -> True}, FontColor -> 
             RGBColor[0, 0, 1], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["AddOns", #]}]& )}], 
            Cell[
             StyleData["AddOnsLink", "Presentation"], FontSize -> 16], 
            Cell[
             StyleData["AddOnsLink", "Condensed"], FontSize -> 11], 
            Cell[
             StyleData["AddOnsLink", "Printout"], FontSize -> 10, 
             FontVariations -> {"Underline" -> False}, FontColor -> 
             GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["RefGuideLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, FontFamily -> "Courier", 
             FontVariations -> {"Underline" -> True}, FontColor -> 
             RGBColor[0, 0, 1], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["RefGuide", #]}]& )}], 
            Cell[
             StyleData["RefGuideLink", "Presentation"], FontSize -> 16], 
            Cell[
             StyleData["RefGuideLink", "Condensed"], FontSize -> 11], 
            Cell[
             StyleData["RefGuideLink", "Printout"], FontSize -> 10, 
             FontVariations -> {"Underline" -> False}, FontColor -> 
             GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["GettingStartedLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, 
             FontVariations -> {"Underline" -> True}, FontColor -> 
             RGBColor[0, 0, 1], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["GettingStarted", #]}]& )}], 
            Cell[
             StyleData["GettingStartedLink", "Presentation"], FontSize -> 16], 
            Cell[
             StyleData["GettingStartedLink", "Condensed"], FontSize -> 11], 
            Cell[
             StyleData["GettingStartedLink", "Printout"], FontSize -> 10, 
             FontVariations -> {"Underline" -> False}, FontColor -> 
             GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["OtherInformationLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, 
             FontVariations -> {"Underline" -> True}, FontColor -> 
             RGBColor[0, 0, 1], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["OtherInformation", #]}]& )}], 
            Cell[
             StyleData["OtherInformationLink", "Presentation"], FontSize -> 
             16], 
            Cell[
             StyleData["OtherInformationLink", "Condensed"], FontSize -> 11], 
            Cell[
             StyleData["OtherInformationLink", "Printout"], FontSize -> 10, 
             FontVariations -> {"Underline" -> False}, FontColor -> 
             GrayLevel[0]]}, Closed]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Headers and Footers", "Section"], 
         Cell[
          StyleData["Header"], CellMargins -> {{0, 0}, {4, 1}}, 
          DefaultNewInlineCellStyle -> "None", LanguageCategory -> 
          "NaturalLanguage", StyleMenuListing -> None, FontSize -> 10, 
          FontSlant -> "Italic"], 
         Cell[
          StyleData["Footer"], CellMargins -> {{0, 0}, {0, 4}}, 
          DefaultNewInlineCellStyle -> "None", LanguageCategory -> 
          "NaturalLanguage", StyleMenuListing -> None, FontSize -> 9, 
          FontSlant -> "Italic"], 
         Cell[
          StyleData["PageNumber"], CellMargins -> {{0, 0}, {4, 1}}, 
          StyleMenuListing -> None, FontFamily -> "Times", FontSize -> 10]}, 
        Closed]], 
      Cell[
       CellGroupData[{
         Cell["Palette Styles", "Section"], 
         Cell[
         "The cells below define styles that define standard ButtonFunctions, \
for use in palette buttons.", "Text"], 
         Cell[
          StyleData["Paste"], StyleMenuListing -> None, 
          ButtonStyleMenuListing -> Automatic, 
          ButtonBoxOptions -> {ButtonFunction :> (FrontEndExecute[{
               FrontEnd`NotebookApply[
                FrontEnd`InputNotebook[], #, After]}]& )}], 
         Cell[
          StyleData["Evaluate"], StyleMenuListing -> None, 
          ButtonStyleMenuListing -> Automatic, 
          ButtonBoxOptions -> {ButtonFunction :> (FrontEndExecute[{
               FrontEnd`NotebookApply[
                FrontEnd`InputNotebook[], #, All], 
               SelectionEvaluate[
                FrontEnd`InputNotebook[], All]}]& )}], 
         Cell[
          StyleData["EvaluateCell"], StyleMenuListing -> None, 
          ButtonStyleMenuListing -> Automatic, 
          ButtonBoxOptions -> {ButtonFunction :> (FrontEndExecute[{
               FrontEnd`NotebookApply[
                FrontEnd`InputNotebook[], #, All], 
               FrontEnd`SelectionMove[
                FrontEnd`InputNotebook[], All, Cell, 1], 
               FrontEnd`SelectionEvaluateCreateCell[
                FrontEnd`InputNotebook[], All]}]& )}], 
         Cell[
          StyleData["CopyEvaluate"], StyleMenuListing -> None, 
          ButtonStyleMenuListing -> Automatic, 
          ButtonBoxOptions -> {ButtonFunction :> (FrontEndExecute[{
               FrontEnd`SelectionCreateCell[
                FrontEnd`InputNotebook[], All], 
               FrontEnd`NotebookApply[
                FrontEnd`InputNotebook[], #, All], 
               FrontEnd`SelectionEvaluate[
                FrontEnd`InputNotebook[], All]}]& )}], 
         Cell[
          StyleData["CopyEvaluateCell"], StyleMenuListing -> None, 
          ButtonStyleMenuListing -> Automatic, 
          ButtonBoxOptions -> {ButtonFunction :> (FrontEndExecute[{
               FrontEnd`SelectionCreateCell[
                FrontEnd`InputNotebook[], All], 
               FrontEnd`NotebookApply[
                FrontEnd`InputNotebook[], #, All], 
               FrontEnd`SelectionEvaluateCreateCell[
                FrontEnd`InputNotebook[], All]}]& )}]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Placeholder Styles", "Section"], 
         Cell[
         "The cells below define styles useful for making placeholder objects \
in palette templates.", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Placeholder"], Placeholder -> True, StyleMenuListing -> 
             None, FontSlant -> "Italic", FontColor -> 
             RGBColor[0.890623, 0.864698, 0.384756], 
             TagBoxOptions -> {
              Editable -> False, Selectable -> False, StripWrapperBoxes -> 
               False}], 
            Cell[
             StyleData["Placeholder", "Presentation"]], 
            Cell[
             StyleData["Placeholder", "Condensed"]], 
            Cell[
             StyleData["Placeholder", "Printout"]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["PrimaryPlaceholder"], StyleMenuListing -> None, 
             DrawHighlighted -> True, FontSlant -> "Italic", Background -> 
             RGBColor[0.912505, 0.891798, 0.507774], 
             TagBoxOptions -> {
              Editable -> False, Selectable -> False, StripWrapperBoxes -> 
               False}], 
            Cell[
             StyleData["PrimaryPlaceholder", "Presentation"]], 
            Cell[
             StyleData["PrimaryPlaceholder", "Condensed"]], 
            Cell[
             StyleData["PrimaryPlaceholder", "Printout"]]}, Closed]]}, 
        Closed]], 
      Cell[
       CellGroupData[{
         Cell["FormatType Styles", "Section"], 
         Cell[
         "The cells below define styles that are mixed in with the styles of \
most cells.  If a cell's FormatType matches the name of one of the styles \
defined below, then that style is applied between the cell's style and its \
own options. This is particularly true of Input and Output.", "Text"], 
         Cell[
          StyleData["CellExpression"], PageWidth -> Infinity, 
          CellMargins -> {{6, Inherited}, {Inherited, Inherited}}, 
          ShowCellLabel -> False, ShowSpecialCharacters -> False, 
          AllowInlineCells -> False, Hyphenation -> False, 
          AutoItalicWords -> {}, StyleMenuListing -> None, FontFamily -> 
          "Courier", FontSize -> 12, Background -> GrayLevel[1]], 
         Cell[
          StyleData["InputForm"], InputAutoReplacements -> {}, 
          AllowInlineCells -> False, Hyphenation -> False, StyleMenuListing -> 
          None, FontFamily -> "Courier"], 
         Cell[
          StyleData["OutputForm"], PageWidth -> Infinity, TextAlignment -> 
          Left, LineSpacing -> {0.6, 1}, StyleMenuListing -> None, FontFamily -> 
          "Courier"], 
         Cell[
          StyleData["StandardForm"], 
          InputAutoReplacements -> {
           "->" -> "\[Rule]", ":>" -> "\[RuleDelayed]", "<=" -> 
            "\[LessEqual]", ">=" -> "\[GreaterEqual]", "!=" -> "\[NotEqual]", 
            "==" -> "\[Equal]", Inherited}, LineSpacing -> {1.25, 0}, 
          StyleMenuListing -> None, FontFamily -> "Courier"], 
         Cell[
          StyleData["TraditionalForm"], 
          InputAutoReplacements -> {
           "->" -> "\[Rule]", ":>" -> "\[RuleDelayed]", "<=" -> 
            "\[LessEqual]", ">=" -> "\[GreaterEqual]", "!=" -> "\[NotEqual]", 
            "==" -> "\[Equal]", Inherited}, LineSpacing -> {1.25, 0}, 
          SingleLetterItalics -> True, TraditionalFunctionNotation -> True, 
          DelimiterMatching -> None, StyleMenuListing -> None], 
         Cell[
         "The style defined below is mixed in to any cell that is in an \
inline cell within another.", "Text"], 
         Cell[
          StyleData["InlineCell"], TextAlignment -> Left, ScriptLevel -> 1, 
          StyleMenuListing -> None], 
         Cell[
          StyleData["InlineCellEditing"], StyleMenuListing -> None, 
          Background -> RGBColor[1, 0.749996, 0.8]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Automatic Styles", "Section"], 
         Cell[
         "The cells below define styles that are used to affect the display \
of certain types of objects in typeset expressions.  For example, \
\"UnmatchedBracket\" style defines how unmatched bracket, curly bracket, and \
parenthesis characters are displayed (typically by coloring them to make them \
stand out).", "Text"], 
         Cell[
          StyleData["UnmatchedBracket"], StyleMenuListing -> None, FontColor -> 
          RGBColor[0.760006, 0.330007, 0.8]]}, Closed]]}, Open]], 
   Cell[
    CellGroupData[{
      Cell[
      "Notation Package Styles", "Section", GeneratedCell -> True, CellTags -> 
       "NotationPackage"], 
      Cell[
      "The cells below define certain styles needed by the Notation package. \
These styles serve to make visible otherwise invisible tagboxes.", "Text", 
       GeneratedCell -> True, CellTags -> "NotationPackage"], 
      Cell[
       StyleData["NotationTemplateStyle"], GeneratedCell -> True, 
       StyleMenuListing -> None, Background -> RGBColor[1, 1, 0.850004], 
       TagBoxOptions -> {SyntaxForm -> "symbol"}, CellTags -> 
       "NotationPackage"], 
      Cell[
       StyleData["NotationPatternWrapperStyle"], GeneratedCell -> True, 
       StyleMenuListing -> None, Background -> 
       RGBColor[1, 0.900008, 0.979995], 
       TagBoxOptions -> {SyntaxForm -> "symbol"}, CellTags -> 
       "NotationPackage"], 
      Cell[
       StyleData["NotationMadeBoxesWrapperStyle"], GeneratedCell -> True, 
       StyleMenuListing -> None, Background -> 
       RGBColor[0.900008, 0.889998, 1], 
       TagBoxOptions -> {SyntaxForm -> "symbol"}, CellTags -> 
       "NotationPackage"]}, Closed]]}, Visible -> False, FrontEndVersion -> 
  "11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 10, 2017)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 275, 6, 41, "Text",ExpressionUUID->"d2ad18b7-66c5-4bd1-a51c-a01665d3fb9c"],
Cell[835, 28, 425, 8, 65, "Text",ExpressionUUID->"1a54dd02-0f2f-4c8f-b13a-8caa84ee1727"],
Cell[1263, 38, 289, 6, 41, "Text",ExpressionUUID->"7e12ab75-8c3e-4953-9137-36a1b445ce49"],
Cell[CellGroupData[{
Cell[1577, 48, 168, 4, 73, "Section",ExpressionUUID->"ee1505fe-55a8-4ca7-9f84-d25af89ce058",
 Evaluatable->False,
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1770, 56, 99, 0, 64, "Subsection",ExpressionUUID->"83e09f17-efd7-415a-bafa-71f2ddca06cc"],
Cell[CellGroupData[{
Cell[1894, 60, 370, 5, 79, "Subsubsection",ExpressionUUID->"c1d569cf-3a15-4c8d-a9a5-a4ecbb5c4082"],
Cell[2267, 67, 480, 10, 802, "Input",ExpressionUUID->"00722a66-2f96-402a-be67-d54b9323bc51",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2784, 82, 212, 3, 35, "Subsubsection",ExpressionUUID->"3fc83d5e-6dac-487f-ba3a-4af743131ecc"],
Cell[2999, 87, 330, 8, 340, "Input",ExpressionUUID->"e9de9230-604a-4a39-a9ba-c70e2f0e187d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[3366, 100, 156, 2, 35, "Subsubsection",ExpressionUUID->"24280a03-63e7-4e94-98c4-30019f07f408"],
Cell[3525, 104, 701, 13, 985, "Input",ExpressionUUID->"5b3462d2-4f2a-4537-abbd-629c67573252",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[4263, 122, 157, 2, 35, "Subsubsection",ExpressionUUID->"43de133e-f7cb-4375-bb82-af09655429c9"],
Cell[4423, 126, 277, 7, 340, "Input",ExpressionUUID->"8973034a-5540-4f9c-b957-367496a24209",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[4737, 138, 817, 21, 55, "Subsubsection",ExpressionUUID->"6d071011-8fdf-48d9-94a3-0be8e6b69c0a"],
Cell[5557, 161, 768, 14, 772, "Input",ExpressionUUID->"9fbcbd31-b6d0-4021-a3e0-bfdba7861652",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[6362, 180, 297, 4, 56, "Subsubsection",ExpressionUUID->"f512001c-1fda-482f-97b0-5b1ee2e59eb3"],
Cell[6662, 186, 411, 9, 772, "Input",ExpressionUUID->"41124859-4f68-4c52-b783-92b6d06604f5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[7110, 200, 157, 2, 35, "Subsubsection",ExpressionUUID->"f7e8e083-0c6e-4551-8401-ebcd4a35bc3a"],
Cell[7270, 204, 320, 7, 340, "Input",ExpressionUUID->"65eec372-730c-4ba0-bb22-8edd34dd0c82",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[7627, 216, 159, 2, 35, "Subsubsection",ExpressionUUID->"1de20c59-8d72-4bd0-a1dd-6c593c740c02"],
Cell[7789, 220, 269, 7, 340, "Input",ExpressionUUID->"7e1f3e26-5a08-4884-a830-4446a55157f9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[8095, 232, 149, 2, 35, "Subsubsection",ExpressionUUID->"54a9929d-39fa-4a96-8066-cbe47741a181"],
Cell[8247, 236, 269, 7, 340, "Input",ExpressionUUID->"ae553f7c-bfff-41d2-b57c-2fc6c87bad7d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[8553, 248, 134, 0, 35, "Subsubsection",ExpressionUUID->"67e9d41e-f268-480d-941d-0e2c7bd12e19"],
Cell[8690, 250, 402, 9, 567, "Input",ExpressionUUID->"b8c6dd68-ebbf-4549-aaf0-c3c3d32881b3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[9129, 264, 228, 3, 35, "Subsubsection",ExpressionUUID->"66f7bb3c-cb3c-410e-a440-b098d7cb11b2"],
Cell[9360, 269, 578, 11, 772, "Input",ExpressionUUID->"273016ad-41ee-4a24-aaec-6d4d6ba27dee",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[9975, 285, 211, 3, 35, "Subsubsection",ExpressionUUID->"118f1625-3bf9-4909-bf3f-9e45df26d970"],
Cell[10189, 290, 506, 10, 340, "Input",ExpressionUUID->"5ba2739d-9360-4513-83e8-4ed452d54490",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[10732, 305, 191, 3, 35, "Subsubsection",ExpressionUUID->"a9912971-9f88-4ecd-ad16-ff9fd27ead94"],
Cell[10926, 310, 433, 9, 772, "Input",ExpressionUUID->"5482e107-3187-4ba7-971b-392d209cbc2b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[11396, 324, 393, 6, 76, "Subsubsection",ExpressionUUID->"528ccd1d-6a34-4c94-ac83-af9ed03b750f"],
Cell[11792, 332, 701, 12, 985, "Input",ExpressionUUID->"919bc4a3-99b7-4801-b6c2-0eaa63b0463b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[12530, 349, 177, 3, 35, "Subsubsection",ExpressionUUID->"b75bcd51-c6d5-4c37-a21d-440fb3c81fd9"],
Cell[12710, 354, 290, 7, 340, "Input",ExpressionUUID->"8f776e41-2d97-41c1-8bc6-5e98f9b11019",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[13037, 366, 177, 3, 35, "Subsubsection",ExpressionUUID->"beb14549-ad64-4b07-b7fe-43c4855e2a54"],
Cell[13217, 371, 290, 7, 340, "Input",ExpressionUUID->"b5d42883-4a3f-4110-851a-9072e4e23365",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[13544, 383, 237, 3, 56, "Subsubsection",ExpressionUUID->"5b0fe6ca-68dc-42c9-b9d0-89874d93dd09"],
Cell[13784, 388, 352, 8, 187, "Input",ExpressionUUID->"b817838d-a619-45dd-b0e6-9f3a12654e74",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[14173, 401, 175, 3, 35, "Subsubsection",ExpressionUUID->"27d34fc4-6853-426f-98ab-8e8e626cb1f9"],
Cell[14351, 406, 303, 7, 187, "Input",ExpressionUUID->"bac30911-bc1e-4b1c-a2fe-8b5de2a5368d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[14691, 418, 191, 3, 35, "Subsubsection",ExpressionUUID->"f00cace2-3c39-4b18-b264-0f9e7efd6bda"],
Cell[14885, 423, 301, 7, 340, "Input",ExpressionUUID->"55b301bb-c08c-475f-b028-6e887d09d677",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[15223, 435, 157, 2, 35, "Subsubsection",ExpressionUUID->"8f5ace66-a52f-4e54-ab09-c9d595627114"],
Cell[15383, 439, 718, 13, 985, "Input",ExpressionUUID->"8caee6b2-63ac-4810-9784-e4907137ef2e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[16138, 457, 165, 2, 35, "Subsubsection",ExpressionUUID->"6a772d25-86ec-4813-8912-d26696597a96"],
Cell[16306, 461, 290, 7, 340, "Input",ExpressionUUID->"8dd59b76-5a58-44a0-af10-2b95a174302b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[16633, 473, 1578, 38, 95, "Subsubsection",ExpressionUUID->"eab700b8-096b-4f80-ab49-bd91cfcf55cb"],
Cell[18214, 513, 673, 13, 985, "Input",ExpressionUUID->"2c196d5a-0710-498c-9485-a8848c8753ab",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[18924, 531, 188, 3, 35, "Subsubsection",ExpressionUUID->"b0ed6b32-62b5-4533-96f2-a9db23475daa"],
Cell[19115, 536, 368, 8, 340, "Input",ExpressionUUID->"b0a4b03a-b468-47b1-8b60-a4c7b145f15e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[19520, 549, 130, 0, 35, "Subsubsection",ExpressionUUID->"7e074770-b9d1-4863-9e69-a3a8b87f8f76"],
Cell[19653, 551, 734, 14, 985, "Input",ExpressionUUID->"c3e356f9-6227-490f-9962-67e59c825d99",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[20424, 570, 337, 5, 56, "Subsubsection",ExpressionUUID->"950a7907-7d5f-4f3a-8fab-efb0cc89871b"],
Cell[20764, 577, 950, 17, 1204, "Input",ExpressionUUID->"0db3bf96-80cf-4611-a053-e0fdb6571c32",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[21751, 599, 171, 3, 35, "Subsubsection",ExpressionUUID->"6fc95b2d-0c0c-4245-9fba-4c914fb7ccfb"],
Cell[21925, 604, 288, 7, 340, "Input",ExpressionUUID->"864117a4-85aa-41a2-b111-c849b2adebaa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[22250, 616, 129, 0, 35, "Subsubsection",ExpressionUUID->"6d41309f-4322-46f8-8477-5e37ce57cac1"],
Cell[22382, 618, 260, 7, 340, "Input",ExpressionUUID->"6d1ea52e-8423-4a3d-819d-56c578574acb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[22679, 630, 325, 9, 36, "Subsubsection",ExpressionUUID->"8f128337-e343-4fd7-8add-113337ea61a3"],
Cell[23007, 641, 282, 7, 340, "Input",ExpressionUUID->"dc93c92d-ada2-450b-98eb-9d24c50a99b2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[23326, 653, 156, 2, 35, "Subsubsection",ExpressionUUID->"2a53ad0b-e3b2-4263-a332-31c63cdace21"],
Cell[23485, 657, 272, 7, 340, "Input",ExpressionUUID->"861cdd85-62a7-4364-aed0-239f550dba77",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23806, 670, 94, 0, 96, "Subsection",ExpressionUUID->"fc0052e7-51dd-41b1-b69f-b6799beea7ae"],
Cell[CellGroupData[{
Cell[23925, 674, 262, 4, 118, "Subsubsection",ExpressionUUID->"3c828de2-fd70-48f3-8199-f71b89d913ed"],
Cell[24190, 680, 382, 8, 567, "Input",ExpressionUUID->"a71a4e73-a431-48ae-a648-cb5e6cb67b6a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[24609, 693, 2307, 52, 202, "Subsubsection",ExpressionUUID->"a05f5836-6312-43c4-8ac4-823c18e66bdd"],
Cell[26919, 747, 993, 16, 1204, "Input",ExpressionUUID->"31cda983-7d74-4209-b20b-e9edf802c0d9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[27949, 768, 500, 11, 54, "Subsubsection",ExpressionUUID->"f372258c-2ce8-4ad2-b65e-f0cc74a374cb"],
Cell[28452, 781, 396, 9, 340, "Input",ExpressionUUID->"a53a189a-6893-442b-9853-43d0a38faa68",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[28885, 795, 844, 17, 82, "Subsubsection",ExpressionUUID->"a5da7106-724f-4cc1-803d-e1409edf2f79"],
Cell[29732, 814, 509, 11, 772, "Input",ExpressionUUID->"bf3f3624-a5b1-4bb0-bd9c-f20374e7825b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[30278, 830, 809, 16, 82, "Subsubsection",ExpressionUUID->"0600b7bd-ab1b-41d2-886a-c7fcc78594bc"],
Cell[31090, 848, 631, 12, 772, "Input",ExpressionUUID->"5da9cd01-767b-4e2c-9f03-8a311a85dded",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[31758, 865, 701, 19, 57, "Subsubsection",ExpressionUUID->"1f150228-74bb-4ffe-a069-5285ca66006a",
 InitializationCell->True],
Cell[32462, 886, 409, 9, 370, "Input",ExpressionUUID->"59227d2d-56fc-4255-81af-d2dd27fd9692",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[32908, 900, 254, 5, 52, "Subsubsection",ExpressionUUID->"ac47662f-3e67-427f-8b77-6db06342c294",
 InitializationCell->True],
Cell[33165, 907, 354, 8, 340, "Input",ExpressionUUID->"2513d9f0-aa5e-4025-9314-9b1d304e6709",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[33556, 920, 203, 5, 52, "Subsubsection",ExpressionUUID->"ee9678ec-bfba-4f84-b565-cc3b7d517755",
 InitializationCell->True],
Cell[33762, 927, 292, 7, 340, "Input",ExpressionUUID->"b1b2f2c7-8060-4672-a22a-d9a3f4ce6a39",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[34091, 939, 253, 5, 52, "Subsubsection",ExpressionUUID->"2faf3b8e-eb1c-47b6-822c-f04852fb1253",
 InitializationCell->True],
Cell[34347, 946, 348, 8, 340, "Input",ExpressionUUID->"a4786b84-e80a-4b99-8dbe-ede36c3f4817",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[34732, 959, 172, 3, 52, "Subsubsection",ExpressionUUID->"60607c70-5402-4912-acae-f64823f305a9",
 InitializationCell->True],
Cell[34907, 964, 455, 9, 772, "Input",ExpressionUUID->"be1e92d4-c254-4e4b-94be-2fed16f96971",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[35399, 978, 162, 2, 52, "Subsubsection",ExpressionUUID->"b4315b21-6bb4-4a5a-b844-c7971f0117e2",
 InitializationCell->True],
Cell[35564, 982, 292, 7, 340, "Input",ExpressionUUID->"7e0869bc-8206-4163-bd33-a601da1c4be0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[35893, 994, 204, 5, 52, "Subsubsection",ExpressionUUID->"24c52cc4-a2d6-4f2e-a1b2-df996847c541",
 InitializationCell->True],
Cell[36100, 1001, 284, 7, 340, "Input",ExpressionUUID->"5aeaa880-09d6-425b-9b89-ca7e9ac112ad",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[36421, 1013, 161, 2, 52, "Subsubsection",ExpressionUUID->"571cee36-e650-43c8-ab23-c55ba0cae386",
 InitializationCell->True],
Cell[36585, 1017, 249, 7, 340, "Input",ExpressionUUID->"63375618-80c9-4ead-9489-6e16a1ae283b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[36871, 1029, 158, 2, 52, "Subsubsection",ExpressionUUID->"cea7a6ce-d482-42a9-93fd-89c8c0fed9d2",
 InitializationCell->True],
Cell[37032, 1033, 258, 7, 340, "Input",ExpressionUUID->"dc596d92-78fe-4792-9c04-62cbf8551182",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[37339, 1046, 95, 0, 57, "Subsection",ExpressionUUID->"374e5328-87a2-4d04-a04c-b26d963981d1"],
Cell[CellGroupData[{
Cell[37459, 1050, 96, 0, 58, "Subsubsection",ExpressionUUID->"d29ea3f6-f610-4eb1-9805-e1f7d58ad5ef"],
Cell[37558, 1052, 367, 8, 187, "Input",ExpressionUUID->"9dd21553-0556-4eac-b982-2da1290c0535",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[37962, 1065, 154, 2, 35, "Subsubsection",ExpressionUUID->"3b72d4e3-14b4-41bf-856c-8adccec78457"],
Cell[38119, 1069, 791, 13, 394, "Input",ExpressionUUID->"d86fb1c3-fe9c-4802-92bc-3d28c8cf9332",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[38947, 1087, 283, 6, 35, "Subsubsection",ExpressionUUID->"73d84d0d-817d-4ab6-8938-fcaae7a36713"],
Cell[39233, 1095, 880, 15, 363, "Input",ExpressionUUID->"da3e0d0e-07d2-42bd-915c-e8cd9e2246c2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[40150, 1115, 312, 6, 56, "Subsubsection",ExpressionUUID->"ec8975e8-a6c1-458c-8241-40dfc7cbe6d7",
 InitializationCell->True],
Cell[40465, 1123, 411, 9, 772, "Input",ExpressionUUID->"540c95f9-1412-480a-8845-5f51785bc9ce",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[40913, 1137, 137, 1, 35, "Subsubsection",ExpressionUUID->"eed3404c-b4c3-4e53-8e83-36badf6b2ab8"],
Cell[41053, 1140, 289, 7, 340, "Input",ExpressionUUID->"c6b57c2e-d433-4d26-bd52-5aaeb33177e4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[41379, 1152, 203, 3, 35, "Subsubsection",ExpressionUUID->"af7bea16-af71-4a6e-b1d9-0be70e4e080b"],
Cell[41585, 1157, 320, 7, 340, "Input",ExpressionUUID->"59769f9a-ec2d-4acb-89e4-73f2af5eb48d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[41942, 1169, 220, 5, 35, "Subsubsection",ExpressionUUID->"36cf5235-16a1-4d34-9122-2a4bd3e347e6",
 InitializationCell->True],
Cell[42165, 1176, 313, 7, 340, "Input",ExpressionUUID->"e48a6393-d2b5-445a-b6cd-0defcafd0555",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[42515, 1188, 1854, 45, 115, "Subsubsection",ExpressionUUID->"52a50ffc-6e38-450d-a5b3-6799ed2408bc"],
Cell[44372, 1235, 1714, 27, 636, "Input",ExpressionUUID->"1421af4f-0836-4e0e-9e34-bb87c0be1d24",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[46123, 1267, 261, 4, 35, "Subsubsection",ExpressionUUID->"fca79ddc-c17e-42b8-b23b-5fcdcbccb6f3"],
Cell[46387, 1273, 376, 8, 340, "Input",ExpressionUUID->"91a6699a-adf8-4049-9149-7ca9d497ddb8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[46800, 1286, 785, 20, 56, "Subsubsection",ExpressionUUID->"e94ec61f-24ba-45c7-9327-019ca4d8efaf"],
Cell[47588, 1308, 517, 10, 567, "Input",ExpressionUUID->"b873fdba-2526-4ba2-92d2-94dcf199ee3c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[48142, 1323, 222, 3, 35, "Subsubsection",ExpressionUUID->"1f84362a-a8d2-44f4-bb4c-d413e21d734a"],
Cell[48367, 1328, 355, 8, 340, "Input",ExpressionUUID->"0e4eeccc-94b7-43b1-bff9-504d70235e41",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48771, 1342, 97, 0, 96, "Subsection",ExpressionUUID->"3c0a79b0-9fd8-458e-b8d2-ef43732b27f4"],
Cell[CellGroupData[{
Cell[48893, 1346, 263, 4, 529, "Subsubsection",ExpressionUUID->"567e343a-9408-4d48-b6ad-7b528e9bfa10"],
Cell[49159, 1352, 652, 12, 985, "Input",ExpressionUUID->"e9b6fa00-bd73-4c88-92f2-b7ffcc4611da",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[49860, 1370, 107, 0, 57, "Subsection",ExpressionUUID->"8cff91c9-d639-462e-a9a4-64a0fa148ae5"],
Cell[CellGroupData[{
Cell[49992, 1374, 448, 6, 148, "Subsubsection",ExpressionUUID->"a37e8bc4-6896-44b5-b55a-8f07d40c8f72"],
Cell[50443, 1382, 657, 13, 1204, "Input",ExpressionUUID->"f7acffba-beef-4bb7-a595-0a7e042bcc5f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[51137, 1400, 437, 6, 114, "Subsubsection",ExpressionUUID->"560624db-95ab-4585-ab20-e3a867db1648"],
Cell[51577, 1408, 852, 15, 985, "Input",ExpressionUUID->"de32fa1a-b541-479e-909a-3394d125bfb4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[52466, 1428, 227, 3, 84, "Subsubsection",ExpressionUUID->"713563d9-4cb7-4798-9907-8ffae4eb60fe"],
Cell[52696, 1433, 406, 8, 567, "Input",ExpressionUUID->"4386b281-d16e-4908-9af9-75565714cb2c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[53139, 1446, 174, 3, 52, "Subsubsection",ExpressionUUID->"63a372de-4f84-4cb0-abd0-3b04bf703f54"],
Cell[53316, 1451, 299, 7, 340, "Input",ExpressionUUID->"30289dc4-f738-4d69-a600-ff8bf342780c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[53652, 1463, 288, 4, 84, "Subsubsection",ExpressionUUID->"3de7d576-ae30-4795-a1af-9f803d72c3f3"],
Cell[53943, 1469, 419, 8, 772, "Input",ExpressionUUID->"93a46ae1-8192-4c57-ab31-3182e9a4a511",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[54399, 1482, 297, 4, 84, "Subsubsection",ExpressionUUID->"f5ba2fbc-ccf3-4ec6-bd2b-6b70f7277523"],
Cell[54699, 1488, 421, 9, 772, "Input",ExpressionUUID->"7637044a-18bc-4b1e-8183-77493493a945",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[55157, 1502, 379, 5, 114, "Subsubsection",ExpressionUUID->"67e0109e-5054-4c8a-9cbd-e2149d11c3c9"],
Cell[55539, 1509, 493, 10, 772, "Input",ExpressionUUID->"1c2533b8-4b0e-48a3-921a-a1f384650e90",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[56069, 1524, 157, 2, 52, "Subsubsection",ExpressionUUID->"8cf6b5cb-0ffd-44c3-85dc-be1a47a57335"],
Cell[56229, 1528, 476, 9, 772, "Input",ExpressionUUID->"e7fb69ad-eb02-469b-8609-519c9d0ca553",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[56742, 1542, 163, 2, 52, "Subsubsection",ExpressionUUID->"4fd0daf4-7092-49cc-a071-5f17ef71f279"],
Cell[56908, 1546, 483, 10, 772, "Input",ExpressionUUID->"75b268e3-a458-4f98-a053-a7ae5fad939c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[57428, 1561, 720, 10, 175, "Subsubsection",ExpressionUUID->"a7cd0a6d-2281-422e-9ccc-373e47ad9a5d"],
Cell[58151, 1573, 839, 14, 1204, "Input",ExpressionUUID->"84c777b7-1d05-4f9d-aacc-56b9ce5679b8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[59027, 1592, 375, 5, 114, "Subsubsection",ExpressionUUID->"cb12ff74-1cf3-4eff-b47e-80873628e981"],
Cell[59405, 1599, 692, 12, 325, "Input",ExpressionUUID->"98132254-c01e-4374-af7f-0d3d9801dff1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[60134, 1616, 1056, 27, 117, "Subsubsection",ExpressionUUID->"93cc50d9-a4d9-495c-a66c-336bd867d389"],
Cell[61193, 1645, 754, 14, 772, "Input",ExpressionUUID->"ee8b7265-090c-4a35-b283-6d1f4956702c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[61984, 1664, 815, 19, 82, "Subsubsection",ExpressionUUID->"3349053d-83c7-4933-9981-62aac1a81932"],
Cell[62802, 1685, 453, 9, 567, "Input",ExpressionUUID->"c7712eab-1461-4a5a-9fae-2c2d851d1c1b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[63292, 1699, 2212, 51, 172, "Subsubsection",ExpressionUUID->"b1978156-4c6e-4a7e-aa7b-b65d89f6105a"],
Cell[65507, 1752, 1024, 17, 1204, "Input",ExpressionUUID->"61679b91-6638-47c0-9edd-bd9f2d29fb67",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[66568, 1774, 552, 15, 54, "Subsubsection",ExpressionUUID->"a5f8f520-51c9-477b-a9c2-e25f0a6c7bf5"],
Cell[67123, 1791, 281, 7, 340, "Input",ExpressionUUID->"9271fea8-6c68-4815-ad7b-fb1243593f2c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[67441, 1803, 830, 20, 82, "Subsubsection",ExpressionUUID->"bfb8cb1b-5dd5-403b-a207-c9c47a940540"],
Cell[68274, 1825, 441, 9, 567, "Input",ExpressionUUID->"1557035f-f96e-4fd6-99f8-c640d51c062a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[68752, 1839, 234, 3, 84, "Subsubsection",ExpressionUUID->"e9648605-ea77-4296-8679-d73e840ef7e9"],
Cell[68989, 1844, 354, 8, 340, "Input",ExpressionUUID->"7e551f21-eb17-4bfc-8a3e-120cb7c4757c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[69380, 1857, 258, 4, 84, "Subsubsection",ExpressionUUID->"78431a0c-8d70-46b2-99cb-9445499febb7"],
Cell[69641, 1863, 386, 8, 567, "Input",ExpressionUUID->"932ef5c5-3f6c-4944-a34c-fe57afb3216d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[70064, 1876, 92, 0, 52, "Subsubsection",ExpressionUUID->"da02840b-ca16-4f06-9b5a-e725d224a888"],
Cell[70159, 1878, 620, 11, 985, "Input",ExpressionUUID->"c733cda5-a7a0-4e76-918e-42cffa69bc92",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[70816, 1894, 88, 0, 52, "Subsubsection",ExpressionUUID->"19a17dca-4953-4254-afca-cbc867fdc224"],
Cell[70907, 1896, 350, 8, 340, "Input",ExpressionUUID->"8f44a624-ac72-41d8-8109-937db6c2b3b9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[71294, 1909, 120, 2, 52, "Subsubsection",ExpressionUUID->"1c3c80f3-bec2-43e1-a7cf-028360c0f4e0",
 InitializationCell->True],
Cell[71417, 1913, 450, 9, 772, "Input",ExpressionUUID->"7d535e91-03a8-42f9-9fc6-1ca5b0908fc5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[71904, 1927, 98, 0, 52, "Subsubsection",ExpressionUUID->"3b7d6f32-8f25-4e5f-875f-1785f46ea0a5"],
Cell[72005, 1929, 624, 11, 985, "Input",ExpressionUUID->"52ffa551-df1d-4296-9156-09c3972768c7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[72666, 1945, 96, 0, 52, "Subsubsection",ExpressionUUID->"d8b42d98-c3a9-4309-8a6b-77bf7adde7e7"],
Cell[72765, 1947, 572, 11, 772, "Input",ExpressionUUID->"8c926f4f-8ad8-4c18-89bd-548b3d340967",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[73374, 1963, 91, 0, 52, "Subsubsection",ExpressionUUID->"a06ef4f2-f5c1-42e1-8888-e1534fdcbd5d"],
Cell[73468, 1965, 371, 9, 187, "Input",ExpressionUUID->"614f65bb-c53d-4ec8-991d-d181a424e452",
 InitializationCell->True],
Cell[73842, 1976, 839, 21, 153, "Input",ExpressionUUID->"6c2f277a-0e33-4402-ab04-96cb7e9b6b6b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[74718, 2002, 94, 0, 87, "Subsubsection",ExpressionUUID->"fded4f2b-fed6-4095-aca1-46a8b1767286"],
Cell[74815, 2004, 539, 10, 772, "Input",ExpressionUUID->"9978a975-58dd-47aa-8a5b-fd5843c0749a",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[75403, 2020, 90, 0, 57, "Subsection",ExpressionUUID->"814f99ac-a726-4340-9662-b1ea3e85f04a"],
Cell[CellGroupData[{
Cell[75518, 2024, 126, 2, 529, "Subsubsection",ExpressionUUID->"4546d7a0-ae10-49d8-87c4-5f6fea62d800",
 InitializationCell->True],
Cell[75647, 2028, 561, 10, 772, "Input",ExpressionUUID->"85c4462e-77f3-4866-8263-fc75eb013f55",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[76245, 2043, 131, 2, 529, "Subsubsection",ExpressionUUID->"231991c6-07fc-431b-9e25-ab3e387e48da",
 InitializationCell->True],
Cell[76379, 2047, 392, 8, 567, "Input",ExpressionUUID->"b4704cf6-a497-4a27-910e-c7f4ad0afd28",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[76808, 2060, 133, 2, 529, "Subsubsection",ExpressionUUID->"9fcf6144-f57d-406f-9739-9eef7ace5302",
 InitializationCell->True],
Cell[76944, 2064, 286, 7, 340, "Input",ExpressionUUID->"99da6456-91c2-4c4a-aecd-ff226426f0bd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[77267, 2076, 122, 2, 529, "Subsubsection",ExpressionUUID->"8639c5a7-f91c-404a-acda-4bc73b7d4b78",
 InitializationCell->True],
Cell[77392, 2080, 291, 7, 340, "Input",ExpressionUUID->"e3caadfb-d32e-4763-8038-061abf9a0046",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[77720, 2092, 126, 2, 529, "Subsubsection",ExpressionUUID->"6b7352db-5959-455e-87ab-e26319452936",
 InitializationCell->True],
Cell[77849, 2096, 611, 11, 772, "Input",ExpressionUUID->"8e67b1f1-ecda-4ac7-bfd9-229e4d4e8f8e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[78497, 2112, 129, 2, 529, "Subsubsection",ExpressionUUID->"e5fab877-c82f-4dca-998d-95f3087a7646",
 InitializationCell->True],
Cell[78629, 2116, 378, 8, 567, "Input",ExpressionUUID->"d92074d2-e0c4-4028-a051-8f1dd59f8d7c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[79044, 2129, 126, 2, 529, "Subsubsection",ExpressionUUID->"e799090a-8d54-4d9e-be91-628e1cf42907",
 InitializationCell->True],
Cell[79173, 2133, 505, 10, 772, "Input",ExpressionUUID->"810811e2-2b55-4dd5-b648-6721277fbe20",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[79715, 2148, 119, 2, 529, "Subsubsection",ExpressionUUID->"5a062edc-7b28-4fc0-9431-ad8a2067122c",
 InitializationCell->True],
Cell[79837, 2152, 400, 8, 340, "Input",ExpressionUUID->"2747ae40-646c-4bd3-b553-2049036678e2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[80274, 2165, 119, 2, 529, "Subsubsection",ExpressionUUID->"c02ecd09-f543-4823-b8dc-edee02c79198",
 InitializationCell->True],
Cell[80396, 2169, 327, 8, 340, "Input",ExpressionUUID->"9aa95df9-7afd-45fc-a97c-c674f2028693",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[80760, 2182, 125, 2, 529, "Subsubsection",ExpressionUUID->"cdb2410f-9bae-4670-bb16-407b10969032",
 InitializationCell->True],
Cell[80888, 2186, 397, 8, 340, "Input",ExpressionUUID->"82787dd9-770b-46a0-91a5-9dd3fb7ce3d6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[81322, 2199, 129, 2, 529, "Subsubsection",ExpressionUUID->"1a2aaa62-3a0d-4bf0-8655-0ae17bb6f8b6",
 InitializationCell->True],
Cell[81454, 2203, 342, 8, 340, "Input",ExpressionUUID->"03944aac-fd3e-4c73-8db8-b9b02467861e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[81833, 2216, 128, 2, 529, "Subsubsection",ExpressionUUID->"3e72cd10-cf35-49c4-ad13-f9e5aa7dbc40",
 InitializationCell->True],
Cell[81964, 2220, 346, 8, 340, "Input",ExpressionUUID->"760ebf28-4340-46c6-b8f4-882055006814",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[82347, 2233, 122, 2, 529, "Subsubsection",ExpressionUUID->"a7be4e3e-ef74-4607-a117-64d8cd0dcda1",
 InitializationCell->True],
Cell[82472, 2237, 316, 7, 340, "Input",ExpressionUUID->"93c36080-4cf4-4d22-aeba-ea28246c2455",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[82825, 2249, 124, 2, 529, "Subsubsection",ExpressionUUID->"592ed084-2aa8-4065-83a9-92572559d037",
 InitializationCell->True],
Cell[82952, 2253, 492, 10, 772, "Input",ExpressionUUID->"d8993e0b-cd44-4f19-9219-41c630332df8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[83481, 2268, 134, 2, 529, "Subsubsection",ExpressionUUID->"420036d9-ce73-48a8-a200-57b1bac94bb9",
 InitializationCell->True],
Cell[83618, 2272, 501, 10, 772, "Input",ExpressionUUID->"07167bcb-50c7-4a9a-82d5-a8c349e123b8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[84156, 2287, 136, 2, 529, "Subsubsection",ExpressionUUID->"d7cfe443-b9d3-47a9-84f1-7520ee23ecfb",
 InitializationCell->True],
Cell[84295, 2291, 503, 10, 772, "Input",ExpressionUUID->"98ace8d6-c859-4d27-9f60-44686a6e7432",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[84835, 2306, 123, 2, 529, "Subsubsection",ExpressionUUID->"4263842a-10d1-41e1-9ec5-2740d5bdc86e",
 InitializationCell->True],
Cell[84961, 2310, 315, 7, 340, "Input",ExpressionUUID->"5588dbe8-3011-496a-bb39-0f64e6de9051",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[85313, 2322, 119, 2, 529, "Subsubsection",ExpressionUUID->"ed588190-75dd-4581-9f75-e726e40dac53",
 InitializationCell->True],
Cell[85435, 2326, 449, 9, 772, "Input",ExpressionUUID->"112eb828-1aae-48a8-afaf-8737dd6c989d",
 InitializationCell->True],
Cell[85887, 2337, 131, 2, 279, "SubsubsectionIcon",ExpressionUUID->"7ad48a21-d650-4581-8039-3107674a0b1b",
 InitializationCell->True],
Cell[86021, 2341, 539, 10, 370, "Input",ExpressionUUID->"3b15043d-22ac-4f1c-9922-42331b49c3a8",
 InitializationCell->True],
Cell[86563, 2353, 96, 0, 279, "SubsubsectionIcon",ExpressionUUID->"ce49ec4e-b933-4892-8094-660eb4df7dff"],
Cell[86662, 2355, 292, 7, 340, "Input",ExpressionUUID->"bcc69798-c66d-4dbe-89cd-56c3533586d8",
 InitializationCell->True],
Cell[86957, 2364, 133, 2, 279, "SubsubsectionIcon",ExpressionUUID->"0114301d-fa22-4b62-a8e5-31c8a4d86164",
 InitializationCell->True],
Cell[87093, 2368, 576, 11, 370, "Input",ExpressionUUID->"168499f8-8c96-400f-a37f-854ba2346713",
 InitializationCell->True],
Cell[87672, 2381, 137, 2, 279, "SubsubsectionIcon",ExpressionUUID->"47214ae7-a203-4e00-b97f-85ce5672a317",
 InitializationCell->True],
Cell[87812, 2385, 627, 11, 819, "Input",ExpressionUUID->"51e5f047-75cb-4d1b-a9e5-35a97e4977f9",
 InitializationCell->True],
Cell[88442, 2398, 124, 2, 279, "SubsubsectionIcon",ExpressionUUID->"a9d18030-e60f-40b7-89d1-b6e30c881802",
 InitializationCell->True],
Cell[88569, 2402, 307, 7, 340, "Input",ExpressionUUID->"cb2dca7e-4570-4e7d-811b-2b8560b77585",
 InitializationCell->True],
Cell[88879, 2411, 124, 2, 279, "SubsubsectionIcon",ExpressionUUID->"e5b8bbf0-85f9-4f00-a8f3-8591dcb68057",
 InitializationCell->True],
Cell[89006, 2415, 308, 7, 340, "Input",ExpressionUUID->"54fc5603-e8c7-457b-b7f1-cecf1dee03ad",
 InitializationCell->True],
Cell[89317, 2424, 131, 2, 279, "SubsubsectionIcon",ExpressionUUID->"23b87020-dd7b-41ba-82d7-aed630004eb8",
 InitializationCell->True],
Cell[89451, 2428, 326, 7, 340, "Input",ExpressionUUID->"bb5c69b1-c553-43f5-aedb-c58747a4733a",
 InitializationCell->True],
Cell[89780, 2437, 125, 2, 279, "SubsubsectionIcon",ExpressionUUID->"0ab24a97-6a23-425d-94b0-97cb2eca93f5",
 InitializationCell->True],
Cell[89908, 2441, 321, 7, 340, "Input",ExpressionUUID->"88dfc5ca-0daf-4f23-9537-421ed43274b9",
 InitializationCell->True],
Cell[90232, 2450, 128, 2, 279, "SubsubsectionIcon",ExpressionUUID->"5a165c98-ba12-45fc-9704-f460bc22148f",
 InitializationCell->True],
Cell[90363, 2454, 259, 7, 340, "Input",ExpressionUUID->"ec538a10-b91b-438a-b26a-eb1a551427aa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[90659, 2466, 122, 2, 529, "Subsubsection",ExpressionUUID->"6ecd5964-cab6-42ec-9c44-17d56ddfde0d",
 InitializationCell->True],
Cell[90784, 2470, 285, 7, 340, "Input",ExpressionUUID->"805adcde-6c06-444d-a771-57a50a4e675e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[91106, 2482, 122, 2, 529, "Subsubsection",ExpressionUUID->"3044cb0d-d2c0-4dbd-a3be-8dd1ae79b65e",
 InitializationCell->True],
Cell[91231, 2486, 253, 7, 340, "Input",ExpressionUUID->"189cef09-d8cf-4bb3-ada6-3a4e6c513eee",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[91521, 2498, 98, 0, 529, "Subsubsection",ExpressionUUID->"b19d6c83-2943-4aea-a696-abb31ca209d7"],
Cell[91622, 2500, 452, 9, 772, "Input",ExpressionUUID->"283e05b1-23c2-45a6-9ae0-2661acb23b24",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[92111, 2514, 132, 2, 529, "Subsubsection",ExpressionUUID->"bcf6b1d2-9ab9-4395-8c20-404cfd9d4648",
 InitializationCell->True],
Cell[92246, 2518, 395, 8, 567, "Input",ExpressionUUID->"d377d87a-1a9c-4625-abe4-aa702719cfdd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[92678, 2531, 130, 2, 529, "Subsubsection",ExpressionUUID->"eb578bf0-b0f5-4992-8a64-a108322b973a",
 InitializationCell->True],
Cell[92811, 2535, 331, 7, 340, "Input",ExpressionUUID->"d2efb1cb-af63-4196-b6a3-49e5d575a30c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[93179, 2547, 92, 0, 529, "Subsubsection",ExpressionUUID->"96acf816-48e3-4e34-83af-b8010163f704"],
Cell[93274, 2549, 248, 6, 340, "Input",ExpressionUUID->"82b6368b-922f-4cc5-b6f2-533b2b5caeca",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[93559, 2560, 88, 0, 529, "Subsubsection",ExpressionUUID->"5115e91f-d186-42a3-bc60-42e86a4daefe"],
Cell[93650, 2562, 388, 8, 340, "Input",ExpressionUUID->"64b6bee1-d1d9-4fa5-9163-d289d7cf1168",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[94075, 2575, 92, 0, 529, "Subsubsection",ExpressionUUID->"50c94ee1-6ec0-4026-8b33-e5c0f652b648"],
Cell[94170, 2577, 651, 12, 985, "Input",ExpressionUUID->"f2c51ac0-b56e-4998-9956-0f904b2137ba",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[94858, 2594, 95, 0, 529, "Subsubsection",ExpressionUUID->"1db30e19-37d1-4497-b62a-ba972c7eb5e9"],
Cell[94956, 2596, 336, 8, 340, "Input",ExpressionUUID->"9d6a7e1c-78c0-4f79-ba5c-6021f6faaf50",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[95329, 2609, 92, 0, 529, "Subsubsection",ExpressionUUID->"77b43533-16d7-44fd-af0a-d04d948c9161"],
Cell[95424, 2611, 321, 7, 340, "Input",ExpressionUUID->"201ad0a3-7e37-4f40-8436-df0babc38d6c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[95782, 2623, 93, 0, 529, "Subsubsection",ExpressionUUID->"3366689c-d17e-48c8-bb42-cdcc21f638a1"],
Cell[95878, 2625, 325, 7, 340, "Input",ExpressionUUID->"a4a0244c-ee32-4276-9065-12c2cafbae71",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[96240, 2637, 99, 0, 529, "Subsubsection",ExpressionUUID->"8e88dc4c-c973-441d-8e2c-3b17eb300cd0"],
Cell[96342, 2639, 318, 7, 340, "Input",ExpressionUUID->"7b721aef-8341-49a1-bd1c-732e43ffdd18",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[96697, 2651, 86, 0, 529, "Subsubsection",ExpressionUUID->"259223af-bfb5-48c9-b5f0-ef22319a8766"],
Cell[96786, 2653, 373, 8, 340, "Input",ExpressionUUID->"0582a9d5-cf45-4d7f-a182-5459aa7872bf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[97196, 2666, 87, 0, 529, "Subsubsection",ExpressionUUID->"b35465c0-2ddc-4aa1-87cd-b5bc3a663814"],
Cell[97286, 2668, 315, 7, 340, "Input",ExpressionUUID->"33092e9c-4cb7-4246-a654-0de30871c519",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[97638, 2680, 118, 2, 529, "Subsubsection",ExpressionUUID->"892d8289-83d2-4f79-9459-8b9e653d34d7",
 InitializationCell->True],
Cell[97759, 2684, 315, 7, 340, "Input",ExpressionUUID->"8e8a8cf1-1e52-432f-bd45-fdf713dde66a",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[98123, 2697, 99, 0, 57, "Subsection",ExpressionUUID->"fea61a0c-d4a7-49fc-89b1-ecc41bddbc43"],
Cell[CellGroupData[{
Cell[98247, 2701, 114, 2, 58, "Subsubsection",ExpressionUUID->"a9e507aa-456a-4d5e-9236-9ffe8ccdb576",
 InitializationCell->True],
Cell[98364, 2705, 316, 7, 102, "Input",ExpressionUUID->"1c99bf41-501f-4678-b9da-a6f2fa6d2680",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[98717, 2717, 128, 2, 58, "Subsubsection",ExpressionUUID->"ad2a05e4-cbf9-4cd6-aaa0-1644eb843374",
 InitializationCell->True],
Cell[98848, 2721, 427, 9, 125, "Input",ExpressionUUID->"655f98c0-a102-4116-8f74-9fc398fba590",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[99312, 2735, 128, 2, 58, "Subsubsection",ExpressionUUID->"d87bfda8-6158-4c93-adfc-6a4c0d91e81f",
 InitializationCell->True],
Cell[99443, 2739, 657, 13, 194, "Input",ExpressionUUID->"9f6a7136-1ea9-41f4-879a-fa159af56d85",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[100137, 2757, 132, 2, 58, "Subsubsection",ExpressionUUID->"751a2afe-487d-4b5e-ba9d-fd0cea7a7f90",
 InitializationCell->True],
Cell[100272, 2761, 305, 7, 340, "Input",ExpressionUUID->"8c9f8729-92a4-4106-bd82-b8fb78d7edde",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[100614, 2773, 133, 2, 35, "Subsubsection",ExpressionUUID->"fc422beb-09ad-4a53-bb67-9925a41929b7",
 InitializationCell->True],
Cell[100750, 2777, 284, 7, 340, "Input",ExpressionUUID->"5200597d-c588-457d-8f6a-9a8725fe3e2c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[101071, 2789, 127, 2, 35, "Subsubsection",ExpressionUUID->"1a75a82b-16c6-41ab-970c-db315d2db71f",
 InitializationCell->True],
Cell[101201, 2793, 272, 7, 117, "Input",ExpressionUUID->"463bd182-e6fc-4180-a592-2571dc24c3be",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[101510, 2805, 126, 2, 35, "Subsubsection",ExpressionUUID->"2102a59e-abe7-4137-b33b-90f09ba81689",
 InitializationCell->True],
Cell[101639, 2809, 272, 7, 340, "Input",ExpressionUUID->"ece50383-9cc4-4a56-9047-00951c212d8b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[101948, 2821, 132, 2, 35, "Subsubsection",ExpressionUUID->"34e4132a-9a66-4eeb-8733-543371c44f90",
 InitializationCell->True],
Cell[102083, 2825, 504, 10, 772, "Input",ExpressionUUID->"050ae5a5-04cc-4bf3-a0fc-dc8d9489d56b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[102624, 2840, 132, 2, 35, "Subsubsection",ExpressionUUID->"acc26247-3d00-4440-af1e-0a36cf6b4295",
 InitializationCell->True],
Cell[102759, 2844, 504, 10, 772, "Input",ExpressionUUID->"eba6b095-87f0-4a03-bbe6-25e912a9f21f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[103300, 2859, 90, 0, 35, "Subsubsection",ExpressionUUID->"407c7968-6452-4f13-a975-a550184357cc"],
Cell[103393, 2861, 514, 10, 223, "Input",ExpressionUUID->"6995ee3f-43aa-4961-917f-d77d1e999850",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103968, 2878, 87, 0, 109, "Section",ExpressionUUID->"64fd5d6d-eb59-4944-85b9-7c70288a89d2"],
Cell[CellGroupData[{
Cell[104080, 2882, 275, 6, 58, "Subsubsection",ExpressionUUID->"87cbf0b9-a717-4e23-8a8f-b91a5f778efb"],
Cell[104358, 2890, 388, 12, 424, "Input",ExpressionUUID->"54d84eba-b322-4b14-bd95-3ea3b0934e59",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[104783, 2907, 207, 3, 35, "Subsubsection",ExpressionUUID->"2ec79627-10fc-4058-96c2-38a6a38b6874"],
Cell[104993, 2912, 389, 9, 759, "Input",ExpressionUUID->"a1ca3df8-0370-4cde-82d8-e169040c5fcc",
 InitializationCell->True],
Cell[105385, 2923, 265, 7, 400, "Input",ExpressionUUID->"256a2579-ccdc-4d45-9123-c791ed68fff7",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[105675, 2934, 1066, 33, 607, "Input",ExpressionUUID->"c6f6f128-c0da-4ac8-a2ec-e5fb1c13a96f",
 InitializationCell->True],
Cell[106744, 2969, 962, 18, 70, "Message",ExpressionUUID->"6578b6e0-140e-4bfc-ade3-ee55e6fb4729"],
Cell[107709, 2989, 917, 17, 70, "Message",ExpressionUUID->"f6952841-e20b-4442-83fd-caf1fc594747"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[108675, 3012, 276, 4, 56, "Subsubsection",ExpressionUUID->"b98b10bc-7fb1-4673-8066-a0a49366993a"],
Cell[108954, 3018, 602, 13, 802, "Input",ExpressionUUID->"1433c9f5-a99a-4868-8e3f-fb5658a9dac6",
 InitializationCell->True],
Cell[109559, 3033, 627, 18, 607, "Input",ExpressionUUID->"cd11f57a-43f4-4fe5-8d6a-c48755c89ef0",
 InitializationCell->True],
Cell[110189, 3053, 1173, 34, 948, "Input",ExpressionUUID->"785f7639-72c2-427b-a702-73ef740bcfe5"],
Cell[111365, 3089, 711, 22, 475, "Input",ExpressionUUID->"72ce6b15-5b4c-481d-b603-edaea7ca6d3e",
 InitializationCell->True],
Cell[112079, 3113, 3592, 95, 1653, "Input",ExpressionUUID->"b105befd-1dcf-4db2-9bb2-eeafe676860a",
 InitializationCell->True],
Cell[115674, 3210, 286, 7, 400, "Input",ExpressionUUID->"ba050378-3da9-499a-b8da-b1dcd23bcbdf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[115997, 3222, 88, 0, 35, "Subsubsection",ExpressionUUID->"039b95f2-3979-4df5-b63c-fd15547cc6e5"],
Cell[116088, 3224, 410, 10, 627, "Input",ExpressionUUID->"0492bb78-d24e-4d4c-afd8-bb2c844d67a3",
 InitializationCell->True],
Cell[116501, 3236, 1548, 49, 972, "Input",ExpressionUUID->"17930f96-2327-4eed-86cc-a3d5eef31633",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[118086, 3290, 160, 2, 35, "Subsubsection",ExpressionUUID->"4ad85068-0658-4e1c-885c-884d61f679cf"],
Cell[118249, 3294, 351, 9, 205, "Input",ExpressionUUID->"959cc405-ae31-4cd5-8ef1-cc93172531ba",
 InitializationCell->True],
Cell[118603, 3305, 1028, 32, 297, "Input",ExpressionUUID->"3acb1601-f9c1-41fd-a865-7f9bc9a93be8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[119668, 3342, 99, 0, 57, "Subsection",ExpressionUUID->"325b82ba-5912-4991-a938-2b5d074a1747"],
Cell[CellGroupData[{
Cell[119792, 3346, 228, 3, 58, "Subsubsection",ExpressionUUID->"ddd46a84-6e9a-4f52-91d5-534a6da32b5c"],
Cell[120023, 3351, 434, 12, 117, "Input",ExpressionUUID->"597aeb0e-13b7-46fc-9b32-48a7395b828c",
 InitializationCell->True],
Cell[120460, 3365, 3513, 96, 439, "Input",ExpressionUUID->"838e6173-5562-4b2c-aa29-a9bf2d1cbe4b",
 InitializationCell->True],
Cell[123976, 3463, 1510, 43, 262, "Input",ExpressionUUID->"6bbecafc-12ce-4e3a-b812-d0752c060982",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[125523, 3511, 159, 2, 35, "Subsubsection",ExpressionUUID->"ab614f31-b7bf-4b96-9ba7-78e92300f83b"],
Cell[125685, 3515, 610, 18, 81, "Input",ExpressionUUID->"af63598a-37c6-4611-864a-52a454c88450",
 InitializationCell->True],
Cell[126298, 3535, 383, 12, 81, "Input",ExpressionUUID->"d23d8de6-b53b-4107-9555-124f4f328b2d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[126718, 3552, 149, 2, 58, "Subsubsection",ExpressionUUID->"530471e9-1938-4220-902d-ccd473d42dd4"],
Cell[126870, 3556, 618, 18, 292, "Input",ExpressionUUID->"a170ce60-4c28-4064-aa08-bd0af8210165",
 InitializationCell->True],
Cell[127491, 3576, 414, 12, 292, "Input",ExpressionUUID->"1ca79b75-1d1a-4a08-876b-37be2f8c453e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[127942, 3593, 134, 0, 35, "Subsubsection",ExpressionUUID->"48d2644d-e067-4978-81bc-ca88347f0c12"],
Cell[128079, 3595, 602, 18, 292, "Input",ExpressionUUID->"c8017e81-814f-43b3-831e-1276e1e771da",
 InitializationCell->True],
Cell[128684, 3615, 572, 17, 292, "Input",ExpressionUUID->"b61e0435-70f1-480c-b88a-95097655eeeb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[129293, 3637, 157, 2, 35, "Subsubsection",ExpressionUUID->"c0829424-91ad-4dba-9886-70b445579959"],
Cell[129453, 3641, 1215, 32, 1002, "Input",ExpressionUUID->"f32e36fa-7eb6-42c3-b088-85735754fe59",
 InitializationCell->True],
Cell[130671, 3675, 358, 10, 292, "Input",ExpressionUUID->"6803b713-878b-46ae-a912-c1a25a367b56",
 InitializationCell->True],
Cell[131032, 3687, 399, 11, 292, "Input",ExpressionUUID->"0413eeb2-18fc-4fc1-8cff-53a39217a928",
 InitializationCell->True],
Cell[131434, 3700, 438, 13, 292, "Input",ExpressionUUID->"12c91a2d-880f-400b-b7e8-41580ee573d4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[131909, 3718, 165, 2, 35, "Subsubsection",ExpressionUUID->"edf6f645-62fb-4be5-aaf2-71dc0b58724b"],
Cell[132077, 3722, 702, 20, 462, "Input",ExpressionUUID->"b9b5c3d7-b561-40f0-a684-3d62ed663d6b",
 InitializationCell->True],
Cell[132782, 3744, 751, 22, 462, "Input",ExpressionUUID->"c235a8b4-deb0-4f71-9d2c-3df55b4934fd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[133570, 3771, 157, 2, 35, "Subsubsection",ExpressionUUID->"50bac34e-578b-47e8-8737-509c41d009ce"],
Cell[133730, 3775, 1133, 30, 1002, "Input",ExpressionUUID->"d7a6007c-2c36-4a7f-9bff-f27b29d680ad",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[134900, 3810, 157, 2, 35, "Subsubsection",ExpressionUUID->"07db6e8b-3117-4c94-bbdc-3d80bca71154"],
Cell[135060, 3814, 729, 21, 475, "Input",ExpressionUUID->"6862bfc2-9d5c-473f-8532-3fcd5e3f4710",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[135826, 3840, 156, 2, 35, "Subsubsection",ExpressionUUID->"f2b7edcb-ef1f-421a-aa18-4cbd63ac9974"],
Cell[135985, 3844, 1362, 36, 1002, "Input",ExpressionUUID->"c4839606-cd32-4791-930d-7b0651e39dc1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[137384, 3885, 817, 21, 55, "Subsubsection",ExpressionUUID->"6c7bc961-a4c7-4a5b-ae36-fb567bb428c0"],
Cell[138204, 3908, 844, 23, 475, "Input",ExpressionUUID->"5e0c4d4c-6d79-4c0a-b4fe-4eba5b43d822",
 InitializationCell->True],
Cell[139051, 3933, 663, 19, 475, "Input",ExpressionUUID->"270e9846-9159-4131-a46e-d923a2850b83",
 InitializationCell->True],
Cell[139717, 3954, 1055, 31, 643, "Input",ExpressionUUID->"68027e8d-8406-4532-a9df-85c319e9162f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[140809, 3990, 297, 4, 56, "Subsubsection",ExpressionUUID->"73a061b1-1418-4f89-b8cb-976923c143d5"],
Cell[141109, 3996, 638, 19, 475, "Input",ExpressionUUID->"47e96ca3-ba5d-4759-8c0e-2423e3f87d36",
 InitializationCell->True],
Cell[141750, 4017, 1122, 34, 657, "Input",ExpressionUUID->"e55efc1c-948c-45d2-b711-7b04b5958dcc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[142909, 4056, 1578, 38, 95, "Subsubsection",ExpressionUUID->"b6dec7d2-f106-4760-a67c-ab1631a6e44c"],
Cell[144490, 4096, 405, 12, 273, "Input",ExpressionUUID->"ecff2556-99e8-4c9f-bb90-b31e1d4308de",
 InitializationCell->True],
Cell[144898, 4110, 2858, 77, 1183, "Input",ExpressionUUID->"e0e928a1-86b8-42f1-9b4f-8d807402fa5a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[147793, 4192, 188, 3, 35, "Subsubsection",ExpressionUUID->"e44ef2fb-b96e-496c-a36e-4d2c332e3d4f"],
Cell[147984, 4197, 260, 7, 117, "Input",ExpressionUUID->"e944914e-f51f-421d-a0c5-b18dd51bf677",
 InitializationCell->True],
Cell[148247, 4206, 1920, 54, 292, "Input",ExpressionUUID->"bac503bc-4c98-4690-80a4-37a614fe73e5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[150204, 4265, 130, 0, 35, "Subsubsection",ExpressionUUID->"f1f7661f-f658-4d7d-a385-89c30023209c"],
Cell[150337, 4267, 962, 30, 657, "Input",ExpressionUUID->"00026bc7-f6be-4109-bbf0-1fbec2265720",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[151336, 4302, 337, 5, 56, "Subsubsection",ExpressionUUID->"537b323c-ff00-496a-89e9-e78906b407cf"],
Cell[151676, 4309, 268, 7, 273, "Input",ExpressionUUID->"659912cf-ddff-4567-81d4-37f5cccfabb0",
 InitializationCell->True],
Cell[151947, 4318, 2654, 68, 2922, "Input",ExpressionUUID->"050e6cf5-0e58-4fa1-9eec-f8333a447329",
 InitializationCell->True],
Cell[154604, 4388, 612, 19, 292, "Input",ExpressionUUID->"73815c49-f27b-4f75-b4e2-4cec555cfcb1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[155253, 4412, 175, 3, 35, "Subsubsection",ExpressionUUID->"bb9058d7-251c-4d75-8f0d-eef9e6d3b9d1"],
Cell[155431, 4417, 488, 13, 292, "Input",ExpressionUUID->"50b4f99d-4133-4901-a470-f67ae0ddbc61",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[155956, 4435, 129, 0, 35, "Subsubsection",ExpressionUUID->"9271a841-77ec-4305-a039-768337114612"],
Cell[156088, 4437, 1767, 49, 223, "Input",ExpressionUUID->"91424ed3-2fff-4941-aced-9d647b49d077",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[157892, 4491, 325, 9, 36, "Subsubsection",ExpressionUUID->"e3fad6eb-abbe-492c-98c6-f74aac68195c"],
Cell[158220, 4502, 1739, 47, 819, "Input",ExpressionUUID->"a5e2bd58-1e10-49a8-ac3d-bded7c6deb8c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[159996, 4554, 156, 2, 35, "Subsubsection",ExpressionUUID->"cc655ccf-e9d3-426d-840c-b64d44bd5eeb"],
Cell[160155, 4558, 2200, 61, 1690, "Input",ExpressionUUID->"b0723877-9873-4632-9597-65126800e4e7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[162392, 4624, 211, 3, 35, "Subsubsection",ExpressionUUID->"f0fec6a2-f7a6-4f1d-8c86-d397430a774e"],
Cell[162606, 4629, 581, 17, 462, "Input",ExpressionUUID->"2f8f328d-5096-4d15-925e-7ffe2fc0cbe1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[163224, 4651, 191, 3, 35, "Subsubsection",ExpressionUUID->"f9fd7d7d-21bd-44df-b9df-403da7980a68"],
Cell[163418, 4656, 506, 15, 292, "Input",ExpressionUUID->"2a5360ca-6374-4a48-b0c6-d37c606e4abb",
 InitializationCell->True],
Cell[163927, 4673, 3472, 92, 1350, "Input",ExpressionUUID->"b140868c-5846-402b-bd9e-d44ec1e6ce36",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[167436, 4770, 383, 5, 76, "Subsubsection",ExpressionUUID->"76e0a4aa-cfbf-4a50-a393-8306a8e22373"],
Cell[167822, 4777, 964, 28, 454, "Input",ExpressionUUID->"65b27632-5788-47fd-9098-9c67796c582c",
 InitializationCell->True],
Cell[168789, 4807, 6987, 190, 3955, "Input",ExpressionUUID->"13bb6c40-1acf-41cb-8e6e-4e342530274a",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[175825, 5003, 94, 0, 96, "Subsection",ExpressionUUID->"34250874-3d6a-4160-a3e6-2a4d8b20f3b6"],
Cell[CellGroupData[{
Cell[175944, 5007, 262, 4, 118, "Subsubsection",ExpressionUUID->"fe616bc7-60ee-4c03-9c0d-fd1815d57522"],
Cell[176209, 5013, 2230, 62, 261, "Input",ExpressionUUID->"565ec32c-4c35-496f-92ef-7d6fb4ec80c0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[178476, 5080, 2307, 52, 202, "Subsubsection",ExpressionUUID->"d1440942-5ab2-46d3-9dea-8d63d4f7151a"],
Cell[180786, 5134, 404, 10, 117, "Input",ExpressionUUID->"e91b911f-8bcb-4a8d-83c9-00ba18158980",
 InitializationCell->True],
Cell[181193, 5146, 5712, 142, 499, "Input",ExpressionUUID->"9648fc28-70f2-46eb-b7cb-51f275deef3e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[186942, 5293, 701, 19, 57, "Subsubsection",ExpressionUUID->"7bcd1864-e018-4832-9b3d-10e7a29feb77",
 InitializationCell->True],
Cell[187646, 5314, 1502, 45, 1251, "Input",ExpressionUUID->"f3ad80ca-4e75-4e5d-8aa1-4b2a5dc6d23e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[189185, 5364, 254, 5, 52, "Subsubsection",ExpressionUUID->"b163b7c0-af8d-4362-8269-0de402df06cc",
 InitializationCell->True],
Cell[189442, 5371, 754, 23, 424, "Input",ExpressionUUID->"e61f7262-95b9-4d1e-9b04-4fb2172baa16",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[190233, 5399, 203, 5, 52, "Subsubsection",ExpressionUUID->"9b439feb-7554-4a46-85fa-93cc6764b4ed",
 InitializationCell->True],
Cell[190439, 5406, 655, 19, 424, "Input",ExpressionUUID->"9840b0a3-ee03-4e93-8bdb-79c1ae8f3914",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[191131, 5430, 253, 5, 52, "Subsubsection",ExpressionUUID->"b1105e0b-c1a2-47f9-98e5-fad736a3bb61",
 InitializationCell->True],
Cell[191387, 5437, 523, 16, 607, "Input",ExpressionUUID->"08a8eab4-6d2e-4301-9161-7094a7ccbd72",
 InitializationCell->True],
Cell[191913, 5455, 4528, 112, 3097, "Input",ExpressionUUID->"c2eb2f3d-b23d-45b6-976e-a951fb56d162",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[196478, 5572, 172, 3, 52, "Subsubsection",ExpressionUUID->"59787706-cc18-4158-a42e-b7969ce5ee89",
 InitializationCell->True],
Cell[196653, 5577, 1896, 58, 1336, "Input",ExpressionUUID->"4723c243-8772-4c24-94be-67463ff52cfc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[198586, 5640, 162, 2, 52, "Subsubsection",ExpressionUUID->"0610f577-d8fd-43f2-9f5f-7f5bcea5aca0",
 InitializationCell->True],
Cell[198751, 5644, 1335, 37, 1123, "Input",ExpressionUUID->"bc63ae35-564b-4552-a4db-890d168c1b4f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[200123, 5686, 204, 5, 52, "Subsubsection",ExpressionUUID->"e569da9c-4ae2-4c84-9210-b1981c72abae",
 InitializationCell->True],
Cell[200330, 5693, 700, 22, 765, "Input",ExpressionUUID->"7588bf23-4356-4b5c-a3da-875c826516f2",
 InitializationCell->True],
Cell[201033, 5717, 1556, 47, 940, "Input",ExpressionUUID->"fb4eb1ac-7a72-4779-acbf-e84c430f5c7f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[202626, 5769, 161, 2, 52, "Subsubsection",ExpressionUUID->"4834d19f-fecf-4647-8d70-60a6c4264b37",
 InitializationCell->True],
Cell[202790, 5773, 2586, 76, 1488, "Input",ExpressionUUID->"eac60a10-5435-4902-8dab-01f13847a345",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[205413, 5854, 158, 2, 52, "Subsubsection",ExpressionUUID->"5aece391-2cb9-460d-8935-8ebb2c7a91fb",
 InitializationCell->True],
Cell[205574, 5858, 573, 16, 607, "Input",ExpressionUUID->"95e565d5-5024-49ea-806d-5ba5fd8db381",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[206196, 5880, 95, 0, 57, "Subsection",ExpressionUUID->"20e2b8e3-5c72-4ff5-aec0-be76ad4b8a7d"],
Cell[CellGroupData[{
Cell[206316, 5884, 154, 2, 87, "Subsubsection",ExpressionUUID->"891e158d-9bd8-4616-90c5-8050aac5abc1"],
Cell[206473, 5888, 941, 27, 195, "Input",ExpressionUUID->"5c5b0257-c9e1-4e25-a940-715f74172b41",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[207451, 5920, 265, 6, 87, "Subsubsection",ExpressionUUID->"44f2e3dd-5bb2-422d-acf4-819762ccfcfe"],
Cell[207719, 5928, 912, 24, 157, "Input",ExpressionUUID->"d44bbab3-c7d8-4c69-9370-5ac9467e609e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[208668, 5957, 184, 3, 52, "Subsubsection",ExpressionUUID->"4d146851-a224-42f4-9e38-590d13b5f854"],
Cell[208855, 5962, 3660, 100, 223, "Text",ExpressionUUID->"89cccf6f-6925-4248-9249-4c84645f4d6d"],
Cell[212518, 6064, 409, 8, 61, "Text",ExpressionUUID->"4060637f-a03a-402e-b32a-985db01aedda"],
Cell[CellGroupData[{
Cell[212952, 6076, 1648, 45, 151, "Input",ExpressionUUID->"47589fff-2c28-4ffd-b549-314dc6d41b51"],
Cell[214603, 6123, 22919, 440, 70, "Output",ExpressionUUID->"cc73de43-905f-40da-96ec-a81edba4296a"]
}, Open  ]],
Cell[237537, 6566, 841, 22, 61, "Text",ExpressionUUID->"44804617-1159-4322-8967-a807850f3ebe"],
Cell[CellGroupData[{
Cell[238403, 6592, 1750, 47, 151, "Input",ExpressionUUID->"eec6c4e2-a798-4b39-9bc6-6d2b8d2e94d5"],
Cell[240156, 6641, 24892, 481, 70, "Output",ExpressionUUID->"5fa33919-b6e6-4806-a606-9fba5e2b6e7c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[265097, 7128, 318, 6, 84, "Subsubsection",ExpressionUUID->"728058cc-9e8f-4b36-856b-7cfbd83869fa",
 InitializationCell->True],
Cell[265418, 7136, 363, 10, 121, "Input",ExpressionUUID->"5d79a151-6769-4d78-a8b0-1057a68eb955",
 InitializationCell->True],
Cell[265784, 7148, 411, 13, 121, "Input",ExpressionUUID->"7e45e6bb-e915-4980-91c1-14e9d28a3818",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[266232, 7166, 137, 1, 52, "Subsubsection",ExpressionUUID->"eba2af27-4aac-42fc-bc5d-8d28d887a35f"],
Cell[266372, 7169, 286, 8, 424, "Input",ExpressionUUID->"7a6f3799-b163-4688-b01a-89ef33b0f53c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[266695, 7182, 203, 3, 52, "Subsubsection",ExpressionUUID->"6b7a0f4b-948f-40a8-8ffc-b4541e4f60d7"],
Cell[266901, 7187, 404, 11, 424, "Input",ExpressionUUID->"3295f198-3a7a-4ea9-9f63-1c15b9352ecd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[267342, 7203, 220, 5, 52, "Subsubsection",ExpressionUUID->"bdea6484-dc98-49de-8d34-f3f13c26036c",
 InitializationCell->True],
Cell[267565, 7210, 1848, 52, 1123, "Input",ExpressionUUID->"2f7c590d-04d7-4b79-861d-430b4d9a2b5c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[269450, 7267, 1932, 47, 172, "Subsubsection",ExpressionUUID->"f6f717fa-ffb5-42a5-b4a0-9e248becf201"],
Cell[271385, 7316, 405, 11, 117, "Input",ExpressionUUID->"a513c99c-5894-4306-9808-c2f536c07c9c",
 InitializationCell->True],
Cell[271793, 7329, 5339, 138, 673, "Input",ExpressionUUID->"aa303c4b-4085-4c0a-aa51-6f5756522247",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[277169, 7472, 785, 20, 84, "Subsubsection",ExpressionUUID->"e02a2adf-930e-4dfb-a899-44bd3cb5d23d"],
Cell[277957, 7494, 1873, 52, 1113, "Input",ExpressionUUID->"b2b57555-bf5e-4cab-89e9-5b41198336b4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[279867, 7551, 222, 3, 52, "Subsubsection",ExpressionUUID->"dfbcf62d-42ba-4ca4-859f-29deb566103b"],
Cell[280092, 7556, 1219, 35, 940, "Input",ExpressionUUID->"d2487a72-20c7-43ef-a074-3055c0a052cd",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[281360, 7597, 97, 0, 57, "Subsection",ExpressionUUID->"19482457-7af0-438f-84e9-2e6764ff9053"],
Cell[CellGroupData[{
Cell[281482, 7601, 263, 4, 438, "Subsubsection",ExpressionUUID->"226c8c0f-fcc7-46fd-a227-59da13cc6dc3"],
Cell[CellGroupData[{
Cell[281770, 7609, 705, 19, 589, "Input",ExpressionUUID->"cefc19f5-47da-4821-aba9-e342373c5f06",
 InitializationCell->True],
Cell[282478, 7630, 1317, 22, 70, "Message",ExpressionUUID->"491f64b7-42d3-4c23-bf86-c629bb0e5068"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283832, 7657, 945, 28, 832, "Input",ExpressionUUID->"b2db052d-30b0-4f79-b32e-ac4b16b7451f",
 InitializationCell->True],
Cell[284780, 7687, 1477, 25, 70, "Message",ExpressionUUID->"50a785fc-3bb6-4a2a-9d64-d30883fc3cc2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[286294, 7717, 3593, 92, 2368, "Input",ExpressionUUID->"ceeb6c76-2f08-4457-be00-296e6ecf89f9",
 InitializationCell->True],
Cell[289890, 7811, 1044, 19, 70, "Message",ExpressionUUID->"c420d825-83f4-4104-98a9-3db7b41ef0d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290971, 7835, 5032, 126, 2551, "Input",ExpressionUUID->"2ceca243-8c68-4816-a380-e4a3867b219a",
 InitializationCell->True],
Cell[296006, 7963, 1079, 19, 70, "Message",ExpressionUUID->"dc3f9fc2-b5ce-4192-ad1e-0342a4717798"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[297146, 7989, 107, 0, 57, "Subsection",ExpressionUUID->"59043d53-0f89-4b9b-84eb-925f7e72032d"],
Cell[CellGroupData[{
Cell[297278, 7993, 227, 3, 118, "Subsubsection",ExpressionUUID->"7c021ae9-acb3-44fb-9fb2-f6aed6f8994b"],
Cell[297508, 7998, 718, 22, 424, "Input",ExpressionUUID->"aa4762b5-6d68-43d2-b21d-502a86be2a02",
 InitializationCell->True],
Cell[298229, 8022, 677, 19, 589, "Input",ExpressionUUID->"adc125ee-9287-418d-9503-149d2173e084",
 InitializationCell->True],
Cell[298909, 8043, 3368, 84, 2004, "Input",ExpressionUUID->"ef15eb7f-6223-4b48-afbd-17d6bebf5867",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[302314, 8132, 174, 3, 52, "Subsubsection",ExpressionUUID->"485d144f-4264-4d3e-be67-ea36d6ba99b4"],
Cell[302491, 8137, 687, 21, 424, "Input",ExpressionUUID->"69226cf0-abc8-4f13-9c56-4f6c58a7cd41",
 InitializationCell->True],
Cell[303181, 8160, 631, 18, 424, "Input",ExpressionUUID->"be47502f-4ed7-45d0-b2ef-7a5d90e9509b",
 InitializationCell->True],
Cell[303815, 8180, 3073, 78, 1305, "Input",ExpressionUUID->"2927f019-b313-4044-a08b-fc2e2861db75",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[306925, 8263, 288, 4, 84, "Subsubsection",ExpressionUUID->"6ccb066b-b743-413c-a7e2-a32a11deb019"],
Cell[307216, 8269, 1335, 38, 778, "Input",ExpressionUUID->"41ffed46-6f46-418e-8bc2-890dc0132346",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[308588, 8312, 448, 6, 114, "Subsubsection",ExpressionUUID->"8803abf9-cfde-4234-a15c-b019c8b34bd8"],
Cell[309039, 8320, 179, 4, 400, "Input",ExpressionUUID->"d217b14c-da46-4549-b77d-33676b52b2d4",
 InitializationCell->True],
Cell[309221, 8326, 2679, 71, 1471, "Input",ExpressionUUID->"c91887bd-13cb-4682-b192-2c0509ddcda1",
 InitializationCell->True],
Cell[311903, 8399, 177, 4, 400, "Input",ExpressionUUID->"8e678287-80a7-4518-bac9-fe97d2a7d26c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[312117, 8408, 437, 6, 114, "Subsubsection",ExpressionUUID->"b765d46c-36bf-4443-b335-3a17c78e2581"],
Cell[312557, 8416, 1020, 27, 765, "Input",ExpressionUUID->"f2ea80a2-b548-449a-8579-bc1f89257c2f",
 InitializationCell->True],
Cell[313580, 8445, 3663, 103, 3316, "Input",ExpressionUUID->"511e5f3f-d1ee-49de-9534-0e6475c3201a",
 InitializationCell->True],
Cell[317246, 8550, 937, 26, 765, "Input",ExpressionUUID->"d88afe89-9a81-4125-90e5-d68614853b1b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[318220, 8581, 297, 4, 84, "Subsubsection",ExpressionUUID->"fe7e8e37-99f9-4432-abc4-922d99a41a3a"],
Cell[318520, 8587, 398, 11, 400, "Input",ExpressionUUID->"5d8e45dd-0cb8-4034-af47-726213733097",
 InitializationCell->True],
Cell[318921, 8600, 1428, 38, 1639, "Input",ExpressionUUID->"542d256f-7c3d-435f-a14b-0cbee5739ef6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[320386, 8643, 427, 8, 114, "Subsubsection",ExpressionUUID->"d8ae1288-fd00-4df8-879b-7d4ec9e2f2ce"],
Cell[320816, 8653, 390, 11, 117, "Input",ExpressionUUID->"3a2c2fd3-e6a6-4968-82af-9e2fbc553508",
 InitializationCell->True],
Cell[321209, 8666, 765, 22, 154, "Input",ExpressionUUID->"92825d7d-38f0-47b0-beb6-1c1e5c67db79",
 InitializationCell->True],
Cell[321977, 8690, 1224, 35, 154, "Input",ExpressionUUID->"040799e7-88af-4c59-9f9b-ffe81d860ac1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[323238, 8730, 157, 2, 52, "Subsubsection",ExpressionUUID->"2ec74ac9-687b-46eb-a2b7-9917e369d078"],
Cell[323398, 8734, 383, 12, 117, "Input",ExpressionUUID->"4b88d991-b0c8-4b4c-80c7-4a659b21a31a",
 InitializationCell->True],
Cell[323784, 8748, 2391, 64, 223, "Input",ExpressionUUID->"56191370-5a5c-4a79-824d-374e5cf3bcd1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[326212, 8817, 165, 2, 52, "Subsubsection",ExpressionUUID->"76fc9a52-a3b3-4a57-a7bf-daeed3a6b832"],
Cell[326380, 8821, 385, 12, 400, "Input",ExpressionUUID->"96381e02-7573-46c9-a333-733a6c76368e",
 InitializationCell->True],
Cell[326768, 8835, 2048, 54, 1639, "Input",ExpressionUUID->"ceb1486c-466e-45e9-90a6-f2f6014410ad",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[328853, 8894, 720, 10, 175, "Subsubsection",ExpressionUUID->"2bcb8a99-c7da-4ee3-b31e-77ed72395310"],
Cell[329576, 8906, 397, 11, 400, "Input",ExpressionUUID->"34181a52-18cb-461a-8780-3ae0bc9818e2",
 InitializationCell->True],
Cell[329976, 8919, 1996, 55, 1804, "Input",ExpressionUUID->"c332d824-13b9-467a-ab89-d0bd02a95f87",
 InitializationCell->True],
Cell[331975, 8976, 4032, 105, 1957, "Input",ExpressionUUID->"2907b879-6e09-44b0-97fe-5a25e8987f51",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[336044, 9086, 375, 5, 114, "Subsubsection",ExpressionUUID->"53e824c6-a197-4c20-a69b-679b64951a09"],
Cell[336422, 9093, 398, 11, 117, "Input",ExpressionUUID->"a493837d-b872-4755-83ff-051bb64b6223",
 InitializationCell->True],
Cell[336823, 9106, 1013, 28, 192, "Input",ExpressionUUID->"e308167e-3073-4d11-aafc-8fbdfb639468",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[337873, 9139, 1057, 27, 117, "Subsubsection",ExpressionUUID->"0e3f0a62-dfc7-4407-8667-430784c7c036"],
Cell[338933, 9168, 269, 7, 117, "Input",ExpressionUUID->"f3dc6311-3b59-4129-a1cf-cc317d237dbd",
 InitializationCell->True],
Cell[339205, 9177, 1131, 29, 327, "Input",ExpressionUUID->"d6227859-d726-4dab-9243-462557fb9f32",
 InitializationCell->True],
Cell[340339, 9208, 4042, 106, 568, "Input",ExpressionUUID->"4b31a56c-ff89-4b67-a857-dda9a76f938b",
 InitializationCell->True],
Cell[344384, 9316, 270, 7, 117, "Input",ExpressionUUID->"0a930faa-a074-404e-8110-326cba15951f",
 InitializationCell->True],
Cell[344657, 9325, 350, 8, 187, "Input",ExpressionUUID->"270c9003-e66e-4510-81e5-f6690fe99fa8",
 InitializationCell->True],
Cell[345010, 9335, 12052, 293, 1230, "Input",ExpressionUUID->"b42fa9d3-aa1e-4b69-8cb2-611d7668244f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[357099, 9633, 2212, 51, 207, "Subsubsection",ExpressionUUID->"4b2de436-01d4-489c-b567-6d6c11be8d3e"],
Cell[359314, 9686, 6081, 139, 4434, "Input",ExpressionUUID->"b10f2cde-8297-4305-b67e-845779af7f8f",
 InitializationCell->True],
Cell[365398, 9827, 473, 9, 1434, "Text",ExpressionUUID->"0476dfbe-b7d4-48ef-a93a-4c4dd2f25a3f"]
}, Closed]],
Cell[CellGroupData[{
Cell[365908, 9841, 815, 19, 82, "Subsubsection",ExpressionUUID->"6bdbd8ed-7c8c-4ba9-9517-6a39c6c78f24"],
Cell[366726, 9862, 277, 8, 400, "Input",ExpressionUUID->"b8101019-830d-4360-b4ac-a725b01e08e3",
 InitializationCell->True],
Cell[367006, 9872, 1467, 42, 940, "Input",ExpressionUUID->"45260aab-6c67-444b-b983-b3d58f9456a9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[368510, 9919, 830, 20, 82, "Subsubsection",ExpressionUUID->"7eee9ce1-d6cf-48b5-beee-3a988d9cdcc5"],
Cell[369343, 9941, 277, 8, 117, "Input",ExpressionUUID->"74a8a056-53d9-4e30-859a-f650d088ac81",
 InitializationCell->True],
Cell[369623, 9951, 1420, 42, 258, "Input",ExpressionUUID->"712cb107-265b-4bce-8421-d31fbc129fcc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[371080, 9998, 234, 3, 84, "Subsubsection",ExpressionUUID->"5eb1ca23-be45-461a-8780-46975fe0b361"],
Cell[371317, 10003, 319, 9, 121, "Input",ExpressionUUID->"4b17fdfe-78e8-484d-bd02-035de5272b75",
 InitializationCell->True],
Cell[371639, 10014, 1419, 45, 273, "Input",ExpressionUUID->"89eb1956-4f6c-4fdf-bd57-eca0ea94c86f",
 InitializationCell->True],
Cell[373061, 10061, 5138, 130, 615, "Input",ExpressionUUID->"0ec163c5-9dfc-442f-a8b8-13134f6f97da",
 InitializationCell->True],
Cell[378202, 10193, 529, 9, 97, "Text",ExpressionUUID->"13d5ff84-9f31-4381-9e10-935cb9644415"],
Cell[CellGroupData[{
Cell[378756, 10206, 784, 21, 153, "Input",ExpressionUUID->"e0c2ec08-7270-42fe-b70b-62b1daf2c589"],
Cell[379543, 10229, 333, 6, 70, "Output",ExpressionUUID->"5dca6033-56e8-4fc4-81ff-b98149928ee9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[379913, 10240, 424, 10, 55, "Input",ExpressionUUID->"d46ad067-fd30-4320-9e8b-91f439d109e8"],
Cell[380340, 10252, 9042, 169, 499, "Output",ExpressionUUID->"3bb9f179-8b0f-49f1-aff6-761c362f9f44"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[389431, 10427, 258, 4, 84, "Subsubsection",ExpressionUUID->"23bfa60f-9fcd-4415-ac7d-138a47a5c30d"],
Cell[389692, 10433, 5891, 153, 2830, "Input",ExpressionUUID->"9e2da1b8-349f-43ce-92dc-da1644c141ce",
 InitializationCell->True],
Cell[395586, 10588, 346, 8, 424, "Input",ExpressionUUID->"1b679468-2f93-4110-8386-aedc6f5f6767",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[395969, 10601, 122, 2, 52, "Subsubsection",ExpressionUUID->"b68c8215-25b6-4619-8391-2fce65e0d34b",
 InitializationCell->True],
Cell[396094, 10605, 291, 7, 400, "Input",ExpressionUUID->"f8a3baef-20bc-4a10-a0ad-b86987430ee6",
 InitializationCell->True],
Cell[396388, 10614, 269, 7, 400, "Input",ExpressionUUID->"84a3fea9-7535-432f-9ff6-62599209cfa6",
 InitializationCell->True],
Cell[396660, 10623, 2824, 73, 1812, "Input",ExpressionUUID->"119d8e71-d0a9-4520-8596-1331878256b1",
 InitializationCell->True],
Cell[399487, 10698, 2974, 90, 1660, "Input",ExpressionUUID->"111b32e6-6aa9-433c-a2f6-ee5f48e89d5e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[402498, 10793, 120, 2, 52, "Subsubsection",ExpressionUUID->"166a9ee4-0935-4774-a0e5-009ec02420ca",
 InitializationCell->True],
Cell[402621, 10797, 764, 28, 424, "Input",ExpressionUUID->"9d8ff394-8a2f-4508-8255-0241deabfb7d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[403422, 10830, 98, 0, 52, "Subsubsection",ExpressionUUID->"cd0bd05a-d338-4dfe-8950-9e2969f5c033"],
Cell[403523, 10832, 272, 7, 400, "Input",ExpressionUUID->"0fb991be-8b66-4037-9a8e-1ceddd91877d",
 InitializationCell->True],
Cell[403798, 10841, 2135, 58, 1477, "Input",ExpressionUUID->"de9593b2-b9af-4ffd-b45f-a144ace419d7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[405970, 10904, 96, 0, 52, "Subsubsection",ExpressionUUID->"9e646978-0561-4f41-8a84-5cf9086cabfd"],
Cell[406069, 10906, 7042, 184, 4455, "Input",ExpressionUUID->"2682b300-6b9f-4d1e-b2e1-32d05945d990",
 InitializationCell->True],
Cell[413114, 11092, 839, 26, 424, "Input",ExpressionUUID->"f60623ef-b804-425b-a02c-fa3c2dd6baad",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[413990, 11123, 91, 0, 52, "Subsubsection",ExpressionUUID->"3f91b55d-8ed7-4eed-8994-ed6c1bbdaf29"],
Cell[414084, 11125, 274, 7, 153, "Input",ExpressionUUID->"a3212995-1950-41e4-8140-793ddc942ec4",
 InitializationCell->True],
Cell[414361, 11134, 2213, 67, 265, "Input",ExpressionUUID->"0d301402-bfa2-4c83-b295-bf3cfaa9fbfa",
 InitializationCell->True],
Cell[416577, 11203, 269, 6, 61, "Text",ExpressionUUID->"641adc8b-3619-4fa8-8b7a-8aeffccb4281"],
Cell[416849, 11211, 1539, 43, 226, "Input",ExpressionUUID->"be5c4990-a214-4e13-827d-51744fc88877",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[418425, 11259, 94, 0, 87, "Subsubsection",ExpressionUUID->"e51fecb8-4278-4f58-8b68-faa74910b137"],
Cell[418522, 11261, 266, 7, 400, "Input",ExpressionUUID->"c6832a87-0400-4fe6-9095-94152856ae38",
 InitializationCell->True],
Cell[418791, 11270, 228, 6, 400, "Input",ExpressionUUID->"52f81475-1d95-4fad-a8e5-28c7c5f2a2e3",
 InitializationCell->True],
Cell[419022, 11278, 3091, 83, 1488, "Input",ExpressionUUID->"09746210-a8d9-4798-ad0c-60ccc1862098",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[422162, 11367, 90, 0, 57, "Subsection",ExpressionUUID->"3990334a-b03e-4d36-9685-7b6399ce383b"],
Cell[CellGroupData[{
Cell[422277, 11371, 131, 2, 87, "Subsubsection",ExpressionUUID->"73070880-69ca-433d-a73d-24ab6bcc9db6",
 InitializationCell->True],
Cell[422411, 11375, 240, 6, 400, "Input",ExpressionUUID->"3db72879-79fa-40ec-9b52-061a3ebd90e1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[422688, 11386, 133, 2, 52, "Subsubsection",ExpressionUUID->"861ef71b-2877-40e3-8c9b-27e68d627490",
 InitializationCell->True],
Cell[422824, 11390, 366, 9, 424, "Input",ExpressionUUID->"ab7f946a-14a3-444e-884b-95c5f7d2b141",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[423227, 11404, 119, 2, 52, "Subsubsection",ExpressionUUID->"7cafd86e-0ec3-4f82-8e57-08832bb98959",
 InitializationCell->True],
Cell[423349, 11408, 701, 20, 589, "Input",ExpressionUUID->"fe86d7d2-d5d5-4e4d-8997-3840ffa8a69d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[424087, 11433, 119, 2, 52, "Subsubsection",ExpressionUUID->"b57b5269-5781-47ba-934f-c00ae992771c",
 InitializationCell->True],
Cell[424209, 11437, 248, 6, 400, "Input",ExpressionUUID->"33a3d2b8-b8d4-4019-9cbc-f6a798e257d8",
 InitializationCell->True],
Cell[424460, 11445, 1221, 36, 1288, "Input",ExpressionUUID->"5d1d89fe-5836-49d3-956a-5242f9df3a52",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[425718, 11486, 123, 2, 52, "Subsubsection",ExpressionUUID->"650af564-305a-483d-b767-bcf756b05599",
 InitializationCell->True],
Cell[425844, 11490, 628, 17, 597, "Input",ExpressionUUID->"4c68f802-37bc-4067-ae42-fffee0512073",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[426509, 11512, 119, 2, 52, "Subsubsection",ExpressionUUID->"7569b117-f2a0-4de4-a873-94a26e87a46f",
 InitializationCell->True],
Cell[426631, 11516, 291, 7, 400, "Input",ExpressionUUID->"b7003a7f-13ff-43a8-b6e2-9d80702de971",
 InitializationCell->True],
Cell[426925, 11525, 274, 7, 400, "Input",ExpressionUUID->"a5e8cf64-ed0c-4902-a667-aae549f35d2d",
 InitializationCell->True],
Cell[427202, 11534, 6427, 148, 3073, "Input",ExpressionUUID->"956bd17f-c6d3-4814-b2fb-21bb4f235c22",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[433666, 11687, 127, 2, 52, "Subsubsection",ExpressionUUID->"9ec4ae10-d6ce-48d9-818a-b343fdf25dc7",
 InitializationCell->True],
Cell[433796, 11691, 498, 14, 424, "Input",ExpressionUUID->"73c8bb99-f457-4637-9b50-4708d359ba1c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[434331, 11710, 129, 2, 52, "Subsubsection",ExpressionUUID->"427ca868-c51e-4bcd-92fe-0c7edb9c337f",
 InitializationCell->True],
Cell[434463, 11714, 583, 17, 424, "Input",ExpressionUUID->"b7858fad-8271-4c37-8d73-edc69324dfc2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[435083, 11736, 133, 2, 52, "Subsubsection",ExpressionUUID->"408da5ea-b66a-488e-b439-274e5c7c3206",
 InitializationCell->True],
Cell[435219, 11740, 633, 18, 597, "Input",ExpressionUUID->"1c708929-a7cf-421e-bc07-343f6d3ff7da",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[435889, 11763, 120, 2, 52, "Subsubsection",ExpressionUUID->"67edd33d-e479-4ff9-874e-9203d36f3e64",
 InitializationCell->True],
Cell[436012, 11767, 531, 16, 424, "Input",ExpressionUUID->"5a4ac800-af36-4ce2-a1e0-55a82a37c355",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[436580, 11788, 120, 2, 52, "Subsubsection",ExpressionUUID->"18377879-754e-415c-bb44-31830ba30175",
 InitializationCell->True],
Cell[436703, 11792, 528, 15, 424, "Input",ExpressionUUID->"31c54999-e664-4666-9042-1e7e0e81cc6b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[437268, 11812, 116, 2, 52, "Subsubsection",ExpressionUUID->"fbfb06a6-dadb-45b6-a4be-28acfc4d0fc9",
 InitializationCell->True],
Cell[437387, 11816, 266, 7, 400, "Input",ExpressionUUID->"97b08566-eef8-49c1-a9e4-19223a795f04",
 InitializationCell->True],
Cell[437656, 11825, 1233, 35, 1107, "Input",ExpressionUUID->"64d38f72-f5a5-4a9f-b454-4cc504eb2be4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[438926, 11865, 125, 2, 52, "Subsubsection",ExpressionUUID->"1c611813-8501-4e3a-bb31-a97892536702",
 InitializationCell->True],
Cell[439054, 11869, 942, 26, 940, "Input",ExpressionUUID->"1e42e639-2059-41ca-b708-00dbf223bfc5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[440033, 11900, 129, 2, 52, "Subsubsection",ExpressionUUID->"58182e08-d5f3-4944-95c7-65ec01b20f6d",
 InitializationCell->True],
Cell[440165, 11904, 296, 8, 400, "Input",ExpressionUUID->"e8ad0c8b-12b8-48d4-a41b-e70363f476eb",
 InitializationCell->True],
Cell[440464, 11914, 1345, 38, 1107, "Input",ExpressionUUID->"65ef9195-5fc9-4799-8b18-781a1b9338a2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[441846, 11957, 128, 2, 52, "Subsubsection",ExpressionUUID->"7671de16-880a-46da-95d6-dfc15c937271",
 InitializationCell->True],
Cell[441977, 11961, 294, 8, 400, "Input",ExpressionUUID->"0a0d5c29-baf2-4599-9dd2-726d0e8b15a9",
 InitializationCell->True],
Cell[442274, 11971, 1344, 38, 1107, "Input",ExpressionUUID->"ddb0bd9e-6814-41ab-8849-604d65fd7739",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[443655, 12014, 122, 2, 52, "Subsubsection",ExpressionUUID->"50a83a9c-a431-46a4-a770-81819aa3ba0c",
 InitializationCell->True],
Cell[443780, 12018, 282, 8, 400, "Input",ExpressionUUID->"a4538871-349f-44a8-a6b7-f6b979decf85",
 InitializationCell->True],
Cell[444065, 12028, 1320, 38, 1107, "Input",ExpressionUUID->"3855a118-1770-4545-bf00-2019f266b5a0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[445422, 12071, 92, 0, 52, "Subsubsection",ExpressionUUID->"8b74242d-66a2-4174-b2b1-90807bc48d0c"],
Cell[445517, 12073, 663, 19, 597, "Input",ExpressionUUID->"69115443-dd6f-4402-92df-8cc3aa52af08",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[446217, 12097, 127, 2, 52, "Subsubsection",ExpressionUUID->"7674ac0f-c137-4822-aa9f-6e04997de9f3",
 InitializationCell->True],
Cell[446347, 12101, 412, 11, 424, "Input",ExpressionUUID->"8b1d987a-1204-4994-bf5b-6a8480f4463c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[446796, 12117, 99, 0, 52, "Subsubsection",ExpressionUUID->"5942c120-155a-431a-ac13-41d2ac448a94"],
Cell[446898, 12119, 1571, 42, 972, "Input",ExpressionUUID->"0817f27b-d542-4c9f-81e8-10ac384503dc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[448506, 12166, 122, 2, 52, "Subsubsection",ExpressionUUID->"8ca1d7b7-1643-4005-9f25-76afff78ee19",
 InitializationCell->True],
Cell[448631, 12170, 406, 11, 424, "Input",ExpressionUUID->"7500991e-b75d-4fb6-8ec2-09377cc42041",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[449074, 12186, 128, 2, 52, "Subsubsection",ExpressionUUID->"778a5dae-e1dc-49cb-869d-f746cf4e49fe",
 InitializationCell->True],
Cell[449205, 12190, 372, 10, 424, "Input",ExpressionUUID->"50e6680d-0996-45ab-a917-4c15e49b89f0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[449614, 12205, 124, 2, 52, "Subsubsection",ExpressionUUID->"e726ecd4-feeb-4ddf-9243-8e93de183296",
 InitializationCell->True],
Cell[449741, 12209, 253, 6, 400, "Input",ExpressionUUID->"e053707e-22a8-4f26-b9ce-fa0ea2bb493c",
 InitializationCell->True],
Cell[449997, 12217, 269, 7, 400, "Input",ExpressionUUID->"eb89ef79-512a-486a-b43a-da1a4453d1c8",
 InitializationCell->True],
Cell[450269, 12226, 434, 13, 424, "Input",ExpressionUUID->"80e051f3-0ec4-4329-bcaf-1f65ca298b54",
 InitializationCell->True],
Cell[450706, 12241, 1577, 42, 1312, "Input",ExpressionUUID->"14bd2f23-3949-49c9-8d9e-124508844d08",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[452320, 12288, 134, 2, 52, "Subsubsection",ExpressionUUID->"c47bcf8c-d0ea-42f3-aebe-5b3617abe65d",
 InitializationCell->True],
Cell[452457, 12292, 721, 20, 607, "Input",ExpressionUUID->"3f8a44b1-88cc-476d-b647-3f4c8d2f9068",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[453215, 12317, 136, 2, 52, "Subsubsection",ExpressionUUID->"7c7c4eef-70ab-4743-b010-01aaeeac450e",
 InitializationCell->True],
Cell[453354, 12321, 723, 20, 607, "Input",ExpressionUUID->"a4a27029-d122-4eff-a140-e0d7ec18a4f3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[454114, 12346, 126, 2, 52, "Subsubsection",ExpressionUUID->"3b88516a-234b-4e4a-92b7-077249dae119",
 InitializationCell->True],
Cell[454243, 12350, 301, 7, 583, "Input",ExpressionUUID->"f4dfd67a-e74c-4231-a79c-37cbc95842e6",
 InitializationCell->True],
Cell[454547, 12359, 2818, 74, 1822, "Input",ExpressionUUID->"b3fc9402-81fb-4319-8695-5772c3e30f3c",
 InitializationCell->True],
Cell[457368, 12435, 2934, 75, 2176, "Input",ExpressionUUID->"528b9947-d219-4bf0-b184-3128094dec0a",
 InitializationCell->True],
Cell[460305, 12512, 745, 22, 910, "Input",ExpressionUUID->"0efe44aa-b26c-44a5-ab18-4dbd455e1405",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[461075, 12538, 143, 3, 273, "Input",ExpressionUUID->"9a930c00-4577-4bb0-b636-a3c13894cc70"],
Cell[461221, 12543, 105, 1, 364, "Output",ExpressionUUID->"1342957c-5aba-4bd4-ab3b-1c474c7e9a0a"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[461375, 12550, 121, 2, 52, "Subsubsection",ExpressionUUID->"c2924706-3faf-4fe0-a7aa-006a947ef274",
 InitializationCell->True],
Cell[461499, 12554, 348, 9, 400, "Input",ExpressionUUID->"14d37afa-827a-4045-81aa-bd0a095658c9",
 InitializationCell->True],
Cell[461850, 12565, 245, 6, 400, "Input",ExpressionUUID->"989387d6-4160-4df6-a0f3-40f52a946435",
 InitializationCell->True],
Cell[462098, 12573, 5673, 140, 4107, "Input",ExpressionUUID->"f0da3076-2719-4361-b2aa-394e1c9c48c2",
 InitializationCell->True],
Cell[467774, 12715, 674, 15, 627, "Input",ExpressionUUID->"1f326eda-b745-47b5-a7f6-313b5456c8c4"]
}, Closed]],
Cell[CellGroupData[{
Cell[468485, 12735, 124, 2, 52, "Subsubsection",ExpressionUUID->"02225772-a09f-44c0-a362-4353aa174bfb",
 InitializationCell->True],
Cell[468612, 12739, 1018, 30, 772, "Input",ExpressionUUID->"0f02077f-1e52-486e-bc29-286c8efbf86f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[469667, 12774, 119, 2, 52, "Subsubsection",ExpressionUUID->"be8be303-927f-41d7-a1b4-00e60116b498",
 InitializationCell->True],
Cell[469789, 12778, 339, 9, 400, "Input",ExpressionUUID->"eac23b4f-5311-4df4-aec2-1c4e059f2c06",
 InitializationCell->True],
Cell[470131, 12789, 243, 6, 400, "Input",ExpressionUUID->"609f44cc-3d11-4b1a-b374-9596fbfe7299",
 InitializationCell->True],
Cell[470377, 12797, 5523, 138, 4107, "Input",ExpressionUUID->"36ab75d6-cea3-434e-8cdd-74803471ad2a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[475937, 12940, 102, 0, 52, "Subsubsection",ExpressionUUID->"a38be4b3-6960-4b1d-9804-a4f5f0fb9c76"],
Cell[CellGroupData[{
Cell[476064, 12944, 1180, 35, 462, "Input",ExpressionUUID->"0814a11c-6c29-48fc-a3e8-a4e83d61559b"],
Cell[477247, 12981, 103586, 2651, 22356, "Output",ExpressionUUID->"08bb2e17-abe7-42f9-8312-0d8011104d6c"]
}, Closed]],
Cell[CellGroupData[{
Cell[580870, 15637, 850, 27, 243, "Input",ExpressionUUID->"4de88379-71d3-4625-86cf-4254343b5a0a"],
Cell[581723, 15666, 128, 2, 279, "Output",ExpressionUUID->"16605db1-a2bf-45cd-b700-eb0d686055d5"]
}, Closed]],
Cell[CellGroupData[{
Cell[581888, 15673, 902, 28, 243, "Input",ExpressionUUID->"12ee55b4-a541-4f9a-bc4f-b04f9e37e803"],
Cell[582793, 15703, 106, 1, 279, "Output",ExpressionUUID->"0a289817-1850-42cf-aa0d-531437fc8e6d"]
}, Closed]],
Cell[CellGroupData[{
Cell[582936, 15709, 199, 4, 219, "Input",ExpressionUUID->"63239821-6209-4be5-9e7d-3cc3b1d8aa79"],
Cell[583138, 15715, 104, 1, 279, "Print",ExpressionUUID->"639326d1-73f7-480e-8d62-70c037cb3349"],
Cell[583245, 15718, 104, 1, 279, "Print",ExpressionUUID->"b9d1ef6f-0f4c-4d38-91d0-3769a8d97ef4"],
Cell[583352, 15721, 127, 2, 279, "Print",ExpressionUUID->"89ff32aa-e930-41ad-87b5-d8175fc90a32"],
Cell[583482, 15725, 104, 1, 279, "Print",ExpressionUUID->"d0956f2f-ff3b-43bc-b419-56e16e508afa"],
Cell[583589, 15728, 128, 2, 279, "Print",ExpressionUUID->"04756635-1c3f-4008-a713-0d2e821898f5"],
Cell[583720, 15732, 142, 3, 279, "Print",ExpressionUUID->"97fe4f16-1e2c-4046-b8d7-2b53e52aa363"],
Cell[583865, 15737, 153, 3, 279, "Print",ExpressionUUID->"5a59a46d-5ea5-4483-9e99-f76231bef11c"],
Cell[584021, 15742, 129, 2, 279, "Print",ExpressionUUID->"b57cfe6e-002f-4dd6-851c-967c02a8f7a6"],
Cell[584153, 15746, 153, 3, 279, "Print",ExpressionUUID->"c30888b4-8ad5-404f-a93e-1566213c19fa"],
Cell[584309, 15751, 153, 3, 279, "Print",ExpressionUUID->"555e47c1-eaef-4a77-9c8a-7f646f5abd25"],
Cell[584465, 15756, 164, 3, 279, "Print",ExpressionUUID->"cc3dfead-bef6-4389-9812-a37c6c7b9aeb"],
Cell[584632, 15761, 176, 3, 279, "Print",ExpressionUUID->"fb174d32-de23-45a5-9126-86594ff14283"],
Cell[584811, 15766, 226, 5, 279, "Print",ExpressionUUID->"d9ec73a4-2694-462c-b4d0-6283447a41bc"],
Cell[585040, 15773, 204, 5, 279, "Print",ExpressionUUID->"ebb78dbb-005f-451b-93a9-165f12ad9543"],
Cell[585247, 15780, 204, 5, 279, "Print",ExpressionUUID->"b382e845-4d43-484e-a7b4-6e65c7028276"],
Cell[585454, 15787, 215, 5, 279, "Print",ExpressionUUID->"fb98129d-8365-4940-9842-5a15d7f2d6c5"],
Cell[585672, 15794, 215, 5, 279, "Print",ExpressionUUID->"af9b114b-42cf-4007-b0f8-d9d57c2fb1de"],
Cell[585890, 15801, 204, 5, 279, "Print",ExpressionUUID->"98c30097-8e86-413a-af3a-e5fc165938b9"],
Cell[586097, 15808, 190, 4, 279, "Print",ExpressionUUID->"aff34255-c977-4f72-ba54-9f2d55c64fef"],
Cell[586290, 15814, 204, 5, 279, "Print",ExpressionUUID->"22ad8371-2401-4926-b6e9-15d7a9f84943"],
Cell[586497, 15821, 190, 4, 279, "Print",ExpressionUUID->"957be489-d906-4daa-b115-45eb72f78c11"],
Cell[586690, 15827, 190, 4, 279, "Print",ExpressionUUID->"71e79ade-999e-4991-a1a9-02a232b2853e"],
Cell[586883, 15833, 204, 5, 279, "Print",ExpressionUUID->"baf72b80-0947-4ce8-89cd-e8618d5b82df"],
Cell[587090, 15840, 190, 4, 279, "Print",ExpressionUUID->"518bac42-6761-4be7-bbd3-695630871b09"],
Cell[587283, 15846, 176, 3, 279, "Print",ExpressionUUID->"245d34e1-f052-4a74-8819-b69e7d751666"],
Cell[587462, 15851, 176, 3, 279, "Print",ExpressionUUID->"9a3cffd0-ee5e-4183-b9b9-c7cc2780279d"],
Cell[587641, 15856, 164, 3, 279, "Print",ExpressionUUID->"555adcec-f698-437d-bad3-511e4c6b6208"],
Cell[587808, 15861, 153, 3, 279, "Print",ExpressionUUID->"d1a441ce-c6eb-4951-a677-d582a50fcaa6"],
Cell[587964, 15866, 142, 3, 279, "Print",ExpressionUUID->"f7d67805-d0b5-4d87-b1fe-7a26c70f35cf"],
Cell[588109, 15871, 142, 3, 279, "Print",ExpressionUUID->"87a97fbb-3d6b-4e2c-88fe-501f3be200b9"],
Cell[588254, 15876, 84, 0, 279, "Output",ExpressionUUID->"e3434f61-4298-43e8-8141-b505ffa535bb"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[588387, 15882, 122, 2, 52, "Subsubsection",ExpressionUUID->"f2c806cf-ec28-4da0-bed8-a0e2c83346b0",
 InitializationCell->True],
Cell[588512, 15886, 1014, 30, 772, "Input",ExpressionUUID->"7da63aaf-cb95-4db4-98c5-68a1097dbdb8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[589563, 15921, 126, 2, 52, "Subsubsection",ExpressionUUID->"e50b0a78-675d-44c5-a759-1950060f4b17",
 InitializationCell->True],
Cell[589692, 15925, 397, 12, 400, "Input",ExpressionUUID->"c0c96dc2-06f4-445e-b8e6-c761a78e8ed8",
 InitializationCell->True],
Cell[590092, 15939, 294, 7, 400, "Input",ExpressionUUID->"a3abe507-b978-4084-8c5a-71a21426bb3e",
 InitializationCell->True],
Cell[590389, 15948, 6357, 164, 2740, "Input",ExpressionUUID->"539c3ab6-aee1-4c25-8a86-80b6a4c2f334",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[596783, 16117, 126, 2, 52, "Subsubsection",ExpressionUUID->"15d977cd-0dd8-4a3e-8211-fb1a7c8dbcab",
 InitializationCell->True],
Cell[596912, 16121, 342, 9, 400, "Input",ExpressionUUID->"baa42c05-7a1f-4a4b-ade9-a423fd1f67cc",
 InitializationCell->True],
Cell[597257, 16132, 5148, 134, 2163, "Input",ExpressionUUID->"c8569618-794f-44e1-bc60-7ea3967252df",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[602442, 16271, 132, 2, 52, "Subsubsection",ExpressionUUID->"cc8cf59c-31ed-458e-9d13-f0c6c783447c",
 InitializationCell->True],
Cell[602577, 16275, 287, 8, 400, "Input",ExpressionUUID->"09d2542d-b0d8-41e5-a318-c6d4a133c494",
 InitializationCell->True],
Cell[602867, 16285, 2165, 57, 1129, "Input",ExpressionUUID->"5a8d0330-2846-4aa6-9971-d7495dedcbe1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[605069, 16347, 130, 2, 52, "Subsubsection",ExpressionUUID->"8eea9a9f-393a-4d66-b0de-249e2d71e49f",
 InitializationCell->True],
Cell[605202, 16351, 1315, 36, 778, "Input",ExpressionUUID->"3c92dce2-d419-4a3d-aa07-4b3952189192",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[606554, 16392, 132, 2, 52, "Subsubsection",ExpressionUUID->"85b267da-25f3-45a4-bfd1-2da32e468840",
 InitializationCell->True],
Cell[606689, 16396, 1279, 38, 273, "Input",ExpressionUUID->"5eca6e85-f6b3-4434-b76d-5d9fe9a37ee7",
 InitializationCell->True],
Cell[607971, 16436, 1164, 32, 189, "Input",ExpressionUUID->"0e587e57-8601-4bf0-b543-92fdda64ec9b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[609172, 16473, 125, 2, 87, "Subsubsection",ExpressionUUID->"64867a4c-a4b9-4fa5-85bd-e3d1d643e333",
 InitializationCell->True],
Cell[609300, 16477, 519, 14, 153, "Input",ExpressionUUID->"705520b9-adef-47be-81c3-2c9a87673b1d",
 InitializationCell->True],
Cell[609822, 16493, 470, 12, 222, "Input",ExpressionUUID->"71ebc6bf-5bf3-4c6d-802c-5b53b9dad400",
 InitializationCell->True],
Cell[610295, 16507, 8267, 196, 1225, "Input",ExpressionUUID->"2581525f-25ab-40c4-851b-df7d45f5c5af",
 InitializationCell->True],
Cell[618565, 16705, 6000, 146, 708, "Input",ExpressionUUID->"268c1f19-fe09-4df5-ba93-f74458ab3007",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[624602, 16856, 88, 0, 87, "Subsubsection",ExpressionUUID->"477e5608-ea4a-4c1d-b93d-887812ce6d10"],
Cell[624693, 16858, 3958, 112, 1690, "Input",ExpressionUUID->"6451e965-1674-4778-8aaa-a46371b2746e",
 InitializationCell->True],
Cell[628654, 16972, 373, 11, 424, "Input",ExpressionUUID->"f1fdc912-f900-4cde-8da7-72ab3012a5cb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[629064, 16988, 92, 0, 52, "Subsubsection",ExpressionUUID->"f746a558-7614-46fd-abc3-b8d313e3ee2b"],
Cell[629159, 16990, 483, 13, 400, "Input",ExpressionUUID->"5bd0379d-4753-4eb2-a812-512b81664b1f",
 InitializationCell->True],
Cell[629645, 17005, 2176, 59, 1471, "Input",ExpressionUUID->"64f78b81-c221-4014-a474-a136f30cf449",
 InitializationCell->True],
Cell[631824, 17066, 4618, 121, 3135, "Input",ExpressionUUID->"fac3ee31-6201-4c93-bf49-6f67ed028544",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[636479, 17192, 86, 0, 52, "Subsubsection",ExpressionUUID->"bc137ce2-ef8d-4405-a73d-1668fee3fc0a"],
Cell[636568, 17194, 997, 31, 607, "Input",ExpressionUUID->"c242de75-47e9-43da-a171-bf18b3b1c388",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[637614, 17231, 99, 0, 57, "Subsection",ExpressionUUID->"e1451397-1f6d-46b3-918b-472760b8ba65"],
Cell[CellGroupData[{
Cell[637738, 17235, 114, 2, 87, "Subsubsection",ExpressionUUID->"f45a4875-bb66-4ae0-a844-d9d14d246143",
 InitializationCell->True],
Cell[637855, 17239, 1179, 38, 226, "Input",ExpressionUUID->"f5da658a-b0ac-40ed-a9a7-feedc9f0dcde",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[639071, 17282, 128, 2, 87, "Subsubsection",ExpressionUUID->"9a189c20-8817-4acd-b378-f2298e42bc83",
 InitializationCell->True],
Cell[639202, 17286, 1098, 33, 789, "Input",ExpressionUUID->"ffb504e0-13dd-4dd2-8383-5e6a0c10f0c5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[640337, 17324, 128, 2, 52, "Subsubsection",ExpressionUUID->"748ef7e7-62ae-4453-9b59-5681ba6bd1ed",
 InitializationCell->True],
Cell[640468, 17328, 1474, 44, 262, "Input",ExpressionUUID->"fccb1d1a-c18e-4aa5-8815-26e119c1a23c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[641979, 17377, 132, 2, 87, "Subsubsection",ExpressionUUID->"474941d6-6e24-4b0e-a754-43dc97b16119",
 InitializationCell->True],
Cell[642114, 17381, 287, 7, 121, "Input",ExpressionUUID->"6ed5eddc-4a8c-4fbc-9cb8-4ddf741326f8",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[642438, 17393, 133, 2, 87, "Subsubsection",ExpressionUUID->"6952eed3-0ceb-4ada-9e90-a6bd56c371a5",
 InitializationCell->True],
Cell[642574, 17397, 320, 8, 424, "Input",ExpressionUUID->"d5f79246-401e-4b46-aee2-53c471ed28b6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[642931, 17410, 127, 2, 52, "Subsubsection",ExpressionUUID->"5029f2c4-0662-4410-8280-7000521804c9",
 InitializationCell->True],
Cell[643061, 17414, 494, 14, 589, "Input",ExpressionUUID->"3b3a94de-e7cc-4d51-a083-844022a26516",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[643592, 17433, 126, 2, 52, "Subsubsection",ExpressionUUID->"8bf0ac54-7312-4e8b-8654-41d57fa52ba6",
 InitializationCell->True],
Cell[643721, 17437, 289, 8, 424, "Input",ExpressionUUID->"d5a8f832-43df-48a5-ada3-b4cdfa3385de",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[644047, 17450, 132, 2, 52, "Subsubsection",ExpressionUUID->"9bf220c9-316b-45b8-978f-9911e7d551db",
 InitializationCell->True],
Cell[644182, 17454, 1652, 49, 1464, "Input",ExpressionUUID->"e4e86824-3799-44b1-8aa9-b2fb53949cb8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[645871, 17508, 132, 2, 52, "Subsubsection",ExpressionUUID->"612040b4-5582-43a1-a678-9e81982e98d5",
 InitializationCell->True],
Cell[646006, 17512, 1652, 49, 1464, "Input",ExpressionUUID->"c04e1cc0-5870-486a-a86f-a0724fe82804",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[647695, 17566, 98, 0, 52, "Subsubsection",ExpressionUUID->"6bde2b4c-e149-453c-bbab-c3eafc5e685c"],
Cell[647796, 17568, 555, 16, 424, "Input",ExpressionUUID->"977eba0c-85e6-4af8-b7df-0e4a2c947782",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[648388, 17589, 90, 0, 52, "Subsubsection",ExpressionUUID->"6d677373-bf17-48f0-bbf0-38558233aa4a"],
Cell[648481, 17591, 1056, 32, 772, "Input",ExpressionUUID->"f5fbc811-166c-4bd8-ab50-48213f326cf9",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

